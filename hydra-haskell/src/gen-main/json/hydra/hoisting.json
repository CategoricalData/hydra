{
  "description": [
    "Functions for deep term rewriting operations involving hoisting subterms or bindings into enclosing let terms."],
  "elements": [
    {
      "name": "hydra.hoisting.augmentBindingsWithNewFreeVars",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Augment bindings with new free variables introduced by substitution, wrapping with lambdas after any type lambdas."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "function": {
                          "lambda": {
                            "body": {
                              "let": {
                                "bindings": [
                                  {
                                    "name": "types",
                                    "term": {
                                      "application": {
                                        "argument": {"variable": "cx"},
                                        "function": {
                                          "function": {
                                            "elimination": {"record": {"field": "types", "typeName": "hydra.typing.TypeContext"}}}}}},
                                    "type": null}],
                                "body": {
                                  "let": {
                                    "bindings": [
                                      {
                                        "name": "wrapAfterTypeLambdas",
                                        "term": {
                                          "function": {
                                            "lambda": {
                                              "body": {
                                                "function": {
                                                  "lambda": {
                                                    "body": {
                                                      "application": {
                                                        "argument": {"variable": "term"},
                                                        "function": {
                                                          "function": {
                                                            "elimination": {
                                                              "union": {
                                                                "cases": [
                                                                  {
                                                                    "name": "typeLambda",
                                                                    "term": {
                                                                      "function": {
                                                                        "lambda": {
                                                                          "body": {
                                                                            "union": {
                                                                              "field": {
                                                                                "name": "typeLambda",
                                                                                "term": {
                                                                                  "record": {
                                                                                    "fields": [
                                                                                      {
                                                                                        "name": "parameter",
                                                                                        "term": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "tl"},
                                                                                            "function": {
                                                                                              "function": {
                                                                                                "elimination": {
                                                                                                  "record": {"field": "parameter", "typeName": "hydra.core.TypeLambda"}}}}}}},
                                                                                      {
                                                                                        "name": "body",
                                                                                        "term": {
                                                                                          "application": {
                                                                                            "argument": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "tl"},
                                                                                                "function": {
                                                                                                  "function": {
                                                                                                    "elimination": {"record": {"field": "body", "typeName": "hydra.core.TypeLambda"}}}}}},
                                                                                            "function": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "vars"},
                                                                                                "function": {"variable": "wrapAfterTypeLambdas"}}}}}}],
                                                                                    "typeName": "hydra.core.TypeLambda"}}},
                                                                              "typeName": "hydra.core.Term"}},
                                                                          "domain": null,
                                                                          "parameter": "tl"}}}}],
                                                                "default": [
                                                                  {
                                                                    "application": {
                                                                      "argument": {
                                                                        "application": {
                                                                          "argument": {"variable": "vars"},
                                                                          "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                      "function": {
                                                                        "application": {
                                                                          "argument": {"variable": "term"},
                                                                          "function": {
                                                                            "application": {
                                                                              "argument": {
                                                                                "function": {
                                                                                  "lambda": {
                                                                                    "body": {
                                                                                      "function": {
                                                                                        "lambda": {
                                                                                          "body": {
                                                                                            "union": {
                                                                                              "field": {
                                                                                                "name": "function",
                                                                                                "term": {
                                                                                                  "union": {
                                                                                                    "field": {
                                                                                                      "name": "lambda",
                                                                                                      "term": {
                                                                                                        "record": {
                                                                                                          "fields": [
                                                                                                            {
                                                                                                              "name": "parameter",
                                                                                                              "term": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "p"},
                                                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}}},
                                                                                                            {
                                                                                                              "name": "domain",
                                                                                                              "term": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "p"},
                                                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}},
                                                                                                            {"name": "body", "term": {"variable": "t"}}],
                                                                                                          "typeName": "hydra.core.Lambda"}}},
                                                                                                    "typeName": "hydra.core.Function"}}},
                                                                                              "typeName": "hydra.core.Term"}},
                                                                                          "domain": null,
                                                                                          "parameter": "p"}}},
                                                                                    "domain": null,
                                                                                    "parameter": "t"}}},
                                                                              "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}}],
                                                                "typeName": "hydra.core.Term"}}}}}},
                                                    "domain": null,
                                                    "parameter": "term"}}},
                                              "domain": null,
                                              "parameter": "vars"}}},
                                        "type": null}],
                                    "body": {
                                      "let": {
                                        "bindings": [
                                          {
                                            "name": "augment",
                                            "term": {
                                              "function": {
                                                "lambda": {
                                                  "body": {
                                                    "let": {
                                                      "bindings": [
                                                        {
                                                          "name": "freeVars",
                                                          "term": {
                                                            "application": {
                                                              "argument": {
                                                                "application": {
                                                                  "argument": {
                                                                    "application": {
                                                                      "argument": {
                                                                        "application": {
                                                                          "argument": {"variable": "b"},
                                                                          "function": {
                                                                            "function": {
                                                                              "elimination": {"record": {"field": "term", "typeName": "hydra.core.Binding"}}}}}},
                                                                      "function": {"variable": "hydra.rewriting.freeVariablesInTerm"}}},
                                                                  "function": {
                                                                    "application": {
                                                                      "argument": {"variable": "boundVars"},
                                                                      "function": {"function": {"primitive": "hydra.lib.sets.intersection"}}}}}},
                                                              "function": {"function": {"primitive": "hydra.lib.sets.toList"}}}},
                                                          "type": null}],
                                                      "body": {
                                                        "let": {
                                                          "bindings": [
                                                            {
                                                              "name": "varTypePairs",
                                                              "term": {
                                                                "application": {
                                                                  "argument": {"variable": "freeVars"},
                                                                  "function": {
                                                                    "application": {
                                                                      "argument": {
                                                                        "function": {
                                                                          "lambda": {
                                                                            "body": {
                                                                              "pair": {
                                                                                "@first": {"variable": "v"},
                                                                                "@second": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "types"},
                                                                                    "function": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "v"},
                                                                                        "function": {"function": {"primitive": "hydra.lib.maps.lookup"}}}}}}}},
                                                                            "domain": null,
                                                                            "parameter": "v"}}},
                                                                      "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                              "type": null}],
                                                          "body": {
                                                            "let": {
                                                              "bindings": [
                                                                {
                                                                  "name": "varTypes",
                                                                  "term": {
                                                                    "application": {
                                                                      "argument": {
                                                                        "application": {
                                                                          "argument": {"variable": "varTypePairs"},
                                                                          "function": {
                                                                            "application": {
                                                                              "argument": {"function": {"primitive": "hydra.lib.pairs.second"}},
                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                      "function": {"function": {"primitive": "hydra.lib.maybes.cat"}}}},
                                                                  "type": null}],
                                                              "body": {
                                                                "application": {
                                                                  "argument": {
                                                                    "pair": {
                                                                      "@first": {
                                                                        "record": {
                                                                          "fields": [
                                                                            {
                                                                              "name": "name",
                                                                              "term": {
                                                                                "application": {
                                                                                  "argument": {"variable": "b"},
                                                                                  "function": {
                                                                                    "function": {
                                                                                      "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}}},
                                                                            {
                                                                              "name": "term",
                                                                              "term": {
                                                                                "application": {
                                                                                  "argument": {
                                                                                    "application": {
                                                                                      "argument": {"variable": "b"},
                                                                                      "function": {
                                                                                        "function": {
                                                                                          "elimination": {"record": {"field": "term", "typeName": "hydra.core.Binding"}}}}}},
                                                                                  "function": {
                                                                                    "application": {
                                                                                      "argument": {"variable": "varTypePairs"},
                                                                                      "function": {"variable": "wrapAfterTypeLambdas"}}}}}},
                                                                            {
                                                                              "name": "type",
                                                                              "term": {
                                                                                "application": {
                                                                                  "argument": {
                                                                                    "application": {
                                                                                      "argument": {"variable": "b"},
                                                                                      "function": {
                                                                                        "function": {
                                                                                          "elimination": {"record": {"field": "type", "typeName": "hydra.core.Binding"}}}}}},
                                                                                  "function": {
                                                                                    "application": {
                                                                                      "argument": {
                                                                                        "function": {
                                                                                          "lambda": {
                                                                                            "body": {
                                                                                              "record": {
                                                                                                "fields": [
                                                                                                  {
                                                                                                    "name": "variables",
                                                                                                    "term": {
                                                                                                      "application": {
                                                                                                        "argument": {"variable": "ts"},
                                                                                                        "function": {
                                                                                                          "function": {
                                                                                                            "elimination": {
                                                                                                              "record": {"field": "variables", "typeName": "hydra.core.TypeScheme"}}}}}}},
                                                                                                  {
                                                                                                    "name": "type",
                                                                                                    "term": {
                                                                                                      "application": {
                                                                                                        "argument": {
                                                                                                          "application": {
                                                                                                            "argument": {"variable": "varTypes"},
                                                                                                            "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                                                        "function": {
                                                                                                          "application": {
                                                                                                            "argument": {
                                                                                                              "application": {
                                                                                                                "argument": {"variable": "ts"},
                                                                                                                "function": {
                                                                                                                  "function": {
                                                                                                                    "elimination": {"record": {"field": "type", "typeName": "hydra.core.TypeScheme"}}}}}},
                                                                                                            "function": {
                                                                                                              "application": {
                                                                                                                "argument": {
                                                                                                                  "function": {
                                                                                                                    "lambda": {
                                                                                                                      "body": {
                                                                                                                        "function": {
                                                                                                                          "lambda": {
                                                                                                                            "body": {
                                                                                                                              "union": {
                                                                                                                                "field": {
                                                                                                                                  "name": "function",
                                                                                                                                  "term": {
                                                                                                                                    "record": {
                                                                                                                                      "fields": [
                                                                                                                                        {"name": "domain", "term": {"variable": "t"}},
                                                                                                                                        {"name": "codomain", "term": {"variable": "acc"}}],
                                                                                                                                      "typeName": "hydra.core.FunctionType"}}},
                                                                                                                                "typeName": "hydra.core.Type"}},
                                                                                                                            "domain": null,
                                                                                                                            "parameter": "t"}}},
                                                                                                                      "domain": null,
                                                                                                                      "parameter": "acc"}}},
                                                                                                                "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}}},
                                                                                                  {
                                                                                                    "name": "constraints",
                                                                                                    "term": {
                                                                                                      "application": {
                                                                                                        "argument": {"variable": "ts"},
                                                                                                        "function": {
                                                                                                          "function": {
                                                                                                            "elimination": {
                                                                                                              "record": {"field": "constraints", "typeName": "hydra.core.TypeScheme"}}}}}}}],
                                                                                                "typeName": "hydra.core.TypeScheme"}},
                                                                                            "domain": null,
                                                                                            "parameter": "ts"}}},
                                                                                      "function": {"function": {"primitive": "hydra.lib.maybes.map"}}}}}}}],
                                                                          "typeName": "hydra.core.Binding"}},
                                                                      "@second": {
                                                                        "maybe": [
                                                                          {
                                                                            "pair": {
                                                                              "@first": {
                                                                                "application": {
                                                                                  "argument": {"variable": "b"},
                                                                                  "function": {
                                                                                    "function": {
                                                                                      "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}},
                                                                              "@second": {
                                                                                "application": {
                                                                                  "argument": {"variable": "freeVars"},
                                                                                  "function": {
                                                                                    "application": {
                                                                                      "argument": {
                                                                                        "union": {
                                                                                          "field": {
                                                                                            "name": "variable",
                                                                                            "term": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "b"},
                                                                                                "function": {
                                                                                                  "function": {
                                                                                                    "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}}},
                                                                                          "typeName": "hydra.core.Term"}},
                                                                                      "function": {
                                                                                        "application": {
                                                                                          "argument": {
                                                                                            "function": {
                                                                                              "lambda": {
                                                                                                "body": {
                                                                                                  "function": {
                                                                                                    "lambda": {
                                                                                                      "body": {
                                                                                                        "union": {
                                                                                                          "field": {
                                                                                                            "name": "application",
                                                                                                            "term": {
                                                                                                              "record": {
                                                                                                                "fields": [
                                                                                                                  {"name": "function", "term": {"variable": "t"}},
                                                                                                                  {
                                                                                                                    "name": "argument",
                                                                                                                    "term": {
                                                                                                                      "union": {
                                                                                                                        "field": {"name": "variable", "term": {"variable": "v"}},
                                                                                                                        "typeName": "hydra.core.Term"}}}],
                                                                                                                "typeName": "hydra.core.Application"}}},
                                                                                                          "typeName": "hydra.core.Term"}},
                                                                                                      "domain": null,
                                                                                                      "parameter": "v"}}},
                                                                                                "domain": null,
                                                                                                "parameter": "t"}}},
                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}}}}]}}},
                                                                  "function": {
                                                                    "application": {
                                                                      "argument": {"pair": {"@first": {"variable": "b"}, "@second": {"maybe": null}}},
                                                                      "function": {
                                                                        "application": {
                                                                          "argument": {
                                                                            "application": {
                                                                              "argument": {
                                                                                "application": {
                                                                                  "argument": {
                                                                                    "application": {
                                                                                      "argument": {
                                                                                        "application": {
                                                                                          "argument": {"variable": "varTypePairs"},
                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.length"}}}},
                                                                                      "function": {
                                                                                        "application": {
                                                                                          "argument": {
                                                                                            "application": {
                                                                                              "argument": {"variable": "varTypes"},
                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.length"}}}},
                                                                                          "function": {"function": {"primitive": "hydra.lib.equality.equal"}}}}}},
                                                                                  "function": {"function": {"primitive": "hydra.lib.logic.not"}}}},
                                                                              "function": {
                                                                                "application": {
                                                                                  "argument": {
                                                                                    "application": {
                                                                                      "argument": {"variable": "freeVars"},
                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.null"}}}},
                                                                                  "function": {"function": {"primitive": "hydra.lib.logic.or"}}}}}},
                                                                          "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}}}}}}}},
                                                  "domain": null,
                                                  "parameter": "b"}}},
                                            "type": null}],
                                        "body": {
                                          "let": {
                                            "bindings": [
                                              {
                                                "name": "results",
                                                "term": {
                                                  "application": {
                                                    "argument": {"variable": "bindings"},
                                                    "function": {
                                                      "application": {
                                                        "argument": {"variable": "augment"},
                                                        "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                "type": null}],
                                            "body": {
                                              "pair": {
                                                "@first": {
                                                  "application": {
                                                    "argument": {"variable": "results"},
                                                    "function": {
                                                      "application": {
                                                        "argument": {"function": {"primitive": "hydra.lib.pairs.first"}},
                                                        "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                "@second": {
                                                  "wrap": {
                                                    "body": {
                                                      "application": {
                                                        "argument": {
                                                          "application": {
                                                            "argument": {
                                                              "application": {
                                                                "argument": {"variable": "results"},
                                                                "function": {
                                                                  "application": {
                                                                    "argument": {"function": {"primitive": "hydra.lib.pairs.second"}},
                                                                    "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                            "function": {"function": {"primitive": "hydra.lib.maybes.cat"}}}},
                                                        "function": {"function": {"primitive": "hydra.lib.maps.fromList"}}}},
                                                    "typeName": "hydra.typing.TermSubst"}}}}}}}}}}}},
                            "domain": null,
                            "parameter": "bindings"}}},
                      "domain": null,
                      "parameter": "boundVars"}}},
                "domain": null,
                "parameter": "cx"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.bindingIsPolymorphic",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Check if a binding has a polymorphic type (non-empty list of type scheme variables)"}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "application": {
                    "argument": {
                      "application": {
                        "argument": {"variable": "binding"},
                        "function": {
                          "function": {
                            "elimination": {"record": {"field": "type", "typeName": "hydra.core.Binding"}}}}}},
                    "function": {
                      "application": {
                        "argument": {
                          "function": {
                            "lambda": {
                              "body": {
                                "application": {
                                  "argument": {
                                    "application": {
                                      "argument": {
                                        "application": {
                                          "argument": {"variable": "ts"},
                                          "function": {
                                            "function": {
                                              "elimination": {
                                                "record": {"field": "variables", "typeName": "hydra.core.TypeScheme"}}}}}},
                                      "function": {"function": {"primitive": "hydra.lib.lists.null"}}}},
                                  "function": {"function": {"primitive": "hydra.lib.logic.not"}}}},
                              "domain": null,
                              "parameter": "ts"}}},
                        "function": {
                          "application": {
                            "argument": {"literal": {"boolean": false}},
                            "function": {"function": {"primitive": "hydra.lib.maybes.maybe"}}}}}}}},
                "domain": null,
                "parameter": "binding"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.bindingUsesContextTypeVars",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Check if a binding's type uses any type variables from the given TypeContext. Returns True if the free type variables in the binding's type intersect with the type variables in scope (typeContextTypeVariables)."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "application": {
                          "argument": {
                            "application": {
                              "argument": {"variable": "binding"},
                              "function": {
                                "function": {
                                  "elimination": {"record": {"field": "type", "typeName": "hydra.core.Binding"}}}}}},
                          "function": {
                            "application": {
                              "argument": {
                                "function": {
                                  "lambda": {
                                    "body": {
                                      "let": {
                                        "bindings": [
                                          {
                                            "name": "freeInType",
                                            "term": {
                                              "application": {
                                                "argument": {
                                                  "application": {
                                                    "argument": {"variable": "ts"},
                                                    "function": {
                                                      "function": {
                                                        "elimination": {"record": {"field": "type", "typeName": "hydra.core.TypeScheme"}}}}}},
                                                "function": {"variable": "hydra.rewriting.freeVariablesInType"}}},
                                            "type": null}],
                                        "body": {
                                          "let": {
                                            "bindings": [
                                              {
                                                "name": "contextTypeVars",
                                                "term": {
                                                  "application": {
                                                    "argument": {"variable": "cx"},
                                                    "function": {
                                                      "function": {
                                                        "elimination": {
                                                          "record": {"field": "typeVariables", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                "type": null}],
                                            "body": {
                                              "application": {
                                                "argument": {
                                                  "application": {
                                                    "argument": {
                                                      "application": {
                                                        "argument": {"variable": "contextTypeVars"},
                                                        "function": {
                                                          "application": {
                                                            "argument": {"variable": "freeInType"},
                                                            "function": {"function": {"primitive": "hydra.lib.sets.intersection"}}}}}},
                                                    "function": {"function": {"primitive": "hydra.lib.sets.null"}}}},
                                                "function": {"function": {"primitive": "hydra.lib.logic.not"}}}}}}}},
                                    "domain": null,
                                    "parameter": "ts"}}},
                              "function": {
                                "application": {
                                  "argument": {"literal": {"boolean": false}},
                                  "function": {"function": {"primitive": "hydra.lib.maybes.maybe"}}}}}}}},
                      "domain": null,
                      "parameter": "binding"}}},
                "domain": null,
                "parameter": "cx"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.countVarOccurrences",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Count the number of occurrences of a variable name in a term. Assumes no variable shadowing."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "let": {
                          "bindings": [
                            {
                              "name": "childCount",
                              "term": {
                                "application": {
                                  "argument": {
                                    "application": {
                                      "argument": {"variable": "term"},
                                      "function": {"variable": "hydra.rewriting.subterms"}}},
                                  "function": {
                                    "application": {
                                      "argument": {"literal": {"integer": {"int32": 0}}},
                                      "function": {
                                        "application": {
                                          "argument": {
                                            "function": {
                                              "lambda": {
                                                "body": {
                                                  "function": {
                                                    "lambda": {
                                                      "body": {
                                                        "application": {
                                                          "argument": {
                                                            "application": {
                                                              "argument": {"variable": "t"},
                                                              "function": {
                                                                "application": {
                                                                  "argument": {"variable": "name"},
                                                                  "function": {"variable": "hydra.hoisting.countVarOccurrences"}}}}},
                                                          "function": {
                                                            "application": {
                                                              "argument": {"variable": "acc"},
                                                              "function": {"function": {"primitive": "hydra.lib.math.add"}}}}}},
                                                      "domain": null,
                                                      "parameter": "t"}}},
                                                "domain": null,
                                                "parameter": "acc"}}},
                                          "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                              "type": null}],
                          "body": {
                            "application": {
                              "argument": {"variable": "term"},
                              "function": {
                                "function": {
                                  "elimination": {
                                    "union": {
                                      "cases": [
                                        {
                                          "name": "variable",
                                          "term": {
                                            "function": {
                                              "lambda": {
                                                "body": {
                                                  "application": {
                                                    "argument": {"variable": "childCount"},
                                                    "function": {
                                                      "application": {
                                                        "argument": {
                                                          "application": {
                                                            "argument": {"variable": "childCount"},
                                                            "function": {
                                                              "application": {
                                                                "argument": {"literal": {"integer": {"int32": 1}}},
                                                                "function": {"function": {"primitive": "hydra.lib.math.add"}}}}}},
                                                        "function": {
                                                          "application": {
                                                            "argument": {
                                                              "application": {
                                                                "argument": {"variable": "name"},
                                                                "function": {
                                                                  "application": {
                                                                    "argument": {"variable": "v"},
                                                                    "function": {"function": {"primitive": "hydra.lib.equality.equal"}}}}}},
                                                            "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                "domain": null,
                                                "parameter": "v"}}}}],
                                      "default": [{"variable": "childCount"}],
                                      "typeName": "hydra.core.Term"}}}}}}}},
                      "domain": null,
                      "parameter": "term"}}},
                "domain": null,
                "parameter": "name"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.hoistAllLetBindings",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Transform a let-term by pulling ALL let bindings to the top level. This is useful for targets like Java that don't support nested let expressions at all. If a hoisted binding captures lambda-bound variables from an enclosing scope, the binding is wrapped in lambdas for those variables, and references are replaced with applications. Note: Assumes no variable shadowing; use hydra.rewriting.unshadowVariables first."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "let": {
                    "bindings": [
                      {
                        "name": "emptyIx",
                        "term": {
                          "record": {
                            "fields": [
                              {
                                "name": "schemaTypes",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {
                                "name": "primitiveTypes",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {
                                "name": "dataTypes",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {
                                "name": "classConstraints",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {"name": "debug", "term": {"literal": {"boolean": false}}}],
                            "typeName": "hydra.typing.InferenceContext"}},
                        "type": null}],
                    "body": {
                      "let": {
                        "bindings": [
                          {
                            "name": "emptyCx",
                            "term": {
                              "record": {
                                "fields": [
                                  {
                                    "name": "types",
                                    "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                  {
                                    "name": "metadata",
                                    "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                  {
                                    "name": "typeVariables",
                                    "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                  {
                                    "name": "lambdaVariables",
                                    "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                  {
                                    "name": "letVariables",
                                    "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                  {"name": "inferenceContext", "term": {"variable": "emptyIx"}}],
                                "typeName": "hydra.typing.TypeContext"}},
                            "type": null}],
                        "body": {
                          "application": {
                            "argument": {"variable": "let0"},
                            "function": {
                              "application": {
                                "argument": {"variable": "emptyCx"},
                                "function": {
                                  "application": {
                                    "argument": {"variable": "hydra.hoisting.shouldHoistAll"},
                                    "function": {
                                      "application": {
                                        "argument": {
                                          "function": {
                                            "lambda": {
                                              "body": {"literal": {"boolean": true}},
                                              "domain": null,
                                              "parameter": "_"}}},
                                        "function": {"variable": "hydra.hoisting.hoistLetBindingsWithPredicate"}}}}}}}}}}}}},
                "domain": null,
                "parameter": "let0"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.hoistCaseStatements",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Hoist case statements into local let bindings. This is useful for targets such as Python which only support case statements (match) at the top level. Case statements are hoisted only when they appear at non-top-level positions. Top level = root, or reachable through annotations, let body/binding, lambda bodies, or ONE application LHS. Once through an application LHS, lambda bodies no longer count as pass-through."}}}],
          "body": {
            "application": {
              "argument": {"variable": "hydra.hoisting.shouldHoistCaseStatement"},
              "function": {"variable": "hydra.hoisting.hoistSubterms"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.hoistCaseStatementsInGraph",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Hoist case statements into local let bindings for all elements in a graph. This version operates prior to inference and uses an empty type context. It hoists case statements and their applied arguments into let bindings."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "let": {
                    "bindings": [
                      {
                        "name": "emptyIx",
                        "term": {
                          "record": {
                            "fields": [
                              {
                                "name": "schemaTypes",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {
                                "name": "primitiveTypes",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {
                                "name": "dataTypes",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {
                                "name": "classConstraints",
                                "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                              {"name": "debug", "term": {"literal": {"boolean": false}}}],
                            "typeName": "hydra.typing.InferenceContext"}},
                        "type": null}],
                    "body": {
                      "let": {
                        "bindings": [
                          {
                            "name": "emptyTx",
                            "term": {
                              "record": {
                                "fields": [
                                  {
                                    "name": "types",
                                    "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                  {
                                    "name": "metadata",
                                    "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                  {
                                    "name": "typeVariables",
                                    "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                  {
                                    "name": "lambdaVariables",
                                    "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                  {
                                    "name": "letVariables",
                                    "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                  {"name": "inferenceContext", "term": {"variable": "emptyIx"}}],
                                "typeName": "hydra.typing.TypeContext"}},
                            "type": null}],
                        "body": {
                          "let": {
                            "bindings": [
                              {
                                "name": "gterm0",
                                "term": {
                                  "application": {
                                    "argument": {"variable": "graph"},
                                    "function": {"variable": "hydra.schemas.graphAsTerm"}}},
                                "type": null}],
                            "body": {
                              "let": {
                                "bindings": [
                                  {
                                    "name": "gterm1",
                                    "term": {
                                      "application": {
                                        "argument": {"variable": "gterm0"},
                                        "function": {
                                          "application": {
                                            "argument": {"variable": "emptyTx"},
                                            "function": {"variable": "hydra.hoisting.hoistCaseStatements"}}}}},
                                    "type": null}],
                                "body": {
                                  "let": {
                                    "bindings": [
                                      {
                                        "name": "newElements",
                                        "term": {
                                          "application": {
                                            "argument": {"variable": "gterm1"},
                                            "function": {"variable": "hydra.schemas.termAsGraph"}}},
                                        "type": null}],
                                    "body": {
                                      "application": {
                                        "argument": {
                                          "record": {
                                            "fields": [
                                              {"name": "elements", "term": {"variable": "newElements"}},
                                              {
                                                "name": "environment",
                                                "term": {
                                                  "application": {
                                                    "argument": {"variable": "graph"},
                                                    "function": {
                                                      "function": {
                                                        "elimination": {"record": {"field": "environment", "typeName": "hydra.graph.Graph"}}}}}}},
                                              {
                                                "name": "types",
                                                "term": {
                                                  "application": {
                                                    "argument": {"variable": "graph"},
                                                    "function": {
                                                      "function": {
                                                        "elimination": {"record": {"field": "types", "typeName": "hydra.graph.Graph"}}}}}}},
                                              {
                                                "name": "body",
                                                "term": {
                                                  "application": {
                                                    "argument": {"variable": "graph"},
                                                    "function": {
                                                      "function": {
                                                        "elimination": {"record": {"field": "body", "typeName": "hydra.graph.Graph"}}}}}}},
                                              {
                                                "name": "primitives",
                                                "term": {
                                                  "application": {
                                                    "argument": {"variable": "graph"},
                                                    "function": {
                                                      "function": {
                                                        "elimination": {"record": {"field": "primitives", "typeName": "hydra.graph.Graph"}}}}}}},
                                              {
                                                "name": "schema",
                                                "term": {
                                                  "application": {
                                                    "argument": {"variable": "graph"},
                                                    "function": {
                                                      "function": {
                                                        "elimination": {"record": {"field": "schema", "typeName": "hydra.graph.Graph"}}}}}}}],
                                            "typeName": "hydra.graph.Graph"}},
                                        "function": {"function": {"primitive": "hydra.lib.flows.pure"}}}}}}}}}}}}}},
                "domain": null,
                "parameter": "graph"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.hoistLetBindingsWithContext",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Transform a let-term by pulling polymorphic let bindings to the top level, using TypeContext. A binding is hoisted if: (1) It is polymorphic (has non-empty typeSchemeVariables), OR (2) Its type uses type variables from the TypeContext (i.e., from enclosing type lambdas). Bindings which are already at the top level are not hoisted. If a hoisted binding captures lambda-bound or let-bound variables from an enclosing scope, the binding is wrapped in lambdas for those variables, and references are replaced with applications. If a hoisted binding uses type variables from the context, those type variables are added to the binding's type scheme. Note: we assume that there is no variable shadowing; use hydra.rewriting.unshadowVariables first."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "function": {
                          "lambda": {
                            "body": {
                              "application": {
                                "argument": {"variable": "let0"},
                                "function": {
                                  "application": {
                                    "argument": {"variable": "cx"},
                                    "function": {
                                      "application": {
                                        "argument": {"variable": "hydra.hoisting.shouldHoistPolymorphic"},
                                        "function": {
                                          "application": {
                                            "argument": {"variable": "isParentBinding"},
                                            "function": {"variable": "hydra.hoisting.hoistLetBindingsWithPredicate"}}}}}}}}},
                            "domain": null,
                            "parameter": "let0"}}},
                      "domain": null,
                      "parameter": "cx"}}},
                "domain": null,
                "parameter": "isParentBinding"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.hoistLetBindingsWithPredicate",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Transform a let-term by pulling let bindings to the top level. The isParentBinding predicate applies to top-level bindings and determines whether their subterm bindings are eligible for hoisting. The shouldHoistBinding predicate takes the TypeContext and a subterm binding, and returns True if the binding should be hoisted. This is useful for targets like Java that cannot have polymorphic definitions in arbitrary positions. The TypeContext provides information about type variables and lambda variables in scope. If a hoisted binding captures let-bound or lambda-bound variables from an enclosing scope, the binding is wrapped in lambdas for those variables, and references are replaced with applications. If a hoisted binding captures type variables from an enclosing type lambda scope, those type variables are added to the binding's type scheme, and references are replaced with type applications. Note: we assume that there is no variable shadowing; use hydra.rewriting.unshadowVariables first."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "function": {
                          "lambda": {
                            "body": {
                              "function": {
                                "lambda": {
                                  "body": {
                                    "let": {
                                      "bindings": [
                                        {
                                          "name": "hoistOne",
                                          "term": {
                                            "function": {
                                              "lambda": {
                                                "body": {
                                                  "function": {
                                                    "lambda": {
                                                      "body": {
                                                        "function": {
                                                          "lambda": {
                                                            "body": {
                                                              "function": {
                                                                "lambda": {
                                                                  "body": {
                                                                    "let": {
                                                                      "bindings": [
                                                                        {
                                                                          "name": "bindingAndReplacementPairs",
                                                                          "term": {
                                                                            "application": {
                                                                              "argument": {"variable": "pair"},
                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                          "type": null}],
                                                                      "body": {
                                                                        "let": {
                                                                          "bindings": [
                                                                            {
                                                                              "name": "alreadyUsedNames",
                                                                              "term": {
                                                                                "application": {
                                                                                  "argument": {"variable": "pair"},
                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                              "type": null}],
                                                                          "body": {
                                                                            "let": {
                                                                              "bindings": [
                                                                                {
                                                                                  "name": "b",
                                                                                  "term": {
                                                                                    "application": {
                                                                                      "argument": {"variable": "bindingWithCapturedVars"},
                                                                                      "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                  "type": null}],
                                                                              "body": {
                                                                                "let": {
                                                                                  "bindings": [
                                                                                    {
                                                                                      "name": "capturedTermVars",
                                                                                      "term": {
                                                                                        "application": {
                                                                                          "argument": {"variable": "bindingWithCapturedVars"},
                                                                                          "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                      "type": null}],
                                                                                  "body": {
                                                                                    "let": {
                                                                                      "bindings": [
                                                                                        {
                                                                                          "name": "types",
                                                                                          "term": {
                                                                                            "application": {
                                                                                              "argument": {"variable": "cx"},
                                                                                              "function": {
                                                                                                "function": {
                                                                                                  "elimination": {"record": {"field": "types", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                                          "type": null}],
                                                                                      "body": {
                                                                                        "let": {
                                                                                          "bindings": [
                                                                                            {
                                                                                              "name": "capturedTermVarTypePairs",
                                                                                              "term": {
                                                                                                "application": {
                                                                                                  "argument": {"variable": "capturedTermVars"},
                                                                                                  "function": {
                                                                                                    "application": {
                                                                                                      "argument": {
                                                                                                        "function": {
                                                                                                          "lambda": {
                                                                                                            "body": {
                                                                                                              "pair": {
                                                                                                                "@first": {"variable": "v"},
                                                                                                                "@second": {
                                                                                                                  "application": {
                                                                                                                    "argument": {"variable": "types"},
                                                                                                                    "function": {
                                                                                                                      "application": {
                                                                                                                        "argument": {"variable": "v"},
                                                                                                                        "function": {"function": {"primitive": "hydra.lib.maps.lookup"}}}}}}}},
                                                                                                            "domain": null,
                                                                                                            "parameter": "v"}}},
                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                              "type": null}],
                                                                                          "body": {
                                                                                            "let": {
                                                                                              "bindings": [
                                                                                                {
                                                                                                  "name": "capturedTypeVars",
                                                                                                  "term": {
                                                                                                    "application": {
                                                                                                      "argument": {
                                                                                                        "application": {
                                                                                                          "argument": {
                                                                                                            "application": {
                                                                                                              "argument": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "b"},
                                                                                                                  "function": {
                                                                                                                    "function": {
                                                                                                                      "elimination": {"record": {"field": "type", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                              "function": {
                                                                                                                "application": {
                                                                                                                  "argument": {
                                                                                                                    "function": {
                                                                                                                      "lambda": {
                                                                                                                        "body": {
                                                                                                                          "application": {
                                                                                                                            "argument": {
                                                                                                                              "application": {
                                                                                                                                "argument": {"variable": "ts"},
                                                                                                                                "function": {
                                                                                                                                  "function": {
                                                                                                                                    "elimination": {"record": {"field": "type", "typeName": "hydra.core.TypeScheme"}}}}}},
                                                                                                                            "function": {"variable": "hydra.rewriting.freeVariablesInType"}}},
                                                                                                                        "domain": null,
                                                                                                                        "parameter": "ts"}}},
                                                                                                                  "function": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"function": {"primitive": "hydra.lib.sets.empty"}},
                                                                                                                      "function": {"function": {"primitive": "hydra.lib.maybes.maybe"}}}}}}}},
                                                                                                          "function": {
                                                                                                            "application": {
                                                                                                              "argument": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "cx"},
                                                                                                                  "function": {
                                                                                                                    "function": {
                                                                                                                      "elimination": {
                                                                                                                        "record": {"field": "typeVariables", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                                                              "function": {"function": {"primitive": "hydra.lib.sets.intersection"}}}}}},
                                                                                                      "function": {"function": {"primitive": "hydra.lib.sets.toList"}}}},
                                                                                                  "type": null}],
                                                                                              "body": {
                                                                                                "let": {
                                                                                                  "bindings": [
                                                                                                    {
                                                                                                      "name": "globalBindingName",
                                                                                                      "term": {
                                                                                                        "application": {
                                                                                                          "argument": {
                                                                                                            "wrap": {
                                                                                                              "body": {
                                                                                                                "application": {
                                                                                                                  "argument": {
                                                                                                                    "application": {
                                                                                                                      "argument": {
                                                                                                                        "application": {
                                                                                                                          "argument": {"variable": "b"},
                                                                                                                          "function": {
                                                                                                                            "function": {
                                                                                                                              "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                                      "function": {"function": {"elimination": {"wrap": "hydra.core.Name"}}}}},
                                                                                                                  "function": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "prefix"},
                                                                                                                      "function": {"function": {"primitive": "hydra.lib.strings.cat2"}}}}}},
                                                                                                              "typeName": "hydra.core.Name"}},
                                                                                                          "function": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "alreadyUsedNames"},
                                                                                                              "function": {"variable": "hydra.lexical.chooseUniqueName"}}}}},
                                                                                                      "type": null}],
                                                                                                  "body": {
                                                                                                    "let": {
                                                                                                      "bindings": [
                                                                                                        {
                                                                                                          "name": "newUsedNames",
                                                                                                          "term": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "alreadyUsedNames"},
                                                                                                              "function": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "globalBindingName"},
                                                                                                                  "function": {"function": {"primitive": "hydra.lib.sets.insert"}}}}}},
                                                                                                          "type": null}],
                                                                                                      "body": {
                                                                                                        "let": {
                                                                                                          "bindings": [
                                                                                                            {
                                                                                                              "name": "capturedTermVarTypes",
                                                                                                              "term": {
                                                                                                                "application": {
                                                                                                                  "argument": {
                                                                                                                    "application": {
                                                                                                                      "argument": {
                                                                                                                        "application": {
                                                                                                                          "argument": {"variable": "capturedTermVarTypePairs"},
                                                                                                                          "function": {
                                                                                                                            "application": {
                                                                                                                              "argument": {"function": {"primitive": "hydra.lib.pairs.second"}},
                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                      "function": {"function": {"primitive": "hydra.lib.maybes.cat"}}}},
                                                                                                                  "function": {
                                                                                                                    "application": {
                                                                                                                      "argument": {
                                                                                                                        "function": {
                                                                                                                          "lambda": {
                                                                                                                            "body": {
                                                                                                                              "application": {
                                                                                                                                "argument": {"variable": "typ"},
                                                                                                                                "function": {"variable": "hydra.rewriting.deannotateTypeParameters"}}},
                                                                                                                            "domain": null,
                                                                                                                            "parameter": "typ"}}},
                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                              "type": null}],
                                                                                                          "body": {
                                                                                                            "let": {
                                                                                                              "bindings": [
                                                                                                                {
                                                                                                                  "name": "newTypeScheme",
                                                                                                                  "term": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"maybe": null},
                                                                                                                      "function": {
                                                                                                                        "application": {
                                                                                                                          "argument": {
                                                                                                                            "application": {
                                                                                                                              "argument": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {"variable": "b"},
                                                                                                                                  "function": {
                                                                                                                                    "function": {
                                                                                                                                      "elimination": {"record": {"field": "type", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                                              "function": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {
                                                                                                                                    "function": {
                                                                                                                                      "lambda": {
                                                                                                                                        "body": {
                                                                                                                                          "record": {
                                                                                                                                            "fields": [
                                                                                                                                              {
                                                                                                                                                "name": "variables",
                                                                                                                                                "term": {
                                                                                                                                                  "application": {
                                                                                                                                                    "argument": {
                                                                                                                                                      "application": {
                                                                                                                                                        "argument": {
                                                                                                                                                          "application": {
                                                                                                                                                            "argument": {"variable": "ts"},
                                                                                                                                                            "function": {
                                                                                                                                                              "function": {
                                                                                                                                                                "elimination": {
                                                                                                                                                                  "record": {"field": "variables", "typeName": "hydra.core.TypeScheme"}}}}}},
                                                                                                                                                        "function": {
                                                                                                                                                          "application": {
                                                                                                                                                            "argument": {"variable": "capturedTypeVars"},
                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.lists.concat2"}}}}}},
                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.lists.nub"}}}}},
                                                                                                                                              {
                                                                                                                                                "name": "type",
                                                                                                                                                "term": {
                                                                                                                                                  "application": {
                                                                                                                                                    "argument": {
                                                                                                                                                      "application": {
                                                                                                                                                        "argument": {"variable": "capturedTermVarTypes"},
                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                                                                                                    "function": {
                                                                                                                                                      "application": {
                                                                                                                                                        "argument": {
                                                                                                                                                          "application": {
                                                                                                                                                            "argument": {"variable": "ts"},
                                                                                                                                                            "function": {
                                                                                                                                                              "function": {
                                                                                                                                                                "elimination": {"record": {"field": "type", "typeName": "hydra.core.TypeScheme"}}}}}},
                                                                                                                                                        "function": {
                                                                                                                                                          "application": {
                                                                                                                                                            "argument": {
                                                                                                                                                              "function": {
                                                                                                                                                                "lambda": {
                                                                                                                                                                  "body": {
                                                                                                                                                                    "function": {
                                                                                                                                                                      "lambda": {
                                                                                                                                                                        "body": {
                                                                                                                                                                          "union": {
                                                                                                                                                                            "field": {
                                                                                                                                                                              "name": "function",
                                                                                                                                                                              "term": {
                                                                                                                                                                                "record": {
                                                                                                                                                                                  "fields": [
                                                                                                                                                                                    {"name": "domain", "term": {"variable": "a"}},
                                                                                                                                                                                    {"name": "codomain", "term": {"variable": "t"}}],
                                                                                                                                                                                  "typeName": "hydra.core.FunctionType"}}},
                                                                                                                                                                            "typeName": "hydra.core.Type"}},
                                                                                                                                                                        "domain": null,
                                                                                                                                                                        "parameter": "a"}}},
                                                                                                                                                                  "domain": null,
                                                                                                                                                                  "parameter": "t"}}},
                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}}},
                                                                                                                                              {
                                                                                                                                                "name": "constraints",
                                                                                                                                                "term": {
                                                                                                                                                  "application": {
                                                                                                                                                    "argument": {"variable": "ts"},
                                                                                                                                                    "function": {
                                                                                                                                                      "function": {
                                                                                                                                                        "elimination": {
                                                                                                                                                          "record": {"field": "constraints", "typeName": "hydra.core.TypeScheme"}}}}}}}],
                                                                                                                                            "typeName": "hydra.core.TypeScheme"}},
                                                                                                                                        "domain": null,
                                                                                                                                        "parameter": "ts"}}},
                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.maybes.map"}}}}}},
                                                                                                                          "function": {
                                                                                                                            "application": {
                                                                                                                              "argument": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {"variable": "capturedTermVarTypePairs"},
                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.length"}}}},
                                                                                                                                  "function": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {
                                                                                                                                        "application": {
                                                                                                                                          "argument": {"variable": "capturedTermVarTypes"},
                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.length"}}}},
                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.equality.equal"}}}}}},
                                                                                                                              "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                                                                                  "type": null}],
                                                                                                              "body": {
                                                                                                                "let": {
                                                                                                                  "bindings": [
                                                                                                                    {
                                                                                                                      "name": "strippedTerm",
                                                                                                                      "term": {
                                                                                                                        "application": {
                                                                                                                          "argument": {
                                                                                                                            "application": {
                                                                                                                              "argument": {"variable": "b"},
                                                                                                                              "function": {
                                                                                                                                "function": {
                                                                                                                                  "elimination": {"record": {"field": "term", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                                          "function": {"variable": "hydra.rewriting.detypeTerm"}}},
                                                                                                                      "type": null}],
                                                                                                                  "body": {
                                                                                                                    "let": {
                                                                                                                      "bindings": [
                                                                                                                        {
                                                                                                                          "name": "termWithLambdas",
                                                                                                                          "term": {
                                                                                                                            "application": {
                                                                                                                              "argument": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {"variable": "capturedTermVarTypePairs"},
                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                                                                              "function": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {"variable": "strippedTerm"},
                                                                                                                                  "function": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {
                                                                                                                                        "function": {
                                                                                                                                          "lambda": {
                                                                                                                                            "body": {
                                                                                                                                              "function": {
                                                                                                                                                "lambda": {
                                                                                                                                                  "body": {
                                                                                                                                                    "union": {
                                                                                                                                                      "field": {
                                                                                                                                                        "name": "function",
                                                                                                                                                        "term": {
                                                                                                                                                          "union": {
                                                                                                                                                            "field": {
                                                                                                                                                              "name": "lambda",
                                                                                                                                                              "term": {
                                                                                                                                                                "record": {
                                                                                                                                                                  "fields": [
                                                                                                                                                                    {
                                                                                                                                                                      "name": "parameter",
                                                                                                                                                                      "term": {
                                                                                                                                                                        "application": {
                                                                                                                                                                          "argument": {"variable": "p"},
                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}}},
                                                                                                                                                                    {
                                                                                                                                                                      "name": "domain",
                                                                                                                                                                      "term": {
                                                                                                                                                                        "application": {
                                                                                                                                                                          "argument": {
                                                                                                                                                                            "application": {
                                                                                                                                                                              "argument": {"variable": "p"},
                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                                                                                          "function": {
                                                                                                                                                                            "application": {
                                                                                                                                                                              "argument": {
                                                                                                                                                                                "function": {
                                                                                                                                                                                  "lambda": {
                                                                                                                                                                                    "body": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {"variable": "dom"},
                                                                                                                                                                                        "function": {"variable": "hydra.rewriting.deannotateTypeParameters"}}},
                                                                                                                                                                                    "domain": null,
                                                                                                                                                                                    "parameter": "dom"}}},
                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.maybes.map"}}}}}}},
                                                                                                                                                                    {"name": "body", "term": {"variable": "t"}}],
                                                                                                                                                                  "typeName": "hydra.core.Lambda"}}},
                                                                                                                                                            "typeName": "hydra.core.Function"}}},
                                                                                                                                                      "typeName": "hydra.core.Term"}},
                                                                                                                                                  "domain": null,
                                                                                                                                                  "parameter": "p"}}},
                                                                                                                                            "domain": null,
                                                                                                                                            "parameter": "t"}}},
                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                                                                                                          "type": null}],
                                                                                                                      "body": {
                                                                                                                        "let": {
                                                                                                                          "bindings": [
                                                                                                                            {
                                                                                                                              "name": "termWithTypeLambdas",
                                                                                                                              "term": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {
                                                                                                                                        "application": {
                                                                                                                                          "argument": {"variable": "newTypeScheme"},
                                                                                                                                          "function": {
                                                                                                                                            "application": {
                                                                                                                                              "argument": {
                                                                                                                                                "function": {
                                                                                                                                                  "elimination": {
                                                                                                                                                    "record": {"field": "variables", "typeName": "hydra.core.TypeScheme"}}}},
                                                                                                                                              "function": {
                                                                                                                                                "application": {
                                                                                                                                                  "argument": {"list": []},
                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.maybes.maybe"}}}}}}}},
                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                                                                                  "function": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {"variable": "termWithLambdas"},
                                                                                                                                      "function": {
                                                                                                                                        "application": {
                                                                                                                                          "argument": {
                                                                                                                                            "function": {
                                                                                                                                              "lambda": {
                                                                                                                                                "body": {
                                                                                                                                                  "function": {
                                                                                                                                                    "lambda": {
                                                                                                                                                      "body": {
                                                                                                                                                        "union": {
                                                                                                                                                          "field": {
                                                                                                                                                            "name": "typeLambda",
                                                                                                                                                            "term": {
                                                                                                                                                              "record": {
                                                                                                                                                                "fields": [
                                                                                                                                                                  {"name": "parameter", "term": {"variable": "v"}},
                                                                                                                                                                  {"name": "body", "term": {"variable": "t"}}],
                                                                                                                                                                "typeName": "hydra.core.TypeLambda"}}},
                                                                                                                                                          "typeName": "hydra.core.Term"}},
                                                                                                                                                      "domain": null,
                                                                                                                                                      "parameter": "v"}}},
                                                                                                                                                "domain": null,
                                                                                                                                                "parameter": "t"}}},
                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                                                                                                              "type": null}],
                                                                                                                          "body": {
                                                                                                                            "let": {
                                                                                                                              "bindings": [
                                                                                                                                {
                                                                                                                                  "name": "replacement",
                                                                                                                                  "term": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {"variable": "capturedTermVars"},
                                                                                                                                      "function": {
                                                                                                                                        "application": {
                                                                                                                                          "argument": {
                                                                                                                                            "union": {
                                                                                                                                              "field": {"name": "variable", "term": {"variable": "globalBindingName"}},
                                                                                                                                              "typeName": "hydra.core.Term"}},
                                                                                                                                          "function": {
                                                                                                                                            "application": {
                                                                                                                                              "argument": {
                                                                                                                                                "function": {
                                                                                                                                                  "lambda": {
                                                                                                                                                    "body": {
                                                                                                                                                      "function": {
                                                                                                                                                        "lambda": {
                                                                                                                                                          "body": {
                                                                                                                                                            "union": {
                                                                                                                                                              "field": {
                                                                                                                                                                "name": "application",
                                                                                                                                                                "term": {
                                                                                                                                                                  "record": {
                                                                                                                                                                    "fields": [
                                                                                                                                                                      {"name": "function", "term": {"variable": "t"}},
                                                                                                                                                                      {
                                                                                                                                                                        "name": "argument",
                                                                                                                                                                        "term": {
                                                                                                                                                                          "union": {
                                                                                                                                                                            "field": {"name": "variable", "term": {"variable": "v"}},
                                                                                                                                                                            "typeName": "hydra.core.Term"}}}],
                                                                                                                                                                    "typeName": "hydra.core.Application"}}},
                                                                                                                                                              "typeName": "hydra.core.Term"}},
                                                                                                                                                          "domain": null,
                                                                                                                                                          "parameter": "v"}}},
                                                                                                                                                    "domain": null,
                                                                                                                                                    "parameter": "t"}}},
                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                                                                                                                  "type": null}],
                                                                                                                              "body": {
                                                                                                                                "let": {
                                                                                                                                  "bindings": [
                                                                                                                                    {
                                                                                                                                      "name": "newBindingAndReplacement",
                                                                                                                                      "term": {
                                                                                                                                        "pair": {
                                                                                                                                          "@first": {
                                                                                                                                            "record": {
                                                                                                                                              "fields": [
                                                                                                                                                {"name": "name", "term": {"variable": "globalBindingName"}},
                                                                                                                                                {"name": "term", "term": {"variable": "termWithTypeLambdas"}},
                                                                                                                                                {"name": "type", "term": {"variable": "newTypeScheme"}}],
                                                                                                                                              "typeName": "hydra.core.Binding"}},
                                                                                                                                          "@second": {"variable": "replacement"}}},
                                                                                                                                      "type": null}],
                                                                                                                                  "body": {
                                                                                                                                    "let": {
                                                                                                                                      "bindings": [
                                                                                                                                        {
                                                                                                                                          "name": "newPairs",
                                                                                                                                          "term": {
                                                                                                                                            "application": {
                                                                                                                                              "argument": {"variable": "bindingAndReplacementPairs"},
                                                                                                                                              "function": {
                                                                                                                                                "application": {
                                                                                                                                                  "argument": {"variable": "newBindingAndReplacement"},
                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.cons"}}}}}},
                                                                                                                                          "type": null}],
                                                                                                                                      "body": {
                                                                                                                                        "pair": {
                                                                                                                                          "@first": {"variable": "newPairs"},
                                                                                                                                          "@second": {"variable": "newUsedNames"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},
                                                                  "domain": null,
                                                                  "parameter": "bindingWithCapturedVars"}}},
                                                            "domain": null,
                                                            "parameter": "pair"}}},
                                                      "domain": null,
                                                      "parameter": "cx"}}},
                                                "domain": null,
                                                "parameter": "prefix"}}},
                                          "type": null}],
                                      "body": {
                                        "let": {
                                          "bindings": [
                                            {
                                              "name": "rewrite",
                                              "term": {
                                                "function": {
                                                  "lambda": {
                                                    "body": {
                                                      "function": {
                                                        "lambda": {
                                                          "body": {
                                                            "function": {
                                                              "lambda": {
                                                                "body": {
                                                                  "function": {
                                                                    "lambda": {
                                                                      "body": {
                                                                        "function": {
                                                                          "lambda": {
                                                                            "body": {
                                                                              "let": {
                                                                                "bindings": [
                                                                                  {
                                                                                    "name": "previouslyFinishedBindings",
                                                                                    "term": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "bindingsAndNames"},
                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                    "type": null}],
                                                                                "body": {
                                                                                  "let": {
                                                                                    "bindings": [
                                                                                      {
                                                                                        "name": "emptyBindingsAndNames",
                                                                                        "term": {
                                                                                          "pair": {
                                                                                            "@first": {"list": []},
                                                                                            "@second": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "bindingsAndNames"},
                                                                                                "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}},
                                                                                        "type": null}],
                                                                                    "body": {
                                                                                      "let": {
                                                                                        "bindings": [
                                                                                          {
                                                                                            "name": "result",
                                                                                            "term": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "term"},
                                                                                                "function": {
                                                                                                  "application": {
                                                                                                    "argument": {"variable": "emptyBindingsAndNames"},
                                                                                                    "function": {"variable": "recurse"}}}}},
                                                                                            "type": null}],
                                                                                        "body": {
                                                                                          "let": {
                                                                                            "bindings": [
                                                                                              {
                                                                                                "name": "newBindingsAndNames",
                                                                                                "term": {
                                                                                                  "application": {
                                                                                                    "argument": {"variable": "result"},
                                                                                                    "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                "type": null}],
                                                                                            "body": {
                                                                                              "let": {
                                                                                                "bindings": [
                                                                                                  {
                                                                                                    "name": "bindingsSoFar",
                                                                                                    "term": {
                                                                                                      "application": {
                                                                                                        "argument": {"variable": "newBindingsAndNames"},
                                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                    "type": null}],
                                                                                                "body": {
                                                                                                  "let": {
                                                                                                    "bindings": [
                                                                                                      {
                                                                                                        "name": "alreadyUsedNames",
                                                                                                        "term": {
                                                                                                          "application": {
                                                                                                            "argument": {"variable": "newBindingsAndNames"},
                                                                                                            "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                        "type": null}],
                                                                                                    "body": {
                                                                                                      "let": {
                                                                                                        "bindings": [
                                                                                                          {
                                                                                                            "name": "newTerm",
                                                                                                            "term": {
                                                                                                              "application": {
                                                                                                                "argument": {"variable": "result"},
                                                                                                                "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                            "type": null}],
                                                                                                        "body": {
                                                                                                          "application": {
                                                                                                            "argument": {"variable": "newTerm"},
                                                                                                            "function": {
                                                                                                              "function": {
                                                                                                                "elimination": {
                                                                                                                  "union": {
                                                                                                                    "cases": [
                                                                                                                      {
                                                                                                                        "name": "let",
                                                                                                                        "term": {
                                                                                                                          "function": {
                                                                                                                            "lambda": {
                                                                                                                              "body": {
                                                                                                                                "let": {
                                                                                                                                  "bindings": [
                                                                                                                                    {
                                                                                                                                      "name": "body",
                                                                                                                                      "term": {
                                                                                                                                        "application": {
                                                                                                                                          "argument": {"variable": "l"},
                                                                                                                                          "function": {
                                                                                                                                            "function": {
                                                                                                                                              "elimination": {"record": {"field": "body", "typeName": "hydra.core.Let"}}}}}},
                                                                                                                                      "type": null}],
                                                                                                                                  "body": {
                                                                                                                                    "let": {
                                                                                                                                      "bindings": [
                                                                                                                                        {
                                                                                                                                          "name": "partitionPair",
                                                                                                                                          "term": {
                                                                                                                                            "application": {
                                                                                                                                              "argument": {
                                                                                                                                                "application": {
                                                                                                                                                  "argument": {"variable": "l"},
                                                                                                                                                  "function": {
                                                                                                                                                    "function": {
                                                                                                                                                      "elimination": {"record": {"field": "bindings", "typeName": "hydra.core.Let"}}}}}},
                                                                                                                                              "function": {
                                                                                                                                                "application": {
                                                                                                                                                  "argument": {
                                                                                                                                                    "application": {
                                                                                                                                                      "argument": {"variable": "cx"},
                                                                                                                                                      "function": {"variable": "shouldHoistBinding"}}},
                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.partition"}}}}}},
                                                                                                                                          "type": null}],
                                                                                                                                      "body": {
                                                                                                                                        "let": {
                                                                                                                                          "bindings": [
                                                                                                                                            {
                                                                                                                                              "name": "hoistUs",
                                                                                                                                              "term": {
                                                                                                                                                "application": {
                                                                                                                                                  "argument": {"variable": "partitionPair"},
                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                                                              "type": null}],
                                                                                                                                          "body": {
                                                                                                                                            "let": {
                                                                                                                                              "bindings": [
                                                                                                                                                {
                                                                                                                                                  "name": "keepUs",
                                                                                                                                                  "term": {
                                                                                                                                                    "application": {
                                                                                                                                                      "argument": {"variable": "partitionPair"},
                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                                                                  "type": null}],
                                                                                                                                              "body": {
                                                                                                                                                "let": {
                                                                                                                                                  "bindings": [
                                                                                                                                                    {
                                                                                                                                                      "name": "hoistedBindingNames",
                                                                                                                                                      "term": {
                                                                                                                                                        "application": {
                                                                                                                                                          "argument": {"variable": "hoistUs"},
                                                                                                                                                          "function": {
                                                                                                                                                            "application": {
                                                                                                                                                              "argument": {
                                                                                                                                                                "function": {
                                                                                                                                                                  "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}},
                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                      "type": null}],
                                                                                                                                                  "body": {
                                                                                                                                                    "let": {
                                                                                                                                                      "bindings": [
                                                                                                                                                        {
                                                                                                                                                          "name": "polyLetVariables",
                                                                                                                                                          "term": {
                                                                                                                                                            "application": {
                                                                                                                                                              "argument": {
                                                                                                                                                                "application": {
                                                                                                                                                                  "argument": {
                                                                                                                                                                    "application": {
                                                                                                                                                                      "argument": {
                                                                                                                                                                        "application": {
                                                                                                                                                                          "argument": {"variable": "cx"},
                                                                                                                                                                          "function": {
                                                                                                                                                                            "function": {
                                                                                                                                                                              "elimination": {
                                                                                                                                                                                "record": {"field": "letVariables", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.sets.toList"}}}},
                                                                                                                                                                  "function": {
                                                                                                                                                                    "application": {
                                                                                                                                                                      "argument": {
                                                                                                                                                                        "function": {
                                                                                                                                                                          "lambda": {
                                                                                                                                                                            "body": {
                                                                                                                                                                              "application": {
                                                                                                                                                                                "argument": {
                                                                                                                                                                                  "application": {
                                                                                                                                                                                    "argument": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {"variable": "cx"},
                                                                                                                                                                                        "function": {
                                                                                                                                                                                          "function": {
                                                                                                                                                                                            "elimination": {"record": {"field": "types", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                                                                                                                                    "function": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {"variable": "v"},
                                                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.maps.lookup"}}}}}},
                                                                                                                                                                                "function": {
                                                                                                                                                                                  "application": {
                                                                                                                                                                                    "argument": {"variable": "hydra.schemas.fTypeIsPolymorphic"},
                                                                                                                                                                                    "function": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {"literal": {"boolean": false}},
                                                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.maybes.maybe"}}}}}}}},
                                                                                                                                                                            "domain": null,
                                                                                                                                                                            "parameter": "v"}}},
                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.filter"}}}}}},
                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.sets.fromList"}}}},
                                                                                                                                                          "type": null}],
                                                                                                                                                      "body": {
                                                                                                                                                        "let": {
                                                                                                                                                          "bindings": [
                                                                                                                                                            {
                                                                                                                                                              "name": "boundTermVariables",
                                                                                                                                                              "term": {
                                                                                                                                                                "application": {
                                                                                                                                                                  "argument": {
                                                                                                                                                                    "application": {
                                                                                                                                                                      "argument": {"variable": "cx"},
                                                                                                                                                                      "function": {
                                                                                                                                                                        "function": {
                                                                                                                                                                          "elimination": {
                                                                                                                                                                            "record": {"field": "letVariables", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                                                                                                                  "function": {
                                                                                                                                                                    "application": {
                                                                                                                                                                      "argument": {
                                                                                                                                                                        "application": {
                                                                                                                                                                          "argument": {"variable": "cx"},
                                                                                                                                                                          "function": {
                                                                                                                                                                            "function": {
                                                                                                                                                                              "elimination": {
                                                                                                                                                                                "record": {"field": "lambdaVariables", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.sets.union"}}}}}},
                                                                                                                                                              "type": null}],
                                                                                                                                                          "body": {
                                                                                                                                                            "let": {
                                                                                                                                                              "bindings": [
                                                                                                                                                                {
                                                                                                                                                                  "name": "freeVariablesInEachBinding",
                                                                                                                                                                  "term": {
                                                                                                                                                                    "application": {
                                                                                                                                                                      "argument": {"variable": "hoistUs"},
                                                                                                                                                                      "function": {
                                                                                                                                                                        "application": {
                                                                                                                                                                          "argument": {
                                                                                                                                                                            "function": {
                                                                                                                                                                              "lambda": {
                                                                                                                                                                                "body": {
                                                                                                                                                                                  "application": {
                                                                                                                                                                                    "argument": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {
                                                                                                                                                                                          "application": {
                                                                                                                                                                                            "argument": {
                                                                                                                                                                                              "application": {
                                                                                                                                                                                                "argument": {"variable": "b"},
                                                                                                                                                                                                "function": {
                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                    "elimination": {"record": {"field": "term", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                                                                                                            "function": {"variable": "hydra.rewriting.freeVariablesInTerm"}}},
                                                                                                                                                                                        "function": {
                                                                                                                                                                                          "application": {
                                                                                                                                                                                            "argument": {"variable": "boundTermVariables"},
                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.sets.intersection"}}}}}},
                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.sets.toList"}}}},
                                                                                                                                                                                "domain": null,
                                                                                                                                                                                "parameter": "b"}}},
                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                  "type": null}],
                                                                                                                                                              "body": {
                                                                                                                                                                "let": {
                                                                                                                                                                  "bindings": [
                                                                                                                                                                    {
                                                                                                                                                                      "name": "bindingDependencies",
                                                                                                                                                                      "term": {
                                                                                                                                                                        "application": {
                                                                                                                                                                          "argument": {"variable": "freeVariablesInEachBinding"},
                                                                                                                                                                          "function": {
                                                                                                                                                                            "application": {
                                                                                                                                                                              "argument": {
                                                                                                                                                                                "function": {
                                                                                                                                                                                  "lambda": {
                                                                                                                                                                                    "body": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {"variable": "vars"},
                                                                                                                                                                                        "function": {
                                                                                                                                                                                          "application": {
                                                                                                                                                                                            "argument": {
                                                                                                                                                                                              "function": {
                                                                                                                                                                                                "lambda": {
                                                                                                                                                                                                  "body": {
                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                          "argument": {"variable": "hoistedBindingNames"},
                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.sets.fromList"}}}},
                                                                                                                                                                                                      "function": {
                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                          "argument": {"variable": "v"},
                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.sets.member"}}}}}},
                                                                                                                                                                                                  "domain": null,
                                                                                                                                                                                                  "parameter": "v"}}},
                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.lists.partition"}}}}}},
                                                                                                                                                                                    "domain": null,
                                                                                                                                                                                    "parameter": "vars"}}},
                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                      "type": null}],
                                                                                                                                                                  "body": {
                                                                                                                                                                    "let": {
                                                                                                                                                                      "bindings": [
                                                                                                                                                                        {
                                                                                                                                                                          "name": "bindingEdges",
                                                                                                                                                                          "term": {
                                                                                                                                                                            "application": {
                                                                                                                                                                              "argument": {
                                                                                                                                                                                "application": {
                                                                                                                                                                                  "argument": {"variable": "bindingDependencies"},
                                                                                                                                                                                  "function": {
                                                                                                                                                                                    "application": {
                                                                                                                                                                                      "argument": {"function": {"primitive": "hydra.lib.pairs.first"}},
                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                              "function": {
                                                                                                                                                                                "application": {
                                                                                                                                                                                  "argument": {"variable": "hoistedBindingNames"},
                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.zip"}}}}}},
                                                                                                                                                                          "type": null}],
                                                                                                                                                                      "body": {
                                                                                                                                                                        "let": {
                                                                                                                                                                          "bindings": [
                                                                                                                                                                            {
                                                                                                                                                                              "name": "bindingImmediateCapturedVars",
                                                                                                                                                                              "term": {
                                                                                                                                                                                "application": {
                                                                                                                                                                                  "argument": {
                                                                                                                                                                                    "application": {
                                                                                                                                                                                      "argument": {"variable": "bindingDependencies"},
                                                                                                                                                                                      "function": {
                                                                                                                                                                                        "application": {
                                                                                                                                                                                          "argument": {"function": {"primitive": "hydra.lib.pairs.second"}},
                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                  "function": {
                                                                                                                                                                                    "application": {
                                                                                                                                                                                      "argument": {"variable": "hoistedBindingNames"},
                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.zip"}}}}}},
                                                                                                                                                                              "type": null}],
                                                                                                                                                                          "body": {
                                                                                                                                                                            "let": {
                                                                                                                                                                              "bindings": [
                                                                                                                                                                                {
                                                                                                                                                                                  "name": "capturedVarsMap",
                                                                                                                                                                                  "term": {
                                                                                                                                                                                    "application": {
                                                                                                                                                                                      "argument": {
                                                                                                                                                                                        "application": {
                                                                                                                                                                                          "argument": {"variable": "bindingImmediateCapturedVars"},
                                                                                                                                                                                          "function": {
                                                                                                                                                                                            "application": {
                                                                                                                                                                                              "argument": {"variable": "bindingEdges"},
                                                                                                                                                                                              "function": {"variable": "hydra.sorting.propagateTags"}}}}},
                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.maps.fromList"}}}},
                                                                                                                                                                                  "type": null}],
                                                                                                                                                                              "body": {
                                                                                                                                                                                "let": {
                                                                                                                                                                                  "bindings": [
                                                                                                                                                                                    {
                                                                                                                                                                                      "name": "bindingsWithCapturedVars",
                                                                                                                                                                                      "term": {
                                                                                                                                                                                        "application": {
                                                                                                                                                                                          "argument": {"variable": "hoistUs"},
                                                                                                                                                                                          "function": {
                                                                                                                                                                                            "application": {
                                                                                                                                                                                              "argument": {
                                                                                                                                                                                                "function": {
                                                                                                                                                                                                  "lambda": {
                                                                                                                                                                                                    "body": {
                                                                                                                                                                                                      "pair": {
                                                                                                                                                                                                        "@first": {"variable": "b"},
                                                                                                                                                                                                        "@second": {
                                                                                                                                                                                                          "application": {
                                                                                                                                                                                                            "argument": {
                                                                                                                                                                                                              "application": {
                                                                                                                                                                                                                "argument": {"variable": "capturedVarsMap"},
                                                                                                                                                                                                                "function": {
                                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                                    "argument": {
                                                                                                                                                                                                                      "application": {
                                                                                                                                                                                                                        "argument": {"variable": "b"},
                                                                                                                                                                                                                        "function": {
                                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                                            "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.maps.lookup"}}}}}},
                                                                                                                                                                                                            "function": {
                                                                                                                                                                                                              "application": {
                                                                                                                                                                                                                "argument": {
                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                    "lambda": {
                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                          "argument": {
                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                              "argument": {"variable": "polyLetVariables"},
                                                                                                                                                                                                                              "function": {
                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                  "argument": {"variable": "vars"},
                                                                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.sets.difference"}}}}}},
                                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.sets.toList"}}}},
                                                                                                                                                                                                                      "domain": null,
                                                                                                                                                                                                                      "parameter": "vars"}}},
                                                                                                                                                                                                                "function": {
                                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                                    "argument": {"list": []},
                                                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.maybes.maybe"}}}}}}}}}},
                                                                                                                                                                                                    "domain": null,
                                                                                                                                                                                                    "parameter": "b"}}},
                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                      "type": null}],
                                                                                                                                                                                  "body": {
                                                                                                                                                                                    "let": {
                                                                                                                                                                                      "bindings": [
                                                                                                                                                                                        {
                                                                                                                                                                                          "name": "hoistPairsAndNames",
                                                                                                                                                                                          "term": {
                                                                                                                                                                                            "application": {
                                                                                                                                                                                              "argument": {"variable": "bindingsWithCapturedVars"},
                                                                                                                                                                                              "function": {
                                                                                                                                                                                                "application": {
                                                                                                                                                                                                  "argument": {
                                                                                                                                                                                                    "pair": {"@first": {"list": []}, "@second": {"variable": "alreadyUsedNames"}}},
                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                          "argument": {"variable": "cx"},
                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                              "argument": {"variable": "prefix"},
                                                                                                                                                                                                              "function": {"variable": "hoistOne"}}}}},
                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                                                                                                                                                                          "type": null}],
                                                                                                                                                                                      "body": {
                                                                                                                                                                                        "let": {
                                                                                                                                                                                          "bindings": [
                                                                                                                                                                                            {
                                                                                                                                                                                              "name": "hoistPairs",
                                                                                                                                                                                              "term": {
                                                                                                                                                                                                "application": {
                                                                                                                                                                                                  "argument": {
                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                      "argument": {"variable": "hoistPairsAndNames"},
                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                                                                                                                                              "type": null}],
                                                                                                                                                                                          "body": {
                                                                                                                                                                                            "let": {
                                                                                                                                                                                              "bindings": [
                                                                                                                                                                                                {
                                                                                                                                                                                                  "name": "hoistedBindings",
                                                                                                                                                                                                  "term": {
                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                      "argument": {"variable": "hoistPairs"},
                                                                                                                                                                                                      "function": {
                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                          "argument": {"function": {"primitive": "hydra.lib.pairs.first"}},
                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                  "type": null}],
                                                                                                                                                                                              "body": {
                                                                                                                                                                                                "let": {
                                                                                                                                                                                                  "bindings": [
                                                                                                                                                                                                    {
                                                                                                                                                                                                      "name": "replacements",
                                                                                                                                                                                                      "term": {
                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                          "argument": {"variable": "hoistPairs"},
                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                              "argument": {"function": {"primitive": "hydra.lib.pairs.second"}},
                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                      "type": null}],
                                                                                                                                                                                                  "body": {
                                                                                                                                                                                                    "let": {
                                                                                                                                                                                                      "bindings": [
                                                                                                                                                                                                        {
                                                                                                                                                                                                          "name": "finalUsedNames",
                                                                                                                                                                                                          "term": {
                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                              "argument": {"variable": "hoistPairsAndNames"},
                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                                                                                                                          "type": null}],
                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                        "let": {
                                                                                                                                                                                                          "bindings": [
                                                                                                                                                                                                            {
                                                                                                                                                                                                              "name": "hoistNameReplacementPairs",
                                                                                                                                                                                                              "term": {
                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                  "argument": {"variable": "replacements"},
                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                          "argument": {"variable": "hoistUs"},
                                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                              "argument": {
                                                                                                                                                                                                                                "function": {
                                                                                                                                                                                                                                  "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}},
                                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.zip"}}}}}},
                                                                                                                                                                                                              "type": null}],
                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                            "let": {
                                                                                                                                                                                                              "bindings": [
                                                                                                                                                                                                                {
                                                                                                                                                                                                                  "name": "hoistBindingMap",
                                                                                                                                                                                                                  "term": {
                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                          "argument": {"variable": "hoistUs"},
                                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                              "argument": {
                                                                                                                                                                                                                                "function": {
                                                                                                                                                                                                                                  "lambda": {
                                                                                                                                                                                                                                    "body": {
                                                                                                                                                                                                                                      "pair": {
                                                                                                                                                                                                                                        "@first": {
                                                                                                                                                                                                                                          "application": {
                                                                                                                                                                                                                                            "argument": {"variable": "b"},
                                                                                                                                                                                                                                            "function": {
                                                                                                                                                                                                                                              "function": {
                                                                                                                                                                                                                                                "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                                                                                                                                                        "@second": {"variable": "b"}}},
                                                                                                                                                                                                                                    "domain": null,
                                                                                                                                                                                                                                    "parameter": "b"}}},
                                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.maps.fromList"}}}},
                                                                                                                                                                                                                  "type": null}],
                                                                                                                                                                                                              "body": {
                                                                                                                                                                                                                "let": {
                                                                                                                                                                                                                  "bindings": [
                                                                                                                                                                                                                    {
                                                                                                                                                                                                                      "name": "isCacheable",
                                                                                                                                                                                                                      "term": {
                                                                                                                                                                                                                        "function": {
                                                                                                                                                                                                                          "lambda": {
                                                                                                                                                                                                                            "body": {
                                                                                                                                                                                                                              "let": {
                                                                                                                                                                                                                                "bindings": [
                                                                                                                                                                                                                                  {
                                                                                                                                                                                                                                    "name": "multiRef",
                                                                                                                                                                                                                                    "term": {
                                                                                                                                                                                                                                      "application": {
                                                                                                                                                                                                                                        "argument": {"literal": {"integer": {"int32": 2}}},
                                                                                                                                                                                                                                        "function": {
                                                                                                                                                                                                                                          "application": {
                                                                                                                                                                                                                                            "argument": {
                                                                                                                                                                                                                                              "application": {
                                                                                                                                                                                                                                                "argument": {"variable": "body"},
                                                                                                                                                                                                                                                "function": {
                                                                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                                                                    "argument": {"variable": "name"},
                                                                                                                                                                                                                                                    "function": {"variable": "hydra.hoisting.countVarOccurrences"}}}}},
                                                                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.equality.gte"}}}}}},
                                                                                                                                                                                                                                    "type": null}],
                                                                                                                                                                                                                                "body": {
                                                                                                                                                                                                                                  "let": {
                                                                                                                                                                                                                                    "bindings": [
                                                                                                                                                                                                                                      {
                                                                                                                                                                                                                                        "name": "isPoly",
                                                                                                                                                                                                                                        "term": {
                                                                                                                                                                                                                                          "application": {
                                                                                                                                                                                                                                            "argument": {
                                                                                                                                                                                                                                              "application": {
                                                                                                                                                                                                                                                "argument": {"variable": "hoistBindingMap"},
                                                                                                                                                                                                                                                "function": {
                                                                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                                                                    "argument": {"variable": "name"},
                                                                                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.maps.lookup"}}}}}},
                                                                                                                                                                                                                                            "function": {
                                                                                                                                                                                                                                              "application": {
                                                                                                                                                                                                                                                "argument": {
                                                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                                                    "lambda": {
                                                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                          "argument": {"variable": "b"},
                                                                                                                                                                                                                                                          "function": {"variable": "hydra.hoisting.bindingIsPolymorphic"}}},
                                                                                                                                                                                                                                                      "domain": null,
                                                                                                                                                                                                                                                      "parameter": "b"}}},
                                                                                                                                                                                                                                                "function": {
                                                                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                                                                    "argument": {"literal": {"boolean": false}},
                                                                                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.maybes.maybe"}}}}}}}},
                                                                                                                                                                                                                                        "type": null}],
                                                                                                                                                                                                                                    "body": {
                                                                                                                                                                                                                                      "application": {
                                                                                                                                                                                                                                        "argument": {
                                                                                                                                                                                                                                          "application": {
                                                                                                                                                                                                                                            "argument": {"variable": "isPoly"},
                                                                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.logic.not"}}}},
                                                                                                                                                                                                                                        "function": {
                                                                                                                                                                                                                                          "application": {
                                                                                                                                                                                                                                            "argument": {"variable": "multiRef"},
                                                                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.logic.and"}}}}}}}}}},
                                                                                                                                                                                                                            "domain": null,
                                                                                                                                                                                                                            "parameter": "name"}}},
                                                                                                                                                                                                                      "type": null}],
                                                                                                                                                                                                                  "body": {
                                                                                                                                                                                                                    "let": {
                                                                                                                                                                                                                      "bindings": [
                                                                                                                                                                                                                        {
                                                                                                                                                                                                                          "name": "singleRefPairs",
                                                                                                                                                                                                                          "term": {
                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                              "argument": {"variable": "hoistNameReplacementPairs"},
                                                                                                                                                                                                                              "function": {
                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                  "argument": {
                                                                                                                                                                                                                                    "function": {
                                                                                                                                                                                                                                      "lambda": {
                                                                                                                                                                                                                                        "body": {
                                                                                                                                                                                                                                          "application": {
                                                                                                                                                                                                                                            "argument": {
                                                                                                                                                                                                                                              "application": {
                                                                                                                                                                                                                                                "argument": {
                                                                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                                                                    "argument": {"variable": "p"},
                                                                                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                                                                                                                                                                "function": {"variable": "isCacheable"}}},
                                                                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.logic.not"}}}},
                                                                                                                                                                                                                                        "domain": null,
                                                                                                                                                                                                                                        "parameter": "p"}}},
                                                                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.filter"}}}}}},
                                                                                                                                                                                                                          "type": null}],
                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                        "let": {
                                                                                                                                                                                                                          "bindings": [
                                                                                                                                                                                                                            {
                                                                                                                                                                                                                              "name": "multiRefPairs",
                                                                                                                                                                                                                              "term": {
                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                  "argument": {"variable": "hoistNameReplacementPairs"},
                                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                                        "function": {
                                                                                                                                                                                                                                          "lambda": {
                                                                                                                                                                                                                                            "body": {
                                                                                                                                                                                                                                              "application": {
                                                                                                                                                                                                                                                "argument": {
                                                                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                                                                    "argument": {"variable": "p"},
                                                                                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                                                                                                                                                                "function": {"variable": "isCacheable"}}},
                                                                                                                                                                                                                                            "domain": null,
                                                                                                                                                                                                                                            "parameter": "p"}}},
                                                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.filter"}}}}}},
                                                                                                                                                                                                                              "type": null}],
                                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                                            "let": {
                                                                                                                                                                                                                              "bindings": [
                                                                                                                                                                                                                                {
                                                                                                                                                                                                                                  "name": "fullSubst",
                                                                                                                                                                                                                                  "term": {
                                                                                                                                                                                                                                    "wrap": {
                                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                          "argument": {"variable": "hoistNameReplacementPairs"},
                                                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.maps.fromList"}}}},
                                                                                                                                                                                                                                      "typeName": "hydra.typing.TermSubst"}},
                                                                                                                                                                                                                                  "type": null}],
                                                                                                                                                                                                                              "body": {
                                                                                                                                                                                                                                "let": {
                                                                                                                                                                                                                                  "bindings": [
                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                      "name": "bodyOnlySubst",
                                                                                                                                                                                                                                      "term": {
                                                                                                                                                                                                                                        "wrap": {
                                                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                              "argument": {"variable": "singleRefPairs"},
                                                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.maps.fromList"}}}},
                                                                                                                                                                                                                                          "typeName": "hydra.typing.TermSubst"}},
                                                                                                                                                                                                                                      "type": null}],
                                                                                                                                                                                                                                  "body": {
                                                                                                                                                                                                                                    "let": {
                                                                                                                                                                                                                                      "bindings": [
                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                          "name": "bodySubst",
                                                                                                                                                                                                                                          "term": {
                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                              "argument": {"variable": "body"},
                                                                                                                                                                                                                                              "function": {
                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                  "argument": {"variable": "bodyOnlySubst"},
                                                                                                                                                                                                                                                  "function": {"variable": "hydra.substitution.substituteInTerm"}}}}},
                                                                                                                                                                                                                                          "type": null}],
                                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                                        "let": {
                                                                                                                                                                                                                                          "bindings": [
                                                                                                                                                                                                                                            {
                                                                                                                                                                                                                                              "name": "cacheBindings",
                                                                                                                                                                                                                                              "term": {
                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                  "argument": {"variable": "multiRefPairs"},
                                                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                                                        "function": {
                                                                                                                                                                                                                                                          "lambda": {
                                                                                                                                                                                                                                                            "body": {
                                                                                                                                                                                                                                                              "record": {
                                                                                                                                                                                                                                                                "fields": [
                                                                                                                                                                                                                                                                  {
                                                                                                                                                                                                                                                                    "name": "name",
                                                                                                                                                                                                                                                                    "term": {
                                                                                                                                                                                                                                                                      "application": {
                                                                                                                                                                                                                                                                        "argument": {"variable": "p"},
                                                                                                                                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}}},
                                                                                                                                                                                                                                                                  {
                                                                                                                                                                                                                                                                    "name": "term",
                                                                                                                                                                                                                                                                    "term": {
                                                                                                                                                                                                                                                                      "application": {
                                                                                                                                                                                                                                                                        "argument": {"variable": "p"},
                                                                                                                                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}},
                                                                                                                                                                                                                                                                  {"name": "type", "term": {"maybe": null}}],
                                                                                                                                                                                                                                                                "typeName": "hydra.core.Binding"}},
                                                                                                                                                                                                                                                            "domain": null,
                                                                                                                                                                                                                                                            "parameter": "p"}}},
                                                                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                                              "type": null}],
                                                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                                                            "let": {
                                                                                                                                                                                                                                              "bindings": [
                                                                                                                                                                                                                                                {
                                                                                                                                                                                                                                                  "name": "bodyWithCache",
                                                                                                                                                                                                                                                  "term": {
                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                                                        "union": {
                                                                                                                                                                                                                                                          "field": {
                                                                                                                                                                                                                                                            "name": "let",
                                                                                                                                                                                                                                                            "term": {
                                                                                                                                                                                                                                                              "record": {
                                                                                                                                                                                                                                                                "fields": [
                                                                                                                                                                                                                                                                  {"name": "bindings", "term": {"variable": "cacheBindings"}},
                                                                                                                                                                                                                                                                  {"name": "body", "term": {"variable": "bodySubst"}}],
                                                                                                                                                                                                                                                                "typeName": "hydra.core.Let"}}},
                                                                                                                                                                                                                                                          "typeName": "hydra.core.Term"}},
                                                                                                                                                                                                                                                      "function": {
                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                          "argument": {"variable": "bodySubst"},
                                                                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                              "argument": {
                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                  "argument": {"variable": "cacheBindings"},
                                                                                                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.null"}}}},
                                                                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                                                                                                                                                                                                                  "type": null}],
                                                                                                                                                                                                                                              "body": {
                                                                                                                                                                                                                                                "let": {
                                                                                                                                                                                                                                                  "bindings": [
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                      "name": "keepUsSubst",
                                                                                                                                                                                                                                                      "term": {
                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                          "argument": {"variable": "keepUs"},
                                                                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                              "argument": {
                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                  "argument": {"variable": "fullSubst"},
                                                                                                                                                                                                                                                                  "function": {"variable": "hydra.substitution.substituteInBinding"}}},
                                                                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                                                      "type": null}],
                                                                                                                                                                                                                                                  "body": {
                                                                                                                                                                                                                                                    "let": {
                                                                                                                                                                                                                                                      "bindings": [
                                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                          "name": "hoistedBindingsSubst",
                                                                                                                                                                                                                                                          "term": {
                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                              "argument": {"variable": "hoistedBindings"},
                                                                                                                                                                                                                                                              "function": {
                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                  "argument": {
                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                      "argument": {"variable": "fullSubst"},
                                                                                                                                                                                                                                                                      "function": {"variable": "hydra.substitution.substituteInBinding"}}},
                                                                                                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                                                          "type": null}],
                                                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                                                        "let": {
                                                                                                                                                                                                                                                          "bindings": [
                                                                                                                                                                                                                                                            {
                                                                                                                                                                                                                                                              "name": "bindingsSoFarSubst",
                                                                                                                                                                                                                                                              "term": {
                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                  "argument": {"variable": "bindingsSoFar"},
                                                                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                                          "argument": {"variable": "fullSubst"},
                                                                                                                                                                                                                                                                          "function": {"variable": "hydra.substitution.substituteInBinding"}}},
                                                                                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                                                              "type": null}],
                                                                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                                                                            "let": {
                                                                                                                                                                                                                                                              "bindings": [
                                                                                                                                                                                                                                                                {
                                                                                                                                                                                                                                                                  "name": "augmentResult",
                                                                                                                                                                                                                                                                  "term": {
                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                      "argument": {"variable": "bindingsSoFarSubst"},
                                                                                                                                                                                                                                                                      "function": {
                                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                                          "argument": {
                                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                                              "argument": {"variable": "polyLetVariables"},
                                                                                                                                                                                                                                                                              "function": {
                                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                                  "argument": {"variable": "boundTermVariables"},
                                                                                                                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.sets.difference"}}}}}},
                                                                                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                                              "argument": {"variable": "cx"},
                                                                                                                                                                                                                                                                              "function": {"variable": "hydra.hoisting.augmentBindingsWithNewFreeVars"}}}}}}},
                                                                                                                                                                                                                                                                  "type": null}],
                                                                                                                                                                                                                                                              "body": {
                                                                                                                                                                                                                                                                "let": {
                                                                                                                                                                                                                                                                  "bindings": [
                                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                                      "name": "bindingsSoFarAugmented",
                                                                                                                                                                                                                                                                      "term": {
                                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                                          "argument": {"variable": "augmentResult"},
                                                                                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                                                                                                                                                                                      "type": null}],
                                                                                                                                                                                                                                                                  "body": {
                                                                                                                                                                                                                                                                    "let": {
                                                                                                                                                                                                                                                                      "bindings": [
                                                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                                          "name": "augmentSubst",
                                                                                                                                                                                                                                                                          "term": {
                                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                                              "argument": {"variable": "augmentResult"},
                                                                                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                                                                                                                                                                                          "type": null}],
                                                                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                                                                        "let": {
                                                                                                                                                                                                                                                                          "bindings": [
                                                                                                                                                                                                                                                                            {
                                                                                                                                                                                                                                                                              "name": "hoistedBindingsFinal",
                                                                                                                                                                                                                                                                              "term": {
                                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                                  "argument": {"variable": "hoistedBindingsSubst"},
                                                                                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                                                          "argument": {"variable": "augmentSubst"},
                                                                                                                                                                                                                                                                                          "function": {"variable": "hydra.substitution.substituteInBinding"}}},
                                                                                                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                                                                              "type": null}],
                                                                                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                                                                                            "let": {
                                                                                                                                                                                                                                                                              "bindings": [
                                                                                                                                                                                                                                                                                {
                                                                                                                                                                                                                                                                                  "name": "bindingsSoFarFinal",
                                                                                                                                                                                                                                                                                  "term": {
                                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                                      "argument": {"variable": "bindingsSoFarAugmented"},
                                                                                                                                                                                                                                                                                      "function": {
                                                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                                                          "argument": {
                                                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                                                              "argument": {"variable": "augmentSubst"},
                                                                                                                                                                                                                                                                                              "function": {"variable": "hydra.substitution.substituteInBinding"}}},
                                                                                                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                                                                                  "type": null}],
                                                                                                                                                                                                                                                                              "body": {
                                                                                                                                                                                                                                                                                "let": {
                                                                                                                                                                                                                                                                                  "bindings": [
                                                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                                                      "name": "bodyFinal",
                                                                                                                                                                                                                                                                                      "term": {
                                                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                                                          "argument": {"variable": "bodyWithCache"},
                                                                                                                                                                                                                                                                                          "function": {
                                                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                                                              "argument": {"variable": "augmentSubst"},
                                                                                                                                                                                                                                                                                              "function": {"variable": "hydra.substitution.substituteInTerm"}}}}},
                                                                                                                                                                                                                                                                                      "type": null}],
                                                                                                                                                                                                                                                                                  "body": {
                                                                                                                                                                                                                                                                                    "let": {
                                                                                                                                                                                                                                                                                      "bindings": [
                                                                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                                                          "name": "keepUsFinal",
                                                                                                                                                                                                                                                                                          "term": {
                                                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                                                              "argument": {"variable": "keepUsSubst"},
                                                                                                                                                                                                                                                                                              "function": {
                                                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                                                  "argument": {
                                                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                                                      "argument": {"variable": "augmentSubst"},
                                                                                                                                                                                                                                                                                                      "function": {"variable": "hydra.substitution.substituteInBinding"}}},
                                                                                                                                                                                                                                                                                                  "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                                                                                                                                                                                                                                          "type": null}],
                                                                                                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                                                                                                        "let": {
                                                                                                                                                                                                                                                                                          "bindings": [
                                                                                                                                                                                                                                                                                            {
                                                                                                                                                                                                                                                                                              "name": "finalTerm",
                                                                                                                                                                                                                                                                                              "term": {
                                                                                                                                                                                                                                                                                                "application": {
                                                                                                                                                                                                                                                                                                  "argument": {
                                                                                                                                                                                                                                                                                                    "union": {
                                                                                                                                                                                                                                                                                                      "field": {
                                                                                                                                                                                                                                                                                                        "name": "let",
                                                                                                                                                                                                                                                                                                        "term": {
                                                                                                                                                                                                                                                                                                          "record": {
                                                                                                                                                                                                                                                                                                            "fields": [
                                                                                                                                                                                                                                                                                                              {"name": "bindings", "term": {"variable": "keepUsFinal"}},
                                                                                                                                                                                                                                                                                                              {"name": "body", "term": {"variable": "bodyFinal"}}],
                                                                                                                                                                                                                                                                                                            "typeName": "hydra.core.Let"}}},
                                                                                                                                                                                                                                                                                                      "typeName": "hydra.core.Term"}},
                                                                                                                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                                                      "argument": {"variable": "bodyFinal"},
                                                                                                                                                                                                                                                                                                      "function": {
                                                                                                                                                                                                                                                                                                        "application": {
                                                                                                                                                                                                                                                                                                          "argument": {
                                                                                                                                                                                                                                                                                                            "application": {
                                                                                                                                                                                                                                                                                                              "argument": {"variable": "keepUsFinal"},
                                                                                                                                                                                                                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.null"}}}},
                                                                                                                                                                                                                                                                                                          "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                                                                                                                                                                                                                                                              "type": null}],
                                                                                                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                                                                                                            "pair": {
                                                                                                                                                                                                                                                                                              "@first": {
                                                                                                                                                                                                                                                                                                "pair": {
                                                                                                                                                                                                                                                                                                  "@first": {
                                                                                                                                                                                                                                                                                                    "application": {
                                                                                                                                                                                                                                                                                                      "argument": {
                                                                                                                                                                                                                                                                                                        "list": [
                                                                                                                                                                                                                                                                                                          {"variable": "previouslyFinishedBindings"},
                                                                                                                                                                                                                                                                                                          {"variable": "hoistedBindingsFinal"},
                                                                                                                                                                                                                                                                                                          {"variable": "bindingsSoFarFinal"}]},
                                                                                                                                                                                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.concat"}}}},
                                                                                                                                                                                                                                                                                                  "@second": {"variable": "finalUsedNames"}}},
                                                                                                                                                                                                                                                                                              "@second": {"variable": "finalTerm"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},
                                                                                                                              "domain": null,
                                                                                                                              "parameter": "l"}}}}],
                                                                                                                    "default": [
                                                                                                                      {
                                                                                                                        "pair": {
                                                                                                                          "@first": {
                                                                                                                            "pair": {
                                                                                                                              "@first": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {"variable": "bindingsSoFar"},
                                                                                                                                  "function": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {"variable": "previouslyFinishedBindings"},
                                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.concat2"}}}}}},
                                                                                                                              "@second": {"variable": "alreadyUsedNames"}}},
                                                                                                                          "@second": {"variable": "newTerm"}}}],
                                                                                                                    "typeName": "hydra.core.Term"}}}}}}}}}}}}}}}}}}}},
                                                                            "domain": null,
                                                                            "parameter": "term"}}},
                                                                      "domain": null,
                                                                      "parameter": "bindingsAndNames"}}},
                                                                "domain": null,
                                                                "parameter": "cx"}}},
                                                          "domain": null,
                                                          "parameter": "recurse"}}},
                                                    "domain": null,
                                                    "parameter": "prefix"}}},
                                              "type": null}],
                                          "body": {
                                            "let": {
                                              "bindings": [
                                                {
                                                  "name": "cx1",
                                                  "term": {
                                                    "application": {
                                                      "argument": {"variable": "let0"},
                                                      "function": {
                                                        "application": {
                                                          "argument": {"variable": "cx0"},
                                                          "function": {
                                                            "application": {
                                                              "argument": {
                                                                "function": {
                                                                  "lambda": {
                                                                    "body": {
                                                                      "function": {
                                                                        "lambda": {"body": {"maybe": null}, "domain": null, "parameter": "b"}}},
                                                                    "domain": null,
                                                                    "parameter": "c"}}},
                                                              "function": {"variable": "hydra.schemas.extendTypeContextForLet"}}}}}}},
                                                  "type": null}],
                                              "body": {
                                                "let": {
                                                  "bindings": [
                                                    {
                                                      "name": "forActiveBinding",
                                                      "term": {
                                                        "function": {
                                                          "lambda": {
                                                            "body": {
                                                              "let": {
                                                                "bindings": [
                                                                  {
                                                                    "name": "prefix",
                                                                    "term": {
                                                                      "application": {
                                                                        "argument": {"literal": {"string": "_"}},
                                                                        "function": {
                                                                          "application": {
                                                                            "argument": {
                                                                              "application": {
                                                                                "argument": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "b"},
                                                                                    "function": {
                                                                                      "function": {
                                                                                        "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}},
                                                                                "function": {"function": {"elimination": {"wrap": "hydra.core.Name"}}}}},
                                                                            "function": {"function": {"primitive": "hydra.lib.strings.cat2"}}}}}},
                                                                    "type": null}],
                                                                "body": {
                                                                  "let": {
                                                                    "bindings": [
                                                                      {
                                                                        "name": "init",
                                                                        "term": {
                                                                          "pair": {
                                                                            "@first": {"list": []},
                                                                            "@second": {
                                                                              "application": {
                                                                                "argument": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "b"},
                                                                                    "function": {
                                                                                      "function": {
                                                                                        "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}},
                                                                                "function": {"function": {"primitive": "hydra.lib.sets.singleton"}}}}}},
                                                                        "type": null}],
                                                                    "body": {
                                                                      "let": {
                                                                        "bindings": [
                                                                          {
                                                                            "name": "resultPair",
                                                                            "term": {
                                                                              "application": {
                                                                                "argument": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "b"},
                                                                                    "function": {
                                                                                      "function": {
                                                                                        "elimination": {"record": {"field": "term", "typeName": "hydra.core.Binding"}}}}}},
                                                                                "function": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "init"},
                                                                                    "function": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "cx1"},
                                                                                        "function": {
                                                                                          "application": {
                                                                                            "argument": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "prefix"},
                                                                                                "function": {"variable": "rewrite"}}},
                                                                                            "function": {"variable": "hydra.hoisting.rewriteAndFoldTermWithTypeContext"}}}}}}}}},
                                                                            "type": null}],
                                                                        "body": {
                                                                          "let": {
                                                                            "bindings": [
                                                                              {
                                                                                "name": "resultBindings",
                                                                                "term": {
                                                                                  "application": {
                                                                                    "argument": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "resultPair"},
                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                    "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                "type": null}],
                                                                            "body": {
                                                                              "let": {
                                                                                "bindings": [
                                                                                  {
                                                                                    "name": "resultTerm",
                                                                                    "term": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "resultPair"},
                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                    "type": null}],
                                                                                "body": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "resultBindings"},
                                                                                    "function": {
                                                                                      "application": {
                                                                                        "argument": {
                                                                                          "record": {
                                                                                            "fields": [
                                                                                              {
                                                                                                "name": "name",
                                                                                                "term": {
                                                                                                  "application": {
                                                                                                    "argument": {"variable": "b"},
                                                                                                    "function": {
                                                                                                      "function": {
                                                                                                        "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}}},
                                                                                              {"name": "term", "term": {"variable": "resultTerm"}},
                                                                                              {
                                                                                                "name": "type",
                                                                                                "term": {
                                                                                                  "application": {
                                                                                                    "argument": {"variable": "b"},
                                                                                                    "function": {
                                                                                                      "function": {
                                                                                                        "elimination": {"record": {"field": "type", "typeName": "hydra.core.Binding"}}}}}}}],
                                                                                            "typeName": "hydra.core.Binding"}},
                                                                                        "function": {"function": {"primitive": "hydra.lib.lists.cons"}}}}}}}}}}}}}}}},
                                                            "domain": null,
                                                            "parameter": "b"}}},
                                                      "type": null}],
                                                  "body": {
                                                    "let": {
                                                      "bindings": [
                                                        {
                                                          "name": "forBinding",
                                                          "term": {
                                                            "function": {
                                                              "lambda": {
                                                                "body": {
                                                                  "application": {
                                                                    "argument": {"list": [{"variable": "b"}]},
                                                                    "function": {
                                                                      "application": {
                                                                        "argument": {
                                                                          "application": {
                                                                            "argument": {"variable": "b"},
                                                                            "function": {"variable": "forActiveBinding"}}},
                                                                        "function": {
                                                                          "application": {
                                                                            "argument": {
                                                                              "application": {
                                                                                "argument": {"variable": "b"},
                                                                                "function": {"variable": "isParentBinding"}}},
                                                                            "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                                "domain": null,
                                                                "parameter": "b"}}},
                                                          "type": null}],
                                                      "body": {
                                                        "record": {
                                                          "fields": [
                                                            {
                                                              "name": "bindings",
                                                              "term": {
                                                                "application": {
                                                                  "argument": {
                                                                    "application": {
                                                                      "argument": {
                                                                        "application": {
                                                                          "argument": {"variable": "let0"},
                                                                          "function": {
                                                                            "function": {
                                                                              "elimination": {"record": {"field": "bindings", "typeName": "hydra.core.Let"}}}}}},
                                                                      "function": {
                                                                        "application": {
                                                                          "argument": {"variable": "forBinding"},
                                                                          "function": {"function": {"primitive": "hydra.lib.lists.map"}}}}}},
                                                                  "function": {"function": {"primitive": "hydra.lib.lists.concat"}}}}},
                                                            {
                                                              "name": "body",
                                                              "term": {
                                                                "application": {
                                                                  "argument": {"variable": "let0"},
                                                                  "function": {
                                                                    "function": {
                                                                      "elimination": {"record": {"field": "body", "typeName": "hydra.core.Let"}}}}}}}],
                                                          "typeName": "hydra.core.Let"}}}}}}}}}}}},
                                  "domain": null,
                                  "parameter": "let0"}}},
                            "domain": null,
                            "parameter": "cx0"}}},
                      "domain": null,
                      "parameter": "shouldHoistBinding"}}},
                "domain": null,
                "parameter": "isParentBinding"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.hoistPolymorphicLetBindings",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Transform a let-term by pulling all polymorphic let bindings to the top level. This is useful to ensure that polymorphic bindings are not nested within other terms, which is unsupported by certain targets such as Java. Polymorphic bindings are those with a non-empty list of type scheme variables. If a hoisted binding captures lambda-bound variables from an enclosing scope, the binding is wrapped in lambdas for those variables, and references are replaced with applications. Note: Assumes no variable shadowing; use hydra.rewriting.unshadowVariables first."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "let": {
                          "bindings": [
                            {
                              "name": "emptyIx",
                              "term": {
                                "record": {
                                  "fields": [
                                    {
                                      "name": "schemaTypes",
                                      "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                    {
                                      "name": "primitiveTypes",
                                      "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                    {
                                      "name": "dataTypes",
                                      "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                    {
                                      "name": "classConstraints",
                                      "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                    {"name": "debug", "term": {"literal": {"boolean": false}}}],
                                  "typeName": "hydra.typing.InferenceContext"}},
                              "type": null}],
                          "body": {
                            "let": {
                              "bindings": [
                                {
                                  "name": "emptyCx",
                                  "term": {
                                    "record": {
                                      "fields": [
                                        {
                                          "name": "types",
                                          "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                        {
                                          "name": "metadata",
                                          "term": {"function": {"primitive": "hydra.lib.maps.empty"}}},
                                        {
                                          "name": "typeVariables",
                                          "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                        {
                                          "name": "lambdaVariables",
                                          "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                        {
                                          "name": "letVariables",
                                          "term": {"function": {"primitive": "hydra.lib.sets.empty"}}},
                                        {"name": "inferenceContext", "term": {"variable": "emptyIx"}}],
                                      "typeName": "hydra.typing.TypeContext"}},
                                  "type": null}],
                              "body": {
                                "application": {
                                  "argument": {"variable": "let0"},
                                  "function": {
                                    "application": {
                                      "argument": {"variable": "emptyCx"},
                                      "function": {
                                        "application": {
                                          "argument": {"variable": "hydra.hoisting.shouldHoistPolymorphic"},
                                          "function": {
                                            "application": {
                                              "argument": {"variable": "isParentBinding"},
                                              "function": {"variable": "hydra.hoisting.hoistLetBindingsWithPredicate"}}}}}}}}}}}}},
                      "domain": null,
                      "parameter": "let0"}}},
                "domain": null,
                "parameter": "isParentBinding"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.hoistSubterms",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Hoist subterms into local let bindings based on a path-aware predicate. The predicate receives a pair of (path, term) where path is the list of TermAccessors from the root to the current term, and returns True if the term should be hoisted. For each let term found, the immediate subterms (binding values and body) are processed: matching subterms within each immediate subterm are collected and hoisted into a local let that wraps that immediate subterm. If a hoisted term contains free variables that are lambda-bound at an enclosing scope, the hoisted binding is wrapped in lambdas for those variables, and the reference is replaced with an application of those variables."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "function": {
                          "lambda": {
                            "body": {
                              "let": {
                                "bindings": [
                                  {
                                    "name": "processImmediateSubterm",
                                    "term": {
                                      "function": {
                                        "lambda": {
                                          "body": {
                                            "function": {
                                              "lambda": {
                                                "body": {
                                                  "function": {
                                                    "lambda": {
                                                      "body": {
                                                        "function": {
                                                          "lambda": {
                                                            "body": {
                                                              "let": {
                                                                "bindings": [
                                                                  {
                                                                    "name": "baselineLambdaVars",
                                                                    "term": {
                                                                      "application": {
                                                                        "argument": {"variable": "cx"},
                                                                        "function": {
                                                                          "function": {
                                                                            "elimination": {
                                                                              "record": {"field": "lambdaVariables", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                    "type": null}],
                                                                "body": {
                                                                  "let": {
                                                                    "bindings": [
                                                                      {
                                                                        "name": "collectAndReplace",
                                                                        "term": {
                                                                          "function": {
                                                                            "lambda": {
                                                                              "body": {
                                                                                "function": {
                                                                                  "lambda": {
                                                                                    "body": {
                                                                                      "function": {
                                                                                        "lambda": {
                                                                                          "body": {
                                                                                            "function": {
                                                                                              "lambda": {
                                                                                                "body": {
                                                                                                  "function": {
                                                                                                    "lambda": {
                                                                                                      "body": {
                                                                                                        "let": {
                                                                                                          "bindings": [
                                                                                                            {
                                                                                                              "name": "currentCounter",
                                                                                                              "term": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "acc"},
                                                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                              "type": null}],
                                                                                                          "body": {
                                                                                                            "let": {
                                                                                                              "bindings": [
                                                                                                                {
                                                                                                                  "name": "collectedBindings",
                                                                                                                  "term": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "acc"},
                                                                                                                      "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                                  "type": null}],
                                                                                                              "body": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "term"},
                                                                                                                  "function": {
                                                                                                                    "function": {
                                                                                                                      "elimination": {
                                                                                                                        "union": {
                                                                                                                          "cases": [
                                                                                                                            {
                                                                                                                              "name": "let",
                                                                                                                              "term": {
                                                                                                                                "function": {
                                                                                                                                  "lambda": {
                                                                                                                                    "body": {
                                                                                                                                      "pair": {"@first": {"variable": "acc"}, "@second": {"variable": "term"}}},
                                                                                                                                    "domain": null,
                                                                                                                                    "parameter": "_"}}}},
                                                                                                                            {
                                                                                                                              "name": "typeLambda",
                                                                                                                              "term": {
                                                                                                                                "function": {
                                                                                                                                  "lambda": {
                                                                                                                                    "body": {
                                                                                                                                      "pair": {"@first": {"variable": "acc"}, "@second": {"variable": "term"}}},
                                                                                                                                    "domain": null,
                                                                                                                                    "parameter": "_"}}}}],
                                                                                                                          "default": [
                                                                                                                            {
                                                                                                                              "let": {
                                                                                                                                "bindings": [
                                                                                                                                  {
                                                                                                                                    "name": "result",
                                                                                                                                    "term": {
                                                                                                                                      "application": {
                                                                                                                                        "argument": {"variable": "term"},
                                                                                                                                        "function": {
                                                                                                                                          "application": {"argument": {"variable": "acc"}, "function": {"variable": "recurse"}}}}},
                                                                                                                                    "type": null}],
                                                                                                                                "body": {
                                                                                                                                  "let": {
                                                                                                                                    "bindings": [
                                                                                                                                      {
                                                                                                                                        "name": "newAcc",
                                                                                                                                        "term": {
                                                                                                                                          "application": {
                                                                                                                                            "argument": {"variable": "result"},
                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                                                        "type": null}],
                                                                                                                                    "body": {
                                                                                                                                      "let": {
                                                                                                                                        "bindings": [
                                                                                                                                          {
                                                                                                                                            "name": "processedTerm",
                                                                                                                                            "term": {
                                                                                                                                              "application": {
                                                                                                                                                "argument": {"variable": "result"},
                                                                                                                                                "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                                                            "type": null}],
                                                                                                                                        "body": {
                                                                                                                                          "let": {
                                                                                                                                            "bindings": [
                                                                                                                                              {
                                                                                                                                                "name": "newCounter",
                                                                                                                                                "term": {
                                                                                                                                                  "application": {
                                                                                                                                                    "argument": {"variable": "newAcc"},
                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                                                                "type": null}],
                                                                                                                                            "body": {
                                                                                                                                              "let": {
                                                                                                                                                "bindings": [
                                                                                                                                                  {
                                                                                                                                                    "name": "newBindings",
                                                                                                                                                    "term": {
                                                                                                                                                      "application": {
                                                                                                                                                        "argument": {"variable": "newAcc"},
                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                                                                    "type": null}],
                                                                                                                                                "body": {
                                                                                                                                                  "application": {
                                                                                                                                                    "argument": {
                                                                                                                                                      "pair": {
                                                                                                                                                        "@first": {"variable": "newAcc"},
                                                                                                                                                        "@second": {"variable": "processedTerm"}}},
                                                                                                                                                    "function": {
                                                                                                                                                      "application": {
                                                                                                                                                        "argument": {
                                                                                                                                                          "let": {
                                                                                                                                                            "bindings": [
                                                                                                                                                              {
                                                                                                                                                                "name": "bindingName",
                                                                                                                                                                "term": {
                                                                                                                                                                  "wrap": {
                                                                                                                                                                    "body": {
                                                                                                                                                                      "application": {
                                                                                                                                                                        "argument": {
                                                                                                                                                                          "list": [
                                                                                                                                                                            {"literal": {"string": "_hoist_"}},
                                                                                                                                                                            {"variable": "namePrefix"},
                                                                                                                                                                            {"literal": {"string": "_"}},
                                                                                                                                                                            {
                                                                                                                                                                              "application": {
                                                                                                                                                                                "argument": {"variable": "newCounter"},
                                                                                                                                                                                "function": {"function": {"primitive": "hydra.lib.literals.showInt32"}}}}]},
                                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.strings.cat"}}}},
                                                                                                                                                                    "typeName": "hydra.core.Name"}},
                                                                                                                                                                "type": null}],
                                                                                                                                                            "body": {
                                                                                                                                                              "let": {
                                                                                                                                                                "bindings": [
                                                                                                                                                                  {
                                                                                                                                                                    "name": "allLambdaVars",
                                                                                                                                                                    "term": {
                                                                                                                                                                      "application": {
                                                                                                                                                                        "argument": {"variable": "cxInner"},
                                                                                                                                                                        "function": {
                                                                                                                                                                          "function": {
                                                                                                                                                                            "elimination": {
                                                                                                                                                                              "record": {"field": "lambdaVariables", "typeName": "hydra.typing.TypeContext"}}}}}},
                                                                                                                                                                    "type": null}],
                                                                                                                                                                "body": {
                                                                                                                                                                  "let": {
                                                                                                                                                                    "bindings": [
                                                                                                                                                                      {
                                                                                                                                                                        "name": "newLambdaVars",
                                                                                                                                                                        "term": {
                                                                                                                                                                          "application": {
                                                                                                                                                                            "argument": {"variable": "baselineLambdaVars"},
                                                                                                                                                                            "function": {
                                                                                                                                                                              "application": {
                                                                                                                                                                                "argument": {"variable": "allLambdaVars"},
                                                                                                                                                                                "function": {"function": {"primitive": "hydra.lib.sets.difference"}}}}}},
                                                                                                                                                                        "type": null}],
                                                                                                                                                                    "body": {
                                                                                                                                                                      "let": {
                                                                                                                                                                        "bindings": [
                                                                                                                                                                          {
                                                                                                                                                                            "name": "freeVars",
                                                                                                                                                                            "term": {
                                                                                                                                                                              "application": {
                                                                                                                                                                                "argument": {"variable": "processedTerm"},
                                                                                                                                                                                "function": {"variable": "hydra.rewriting.freeVariablesInTerm"}}},
                                                                                                                                                                            "type": null}],
                                                                                                                                                                        "body": {
                                                                                                                                                                          "let": {
                                                                                                                                                                            "bindings": [
                                                                                                                                                                              {
                                                                                                                                                                                "name": "capturedVars",
                                                                                                                                                                                "term": {
                                                                                                                                                                                  "application": {
                                                                                                                                                                                    "argument": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {"variable": "freeVars"},
                                                                                                                                                                                        "function": {
                                                                                                                                                                                          "application": {
                                                                                                                                                                                            "argument": {"variable": "newLambdaVars"},
                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.sets.intersection"}}}}}},
                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.sets.toList"}}}},
                                                                                                                                                                                "type": null}],
                                                                                                                                                                            "body": {
                                                                                                                                                                              "let": {
                                                                                                                                                                                "bindings": [
                                                                                                                                                                                  {
                                                                                                                                                                                    "name": "wrappedTerm",
                                                                                                                                                                                    "term": {
                                                                                                                                                                                      "application": {
                                                                                                                                                                                        "argument": {
                                                                                                                                                                                          "application": {
                                                                                                                                                                                            "argument": {"variable": "capturedVars"},
                                                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                                                                                                                                        "function": {
                                                                                                                                                                                          "application": {
                                                                                                                                                                                            "argument": {"variable": "processedTerm"},
                                                                                                                                                                                            "function": {
                                                                                                                                                                                              "application": {
                                                                                                                                                                                                "argument": {
                                                                                                                                                                                                  "function": {
                                                                                                                                                                                                    "lambda": {
                                                                                                                                                                                                      "body": {
                                                                                                                                                                                                        "function": {
                                                                                                                                                                                                          "lambda": {
                                                                                                                                                                                                            "body": {
                                                                                                                                                                                                              "union": {
                                                                                                                                                                                                                "field": {
                                                                                                                                                                                                                  "name": "function",
                                                                                                                                                                                                                  "term": {
                                                                                                                                                                                                                    "union": {
                                                                                                                                                                                                                      "field": {
                                                                                                                                                                                                                        "name": "lambda",
                                                                                                                                                                                                                        "term": {
                                                                                                                                                                                                                          "record": {
                                                                                                                                                                                                                            "fields": [
                                                                                                                                                                                                                              {"name": "parameter", "term": {"variable": "varName"}},
                                                                                                                                                                                                                              {"name": "domain", "term": {"maybe": null}},
                                                                                                                                                                                                                              {"name": "body", "term": {"variable": "body"}}],
                                                                                                                                                                                                                            "typeName": "hydra.core.Lambda"}}},
                                                                                                                                                                                                                      "typeName": "hydra.core.Function"}}},
                                                                                                                                                                                                                "typeName": "hydra.core.Term"}},
                                                                                                                                                                                                            "domain": null,
                                                                                                                                                                                                            "parameter": "varName"}}},
                                                                                                                                                                                                      "domain": null,
                                                                                                                                                                                                      "parameter": "body"}}},
                                                                                                                                                                                                "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                                                                                                                                                                    "type": null}],
                                                                                                                                                                                "body": {
                                                                                                                                                                                  "let": {
                                                                                                                                                                                    "bindings": [
                                                                                                                                                                                      {
                                                                                                                                                                                        "name": "reference",
                                                                                                                                                                                        "term": {
                                                                                                                                                                                          "application": {
                                                                                                                                                                                            "argument": {"variable": "capturedVars"},
                                                                                                                                                                                            "function": {
                                                                                                                                                                                              "application": {
                                                                                                                                                                                                "argument": {
                                                                                                                                                                                                  "union": {
                                                                                                                                                                                                    "field": {"name": "variable", "term": {"variable": "bindingName"}},
                                                                                                                                                                                                    "typeName": "hydra.core.Term"}},
                                                                                                                                                                                                "function": {
                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                    "argument": {
                                                                                                                                                                                                      "function": {
                                                                                                                                                                                                        "lambda": {
                                                                                                                                                                                                          "body": {
                                                                                                                                                                                                            "function": {
                                                                                                                                                                                                              "lambda": {
                                                                                                                                                                                                                "body": {
                                                                                                                                                                                                                  "union": {
                                                                                                                                                                                                                    "field": {
                                                                                                                                                                                                                      "name": "application",
                                                                                                                                                                                                                      "term": {
                                                                                                                                                                                                                        "record": {
                                                                                                                                                                                                                          "fields": [
                                                                                                                                                                                                                            {"name": "function", "term": {"variable": "fn"}},
                                                                                                                                                                                                                            {
                                                                                                                                                                                                                              "name": "argument",
                                                                                                                                                                                                                              "term": {
                                                                                                                                                                                                                                "union": {
                                                                                                                                                                                                                                  "field": {"name": "variable", "term": {"variable": "varName"}},
                                                                                                                                                                                                                                  "typeName": "hydra.core.Term"}}}],
                                                                                                                                                                                                                          "typeName": "hydra.core.Application"}}},
                                                                                                                                                                                                                    "typeName": "hydra.core.Term"}},
                                                                                                                                                                                                                "domain": null,
                                                                                                                                                                                                                "parameter": "varName"}}},
                                                                                                                                                                                                          "domain": null,
                                                                                                                                                                                                          "parameter": "fn"}}},
                                                                                                                                                                                                    "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                                                                                                                                                                        "type": null}],
                                                                                                                                                                                    "body": {
                                                                                                                                                                                      "let": {
                                                                                                                                                                                        "bindings": [
                                                                                                                                                                                          {
                                                                                                                                                                                            "name": "newBinding",
                                                                                                                                                                                            "term": {
                                                                                                                                                                                              "record": {
                                                                                                                                                                                                "fields": [
                                                                                                                                                                                                  {"name": "name", "term": {"variable": "bindingName"}},
                                                                                                                                                                                                  {"name": "term", "term": {"variable": "wrappedTerm"}},
                                                                                                                                                                                                  {"name": "type", "term": {"maybe": null}}],
                                                                                                                                                                                                "typeName": "hydra.core.Binding"}},
                                                                                                                                                                                            "type": null}],
                                                                                                                                                                                        "body": {
                                                                                                                                                                                          "pair": {
                                                                                                                                                                                            "@first": {
                                                                                                                                                                                              "pair": {
                                                                                                                                                                                                "@first": {
                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                    "argument": {"literal": {"integer": {"int32": 1}}},
                                                                                                                                                                                                    "function": {
                                                                                                                                                                                                      "application": {
                                                                                                                                                                                                        "argument": {"variable": "newCounter"},
                                                                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.math.add"}}}}}},
                                                                                                                                                                                                "@second": {
                                                                                                                                                                                                  "application": {
                                                                                                                                                                                                    "argument": {"variable": "newBindings"},
                                                                                                                                                                                                    "function": {
                                                                                                                                                                                                      "application": {
                                                                                                                                                                                                        "argument": {"variable": "newBinding"},
                                                                                                                                                                                                        "function": {"function": {"primitive": "hydra.lib.lists.cons"}}}}}}}},
                                                                                                                                                                                            "@second": {"variable": "reference"}}}}}}}}}}}}}}}}}}},
                                                                                                                                                        "function": {
                                                                                                                                                          "application": {
                                                                                                                                                            "argument": {
                                                                                                                                                              "application": {
                                                                                                                                                                "argument": {
                                                                                                                                                                  "pair": {
                                                                                                                                                                    "@first": {"variable": "path"},
                                                                                                                                                                    "@second": {"variable": "processedTerm"}}},
                                                                                                                                                                "function": {"variable": "shouldHoist"}}},
                                                                                                                                                            "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}}}}}}}}}}}}],
                                                                                                                          "typeName": "hydra.core.Term"}}}}}}}}}},
                                                                                                      "domain": null,
                                                                                                      "parameter": "term"}}},
                                                                                                "domain": null,
                                                                                                "parameter": "acc"}}},
                                                                                          "domain": null,
                                                                                          "parameter": "cxInner"}}},
                                                                                    "domain": null,
                                                                                    "parameter": "path"}}},
                                                                              "domain": null,
                                                                              "parameter": "recurse"}}},
                                                                        "type": null}],
                                                                    "body": {
                                                                      "let": {
                                                                        "bindings": [
                                                                          {
                                                                            "name": "result",
                                                                            "term": {
                                                                              "application": {
                                                                                "argument": {"variable": "subterm"},
                                                                                "function": {
                                                                                  "application": {
                                                                                    "argument": {"pair": {"@first": {"variable": "counter"}, "@second": {"list": []}}},
                                                                                    "function": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "cx"},
                                                                                        "function": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "collectAndReplace"},
                                                                                            "function": {
                                                                                              "variable": "hydra.hoisting.rewriteAndFoldTermWithTypeContextAndPath"}}}}}}}}},
                                                                            "type": null}],
                                                                        "body": {
                                                                          "let": {
                                                                            "bindings": [
                                                                              {
                                                                                "name": "finalAcc",
                                                                                "term": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "result"},
                                                                                    "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                "type": null}],
                                                                            "body": {
                                                                              "let": {
                                                                                "bindings": [
                                                                                  {
                                                                                    "name": "transformedSubterm",
                                                                                    "term": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "result"},
                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                    "type": null}],
                                                                                "body": {
                                                                                  "let": {
                                                                                    "bindings": [
                                                                                      {
                                                                                        "name": "finalCounter",
                                                                                        "term": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "finalAcc"},
                                                                                            "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                        "type": null}],
                                                                                    "body": {
                                                                                      "let": {
                                                                                        "bindings": [
                                                                                          {
                                                                                            "name": "bindings",
                                                                                            "term": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "finalAcc"},
                                                                                                "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                            "type": null}],
                                                                                        "body": {
                                                                                          "application": {
                                                                                            "argument": {
                                                                                              "let": {
                                                                                                "bindings": [
                                                                                                  {
                                                                                                    "name": "localLet",
                                                                                                    "term": {
                                                                                                      "union": {
                                                                                                        "field": {
                                                                                                          "name": "let",
                                                                                                          "term": {
                                                                                                            "record": {
                                                                                                              "fields": [
                                                                                                                {
                                                                                                                  "name": "bindings",
                                                                                                                  "term": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "bindings"},
                                                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}}},
                                                                                                                {"name": "body", "term": {"variable": "transformedSubterm"}}],
                                                                                                              "typeName": "hydra.core.Let"}}},
                                                                                                        "typeName": "hydra.core.Term"}},
                                                                                                    "type": null}],
                                                                                                "body": {
                                                                                                  "pair": {
                                                                                                    "@first": {"variable": "finalCounter"},
                                                                                                    "@second": {"variable": "localLet"}}}}},
                                                                                            "function": {
                                                                                              "application": {
                                                                                                "argument": {
                                                                                                  "pair": {
                                                                                                    "@first": {"variable": "finalCounter"},
                                                                                                    "@second": {"variable": "transformedSubterm"}}},
                                                                                                "function": {
                                                                                                  "application": {
                                                                                                    "argument": {
                                                                                                      "application": {
                                                                                                        "argument": {"variable": "bindings"},
                                                                                                        "function": {"function": {"primitive": "hydra.lib.lists.null"}}}},
                                                                                                    "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}}}}}}}}}}}}}}}},
                                                            "domain": null,
                                                            "parameter": "subterm"}}},
                                                      "domain": null,
                                                      "parameter": "namePrefix"}}},
                                                "domain": null,
                                                "parameter": "counter"}}},
                                          "domain": null,
                                          "parameter": "cx"}}},
                                    "type": null}],
                                "body": {
                                  "let": {
                                    "bindings": [
                                      {
                                        "name": "processLetTerm",
                                        "term": {
                                          "function": {
                                            "lambda": {
                                              "body": {
                                                "function": {
                                                  "lambda": {
                                                    "body": {
                                                      "function": {
                                                        "lambda": {
                                                          "body": {
                                                            "let": {
                                                              "bindings": [
                                                                {
                                                                  "name": "bindings",
                                                                  "term": {
                                                                    "application": {
                                                                      "argument": {"variable": "lt"},
                                                                      "function": {
                                                                        "function": {
                                                                          "elimination": {"record": {"field": "bindings", "typeName": "hydra.core.Let"}}}}}},
                                                                  "type": null}],
                                                              "body": {
                                                                "let": {
                                                                  "bindings": [
                                                                    {
                                                                      "name": "body",
                                                                      "term": {
                                                                        "application": {
                                                                          "argument": {"variable": "lt"},
                                                                          "function": {
                                                                            "function": {
                                                                              "elimination": {"record": {"field": "body", "typeName": "hydra.core.Let"}}}}}},
                                                                      "type": null}],
                                                                  "body": {
                                                                    "let": {
                                                                      "bindings": [
                                                                        {
                                                                          "name": "processBinding",
                                                                          "term": {
                                                                            "function": {
                                                                              "lambda": {
                                                                                "body": {
                                                                                  "function": {
                                                                                    "lambda": {
                                                                                      "body": {
                                                                                        "let": {
                                                                                          "bindings": [
                                                                                            {
                                                                                              "name": "namePrefix",
                                                                                              "term": {
                                                                                                "application": {
                                                                                                  "argument": {
                                                                                                    "application": {
                                                                                                      "argument": {
                                                                                                        "application": {
                                                                                                          "argument": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "binding"},
                                                                                                              "function": {
                                                                                                                "function": {
                                                                                                                  "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                          "function": {"function": {"elimination": {"wrap": "hydra.core.Name"}}}}},
                                                                                                      "function": {
                                                                                                        "application": {
                                                                                                          "argument": {"literal": {"string": "."}},
                                                                                                          "function": {"function": {"primitive": "hydra.lib.strings.splitOn"}}}}}},
                                                                                                  "function": {
                                                                                                    "application": {
                                                                                                      "argument": {"literal": {"string": "_"}},
                                                                                                      "function": {"function": {"primitive": "hydra.lib.strings.intercalate"}}}}}},
                                                                                              "type": null}],
                                                                                          "body": {
                                                                                            "let": {
                                                                                              "bindings": [
                                                                                                {
                                                                                                  "name": "result",
                                                                                                  "term": {
                                                                                                    "application": {
                                                                                                      "argument": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "binding"},
                                                                                                          "function": {
                                                                                                            "function": {
                                                                                                              "elimination": {"record": {"field": "term", "typeName": "hydra.core.Binding"}}}}}},
                                                                                                      "function": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "namePrefix"},
                                                                                                          "function": {
                                                                                                            "application": {
                                                                                                              "argument": {"literal": {"integer": {"int32": 1}}},
                                                                                                              "function": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "cx"},
                                                                                                                  "function": {"variable": "processImmediateSubterm"}}}}}}}}},
                                                                                                  "type": null}],
                                                                                              "body": {
                                                                                                "let": {
                                                                                                  "bindings": [
                                                                                                    {
                                                                                                      "name": "newValue",
                                                                                                      "term": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "result"},
                                                                                                          "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                      "type": null}],
                                                                                                  "body": {
                                                                                                    "let": {
                                                                                                      "bindings": [
                                                                                                        {
                                                                                                          "name": "newBinding",
                                                                                                          "term": {
                                                                                                            "record": {
                                                                                                              "fields": [
                                                                                                                {
                                                                                                                  "name": "name",
                                                                                                                  "term": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "binding"},
                                                                                                                      "function": {
                                                                                                                        "function": {
                                                                                                                          "elimination": {"record": {"field": "name", "typeName": "hydra.core.Binding"}}}}}}},
                                                                                                                {"name": "term", "term": {"variable": "newValue"}},
                                                                                                                {
                                                                                                                  "name": "type",
                                                                                                                  "term": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "binding"},
                                                                                                                      "function": {
                                                                                                                        "function": {
                                                                                                                          "elimination": {"record": {"field": "type", "typeName": "hydra.core.Binding"}}}}}}}],
                                                                                                              "typeName": "hydra.core.Binding"}},
                                                                                                          "type": null}],
                                                                                                      "body": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "acc"},
                                                                                                          "function": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "newBinding"},
                                                                                                              "function": {"function": {"primitive": "hydra.lib.lists.cons"}}}}}}}}}}}}}},
                                                                                      "domain": null,
                                                                                      "parameter": "binding"}}},
                                                                                "domain": null,
                                                                                "parameter": "acc"}}},
                                                                          "type": null}],
                                                                      "body": {
                                                                        "let": {
                                                                          "bindings": [
                                                                            {
                                                                              "name": "newBindingsReversed",
                                                                              "term": {
                                                                                "application": {
                                                                                  "argument": {"variable": "bindings"},
                                                                                  "function": {
                                                                                    "application": {
                                                                                      "argument": {"list": []},
                                                                                      "function": {
                                                                                        "application": {
                                                                                          "argument": {"variable": "processBinding"},
                                                                                          "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                                                              "type": null}],
                                                                          "body": {
                                                                            "let": {
                                                                              "bindings": [
                                                                                {
                                                                                  "name": "newBindings",
                                                                                  "term": {
                                                                                    "application": {
                                                                                      "argument": {"variable": "newBindingsReversed"},
                                                                                      "function": {"function": {"primitive": "hydra.lib.lists.reverse"}}}},
                                                                                  "type": null}],
                                                                              "body": {
                                                                                "let": {
                                                                                  "bindings": [
                                                                                    {
                                                                                      "name": "bodyResult",
                                                                                      "term": {
                                                                                        "application": {
                                                                                          "argument": {"variable": "body"},
                                                                                          "function": {
                                                                                            "application": {
                                                                                              "argument": {"literal": {"string": "_body"}},
                                                                                              "function": {
                                                                                                "application": {
                                                                                                  "argument": {"literal": {"integer": {"int32": 1}}},
                                                                                                  "function": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "cx"},
                                                                                                      "function": {"variable": "processImmediateSubterm"}}}}}}}}},
                                                                                      "type": null}],
                                                                                  "body": {
                                                                                    "let": {
                                                                                      "bindings": [
                                                                                        {
                                                                                          "name": "newBody",
                                                                                          "term": {
                                                                                            "application": {
                                                                                              "argument": {"variable": "bodyResult"},
                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                          "type": null}],
                                                                                      "body": {
                                                                                        "pair": {
                                                                                          "@first": {"variable": "counter"},
                                                                                          "@second": {
                                                                                            "union": {
                                                                                              "field": {
                                                                                                "name": "let",
                                                                                                "term": {
                                                                                                  "record": {
                                                                                                    "fields": [
                                                                                                      {"name": "bindings", "term": {"variable": "newBindings"}},
                                                                                                      {"name": "body", "term": {"variable": "newBody"}}],
                                                                                                    "typeName": "hydra.core.Let"}}},
                                                                                              "typeName": "hydra.core.Term"}}}}}}}}}}}}}}}}}},
                                                          "domain": null,
                                                          "parameter": "lt"}}},
                                                    "domain": null,
                                                    "parameter": "counter"}}},
                                              "domain": null,
                                              "parameter": "cx"}}},
                                        "type": null}],
                                    "body": {
                                      "let": {
                                        "bindings": [
                                          {
                                            "name": "rewrite",
                                            "term": {
                                              "function": {
                                                "lambda": {
                                                  "body": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "function": {
                                                            "lambda": {
                                                              "body": {
                                                                "function": {
                                                                  "lambda": {
                                                                    "body": {
                                                                      "application": {
                                                                        "argument": {"variable": "term"},
                                                                        "function": {
                                                                          "function": {
                                                                            "elimination": {
                                                                              "union": {
                                                                                "cases": [
                                                                                  {
                                                                                    "name": "let",
                                                                                    "term": {
                                                                                      "function": {
                                                                                        "lambda": {
                                                                                          "body": {
                                                                                            "let": {
                                                                                              "bindings": [
                                                                                                {
                                                                                                  "name": "recursed",
                                                                                                  "term": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "term"},
                                                                                                      "function": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "counter"},
                                                                                                          "function": {"variable": "recurse"}}}}},
                                                                                                  "type": null}],
                                                                                              "body": {
                                                                                                "let": {
                                                                                                  "bindings": [
                                                                                                    {
                                                                                                      "name": "newCounter",
                                                                                                      "term": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "recursed"},
                                                                                                          "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                      "type": null}],
                                                                                                  "body": {
                                                                                                    "let": {
                                                                                                      "bindings": [
                                                                                                        {
                                                                                                          "name": "recursedTerm",
                                                                                                          "term": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "recursed"},
                                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                          "type": null}],
                                                                                                      "body": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "recursedTerm"},
                                                                                                          "function": {
                                                                                                            "function": {
                                                                                                              "elimination": {
                                                                                                                "union": {
                                                                                                                  "cases": [
                                                                                                                    {
                                                                                                                      "name": "let",
                                                                                                                      "term": {
                                                                                                                        "function": {
                                                                                                                          "lambda": {
                                                                                                                            "body": {
                                                                                                                              "application": {
                                                                                                                                "argument": {"variable": "lt2"},
                                                                                                                                "function": {
                                                                                                                                  "application": {
                                                                                                                                    "argument": {"variable": "newCounter"},
                                                                                                                                    "function": {
                                                                                                                                      "application": {
                                                                                                                                        "argument": {"variable": "cx"},
                                                                                                                                        "function": {"variable": "processLetTerm"}}}}}}},
                                                                                                                            "domain": null,
                                                                                                                            "parameter": "lt2"}}}}],
                                                                                                                  "default": [
                                                                                                                    {
                                                                                                                      "pair": {
                                                                                                                        "@first": {"variable": "newCounter"},
                                                                                                                        "@second": {"variable": "recursedTerm"}}}],
                                                                                                                  "typeName": "hydra.core.Term"}}}}}}}}}}}},
                                                                                          "domain": null,
                                                                                          "parameter": "lt"}}}}],
                                                                                "default": [
                                                                                  {
                                                                                    "application": {
                                                                                      "argument": {"variable": "term"},
                                                                                      "function": {
                                                                                        "application": {
                                                                                          "argument": {"variable": "counter"},
                                                                                          "function": {"variable": "recurse"}}}}}],
                                                                                "typeName": "hydra.core.Term"}}}}}},
                                                                    "domain": null,
                                                                    "parameter": "term"}}},
                                                              "domain": null,
                                                              "parameter": "counter"}}},
                                                        "domain": null,
                                                        "parameter": "cx"}}},
                                                  "domain": null,
                                                  "parameter": "recurse"}}},
                                            "type": null}],
                                        "body": {
                                          "application": {
                                            "argument": {
                                              "application": {
                                                "argument": {"variable": "term0"},
                                                "function": {
                                                  "application": {
                                                    "argument": {"literal": {"integer": {"int32": 1}}},
                                                    "function": {
                                                      "application": {
                                                        "argument": {"variable": "cx0"},
                                                        "function": {
                                                          "application": {
                                                            "argument": {"variable": "rewrite"},
                                                            "function": {"variable": "hydra.hoisting.rewriteAndFoldTermWithTypeContext"}}}}}}}}},
                                            "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}}}}}},
                            "domain": null,
                            "parameter": "term0"}}},
                      "domain": null,
                      "parameter": "cx0"}}},
                "domain": null,
                "parameter": "shouldHoist"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.isApplicationFunction",
      "term": {
        "function": {
          "lambda": {
            "body": {
              "application": {
                "argument": {"variable": "acc"},
                "function": {
                  "function": {
                    "elimination": {
                      "union": {
                        "cases": [
                          {
                            "name": "applicationFunction",
                            "term": {
                              "function": {
                                "lambda": {
                                  "body": {"literal": {"boolean": true}},
                                  "domain": null,
                                  "parameter": "_"}}}}],
                        "default": [{"literal": {"boolean": false}}],
                        "typeName": "hydra.accessors.TermAccessor"}}}}}},
            "domain": null,
            "parameter": "acc"}}},
      "type": null},
    {
      "name": "hydra.hoisting.isEliminationUnion",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {"literal": {"string": "Check if a function is a union elimination"}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "application": {
                    "argument": {"variable": "f"},
                    "function": {
                      "function": {
                        "elimination": {
                          "union": {
                            "cases": [
                              {
                                "name": "elimination",
                                "term": {
                                  "function": {
                                    "lambda": {
                                      "body": {
                                        "application": {
                                          "argument": {"variable": "e"},
                                          "function": {
                                            "function": {
                                              "elimination": {
                                                "union": {
                                                  "cases": [
                                                    {
                                                      "name": "union",
                                                      "term": {
                                                        "function": {
                                                          "lambda": {
                                                            "body": {"literal": {"boolean": true}},
                                                            "domain": null,
                                                            "parameter": "_"}}}}],
                                                  "default": [{"literal": {"boolean": false}}],
                                                  "typeName": "hydra.core.Elimination"}}}}}},
                                      "domain": null,
                                      "parameter": "e"}}}}],
                            "default": [{"literal": {"boolean": false}}],
                            "typeName": "hydra.core.Function"}}}}}},
                "domain": null,
                "parameter": "f"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.isLambdaBody",
      "term": {
        "function": {
          "lambda": {
            "body": {
              "application": {
                "argument": {"variable": "acc"},
                "function": {
                  "function": {
                    "elimination": {
                      "union": {
                        "cases": [
                          {
                            "name": "lambdaBody",
                            "term": {
                              "function": {
                                "lambda": {
                                  "body": {"literal": {"boolean": true}},
                                  "domain": null,
                                  "parameter": "_"}}}}],
                        "default": [{"literal": {"boolean": false}}],
                        "typeName": "hydra.accessors.TermAccessor"}}}}}},
            "domain": null,
            "parameter": "acc"}}},
      "type": null},
    {
      "name": "hydra.hoisting.isUnionElimination",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {"string": "Check if a term is a union elimination (case statement)"}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "application": {
                    "argument": {"variable": "term"},
                    "function": {
                      "function": {
                        "elimination": {
                          "union": {
                            "cases": [
                              {
                                "name": "function",
                                "term": {
                                  "function": {
                                    "lambda": {
                                      "body": {
                                        "application": {
                                          "argument": {"variable": "f"},
                                          "function": {"variable": "hydra.hoisting.isEliminationUnion"}}},
                                      "domain": null,
                                      "parameter": "f"}}}}],
                            "default": [{"literal": {"boolean": false}}],
                            "typeName": "hydra.core.Term"}}}}}},
                "domain": null,
                "parameter": "term"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.normalizePathForHoisting",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Normalize a path for hoisting by treating immediately-applied lambdas as let bindings. Replaces [applicationFunction, lambdaBody, ...] with [letBody, ...]."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "let": {
                    "bindings": [
                      {
                        "name": "go",
                        "term": {
                          "function": {
                            "lambda": {
                              "body": {
                                "application": {
                                  "argument": {
                                    "let": {
                                      "bindings": [
                                        {
                                          "name": "first",
                                          "term": {
                                            "application": {
                                              "argument": {"variable": "remaining"},
                                              "function": {"function": {"primitive": "hydra.lib.lists.head"}}}},
                                          "type": null}],
                                      "body": {
                                        "let": {
                                          "bindings": [
                                            {
                                              "name": "second",
                                              "term": {
                                                "application": {
                                                  "argument": {
                                                    "application": {
                                                      "argument": {"variable": "remaining"},
                                                      "function": {"function": {"primitive": "hydra.lib.lists.tail"}}}},
                                                  "function": {"function": {"primitive": "hydra.lib.lists.head"}}}},
                                              "type": null}],
                                          "body": {
                                            "let": {
                                              "bindings": [
                                                {
                                                  "name": "rest",
                                                  "term": {
                                                    "application": {
                                                      "argument": {
                                                        "application": {
                                                          "argument": {"variable": "remaining"},
                                                          "function": {"function": {"primitive": "hydra.lib.lists.tail"}}}},
                                                      "function": {"function": {"primitive": "hydra.lib.lists.tail"}}}},
                                                  "type": null}],
                                              "body": {
                                                "application": {
                                                  "argument": {
                                                    "application": {
                                                      "argument": {
                                                        "application": {
                                                          "argument": {
                                                            "application": {
                                                              "argument": {"variable": "remaining"},
                                                              "function": {"function": {"primitive": "hydra.lib.lists.tail"}}}},
                                                          "function": {"variable": "go"}}},
                                                      "function": {
                                                        "application": {
                                                          "argument": {"variable": "first"},
                                                          "function": {"function": {"primitive": "hydra.lib.lists.cons"}}}}}},
                                                  "function": {
                                                    "application": {
                                                      "argument": {
                                                        "application": {
                                                          "argument": {
                                                            "application": {"argument": {"variable": "rest"}, "function": {"variable": "go"}}},
                                                          "function": {
                                                            "application": {
                                                              "argument": {
                                                                "union": {
                                                                  "field": {"name": "letBody", "term": {"unit": {}}},
                                                                  "typeName": "hydra.accessors.TermAccessor"}},
                                                              "function": {"function": {"primitive": "hydra.lib.lists.cons"}}}}}},
                                                      "function": {
                                                        "application": {
                                                          "argument": {
                                                            "application": {
                                                              "argument": {
                                                                "application": {
                                                                  "argument": {"variable": "second"},
                                                                  "function": {"variable": "hydra.hoisting.isLambdaBody"}}},
                                                              "function": {
                                                                "application": {
                                                                  "argument": {
                                                                    "application": {
                                                                      "argument": {"variable": "first"},
                                                                      "function": {"variable": "hydra.hoisting.isApplicationFunction"}}},
                                                                  "function": {"function": {"primitive": "hydra.lib.logic.and"}}}}}},
                                                          "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}}}}}}}},
                                  "function": {
                                    "application": {
                                      "argument": {"variable": "remaining"},
                                      "function": {
                                        "application": {
                                          "argument": {
                                            "application": {
                                              "argument": {
                                                "application": {
                                                  "argument": {
                                                    "application": {
                                                      "argument": {"variable": "remaining"},
                                                      "function": {"function": {"primitive": "hydra.lib.lists.tail"}}}},
                                                  "function": {"function": {"primitive": "hydra.lib.lists.null"}}}},
                                              "function": {
                                                "application": {
                                                  "argument": {
                                                    "application": {
                                                      "argument": {"variable": "remaining"},
                                                      "function": {"function": {"primitive": "hydra.lib.lists.null"}}}},
                                                  "function": {"function": {"primitive": "hydra.lib.logic.or"}}}}}},
                                          "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                              "domain": null,
                              "parameter": "remaining"}}},
                        "type": null}],
                    "body": {
                      "application": {"argument": {"variable": "path"}, "function": {"variable": "go"}}}}},
                "domain": null,
                "parameter": "path"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.rewriteAndFoldTermWithTypeContext",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Rewrite a term while folding to produce a value, with TypeContext updated as we descend into subterms. Combines the features of rewriteAndFoldTerm and rewriteTermWithTypeContext. The user function f receives a recurse function that handles subterm traversal and TypeContext management."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "function": {
                          "lambda": {
                            "body": {
                              "function": {
                                "lambda": {
                                  "body": {
                                    "let": {
                                      "bindings": [
                                        {
                                          "name": "wrapper",
                                          "term": {
                                            "function": {
                                              "lambda": {
                                                "body": {
                                                  "function": {
                                                    "lambda": {
                                                      "body": {
                                                        "function": {
                                                          "lambda": {
                                                            "body": {
                                                              "let": {
                                                                "bindings": [
                                                                  {
                                                                    "name": "val",
                                                                    "term": {
                                                                      "application": {
                                                                        "argument": {"variable": "valAndCx"},
                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                    "type": null}],
                                                                "body": {
                                                                  "let": {
                                                                    "bindings": [
                                                                      {
                                                                        "name": "cx",
                                                                        "term": {
                                                                          "application": {
                                                                            "argument": {"variable": "valAndCx"},
                                                                            "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                        "type": null}],
                                                                    "body": {
                                                                      "let": {
                                                                        "bindings": [
                                                                          {
                                                                            "name": "cx1",
                                                                            "term": {
                                                                              "application": {
                                                                                "argument": {"variable": "term"},
                                                                                "function": {
                                                                                  "function": {
                                                                                    "elimination": {
                                                                                      "union": {
                                                                                        "cases": [
                                                                                          {
                                                                                            "name": "function",
                                                                                            "term": {
                                                                                              "function": {
                                                                                                "lambda": {
                                                                                                  "body": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "fun"},
                                                                                                      "function": {
                                                                                                        "function": {
                                                                                                          "elimination": {
                                                                                                            "union": {
                                                                                                              "cases": [
                                                                                                                {
                                                                                                                  "name": "lambda",
                                                                                                                  "term": {
                                                                                                                    "function": {
                                                                                                                      "lambda": {
                                                                                                                        "body": {
                                                                                                                          "application": {
                                                                                                                            "argument": {"variable": "l"},
                                                                                                                            "function": {
                                                                                                                              "application": {
                                                                                                                                "argument": {"variable": "cx"},
                                                                                                                                "function": {"variable": "hydra.schemas.extendTypeContextForLambda"}}}}},
                                                                                                                        "domain": null,
                                                                                                                        "parameter": "l"}}}}],
                                                                                                              "default": [{"variable": "cx"}],
                                                                                                              "typeName": "hydra.core.Function"}}}}}},
                                                                                                  "domain": null,
                                                                                                  "parameter": "fun"}}}},
                                                                                          {
                                                                                            "name": "let",
                                                                                            "term": {
                                                                                              "function": {
                                                                                                "lambda": {
                                                                                                  "body": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "l"},
                                                                                                      "function": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "cx"},
                                                                                                          "function": {
                                                                                                            "application": {
                                                                                                              "argument": {
                                                                                                                "function": {
                                                                                                                  "lambda": {
                                                                                                                    "body": {
                                                                                                                      "function": {
                                                                                                                        "lambda": {"body": {"maybe": null}, "domain": null, "parameter": "_"}}},
                                                                                                                    "domain": null,
                                                                                                                    "parameter": "_"}}},
                                                                                                              "function": {"variable": "hydra.schemas.extendTypeContextForLet"}}}}}}},
                                                                                                  "domain": null,
                                                                                                  "parameter": "l"}}}},
                                                                                          {
                                                                                            "name": "typeLambda",
                                                                                            "term": {
                                                                                              "function": {
                                                                                                "lambda": {
                                                                                                  "body": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "tl"},
                                                                                                      "function": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "cx"},
                                                                                                          "function": {"variable": "hydra.schemas.extendTypeContextForTypeLambda"}}}}},
                                                                                                  "domain": null,
                                                                                                  "parameter": "tl"}}}}],
                                                                                        "default": [{"variable": "cx"}],
                                                                                        "typeName": "hydra.core.Term"}}}}}},
                                                                            "type": null}],
                                                                        "body": {
                                                                          "let": {
                                                                            "bindings": [
                                                                              {
                                                                                "name": "recurseForUser",
                                                                                "term": {
                                                                                  "function": {
                                                                                    "lambda": {
                                                                                      "body": {
                                                                                        "function": {
                                                                                          "lambda": {
                                                                                            "body": {
                                                                                              "let": {
                                                                                                "bindings": [
                                                                                                  {
                                                                                                    "name": "result",
                                                                                                    "term": {
                                                                                                      "application": {
                                                                                                        "argument": {"variable": "subterm"},
                                                                                                        "function": {
                                                                                                          "application": {
                                                                                                            "argument": {
                                                                                                              "pair": {"@first": {"variable": "newVal"}, "@second": {"variable": "cx1"}}},
                                                                                                            "function": {"variable": "lowLevelRecurse"}}}}},
                                                                                                    "type": null}],
                                                                                                "body": {
                                                                                                  "pair": {
                                                                                                    "@first": {
                                                                                                      "application": {
                                                                                                        "argument": {
                                                                                                          "application": {
                                                                                                            "argument": {"variable": "result"},
                                                                                                            "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                    "@second": {
                                                                                                      "application": {
                                                                                                        "argument": {"variable": "result"},
                                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}}}},
                                                                                            "domain": null,
                                                                                            "parameter": "subterm"}}},
                                                                                      "domain": null,
                                                                                      "parameter": "newVal"}}},
                                                                                "type": null}],
                                                                            "body": {
                                                                              "let": {
                                                                                "bindings": [
                                                                                  {
                                                                                    "name": "fResult",
                                                                                    "term": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "term"},
                                                                                        "function": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "val"},
                                                                                            "function": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "cx1"},
                                                                                                "function": {
                                                                                                  "application": {
                                                                                                    "argument": {"variable": "recurseForUser"},
                                                                                                    "function": {"variable": "f"}}}}}}}}},
                                                                                    "type": null}],
                                                                                "body": {
                                                                                  "pair": {
                                                                                    "@first": {
                                                                                      "pair": {
                                                                                        "@first": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "fResult"},
                                                                                            "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                        "@second": {"variable": "cx"}}},
                                                                                    "@second": {
                                                                                      "application": {
                                                                                        "argument": {"variable": "fResult"},
                                                                                        "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}}}}}}}}}}}},
                                                            "domain": null,
                                                            "parameter": "term"}}},
                                                      "domain": null,
                                                      "parameter": "valAndCx"}}},
                                                "domain": null,
                                                "parameter": "lowLevelRecurse"}}},
                                          "type": null}],
                                      "body": {
                                        "let": {
                                          "bindings": [
                                            {
                                              "name": "result",
                                              "term": {
                                                "application": {
                                                  "argument": {"variable": "term0"},
                                                  "function": {
                                                    "application": {
                                                      "argument": {
                                                        "pair": {"@first": {"variable": "val0"}, "@second": {"variable": "cx0"}}},
                                                      "function": {
                                                        "application": {
                                                          "argument": {"variable": "wrapper"},
                                                          "function": {"variable": "hydra.rewriting.rewriteAndFoldTerm"}}}}}}},
                                              "type": null}],
                                          "body": {
                                            "pair": {
                                              "@first": {
                                                "application": {
                                                  "argument": {
                                                    "application": {
                                                      "argument": {"variable": "result"},
                                                      "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                  "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                              "@second": {
                                                "application": {
                                                  "argument": {"variable": "result"},
                                                  "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}}}}}},
                                  "domain": null,
                                  "parameter": "term0"}}},
                            "domain": null,
                            "parameter": "val0"}}},
                      "domain": null,
                      "parameter": "cx0"}}},
                "domain": null,
                "parameter": "f"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.rewriteAndFoldTermWithTypeContextAndPath",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Rewrite a term while folding to produce a value, with both TypeContext and accessor path tracked. The path is a list of TermAccessors representing the position from the root to the current term. Combines the features of rewriteAndFoldTermWithPath and TypeContext tracking. The TypeContext is automatically updated when descending into lambdas, lets, and type lambdas."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "function": {
                          "lambda": {
                            "body": {
                              "function": {
                                "lambda": {
                                  "body": {
                                    "let": {
                                      "bindings": [
                                        {
                                          "name": "wrapper",
                                          "term": {
                                            "function": {
                                              "lambda": {
                                                "body": {
                                                  "function": {
                                                    "lambda": {
                                                      "body": {
                                                        "function": {
                                                          "lambda": {
                                                            "body": {
                                                              "function": {
                                                                "lambda": {
                                                                  "body": {
                                                                    "let": {
                                                                      "bindings": [
                                                                        {
                                                                          "name": "cx",
                                                                          "term": {
                                                                            "application": {
                                                                              "argument": {"variable": "cxAndVal"},
                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                          "type": null}],
                                                                      "body": {
                                                                        "let": {
                                                                          "bindings": [
                                                                            {
                                                                              "name": "val",
                                                                              "term": {
                                                                                "application": {
                                                                                  "argument": {"variable": "cxAndVal"},
                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                              "type": null}],
                                                                          "body": {
                                                                            "let": {
                                                                              "bindings": [
                                                                                {
                                                                                  "name": "cx1",
                                                                                  "term": {
                                                                                    "application": {
                                                                                      "argument": {"variable": "term"},
                                                                                      "function": {
                                                                                        "function": {
                                                                                          "elimination": {
                                                                                            "union": {
                                                                                              "cases": [
                                                                                                {
                                                                                                  "name": "function",
                                                                                                  "term": {
                                                                                                    "function": {
                                                                                                      "lambda": {
                                                                                                        "body": {
                                                                                                          "application": {
                                                                                                            "argument": {"variable": "fun"},
                                                                                                            "function": {
                                                                                                              "function": {
                                                                                                                "elimination": {
                                                                                                                  "union": {
                                                                                                                    "cases": [
                                                                                                                      {
                                                                                                                        "name": "lambda",
                                                                                                                        "term": {
                                                                                                                          "function": {
                                                                                                                            "lambda": {
                                                                                                                              "body": {
                                                                                                                                "application": {
                                                                                                                                  "argument": {"variable": "l"},
                                                                                                                                  "function": {
                                                                                                                                    "application": {
                                                                                                                                      "argument": {"variable": "cx"},
                                                                                                                                      "function": {"variable": "hydra.schemas.extendTypeContextForLambda"}}}}},
                                                                                                                              "domain": null,
                                                                                                                              "parameter": "l"}}}}],
                                                                                                                    "default": [{"variable": "cx"}],
                                                                                                                    "typeName": "hydra.core.Function"}}}}}},
                                                                                                        "domain": null,
                                                                                                        "parameter": "fun"}}}},
                                                                                                {
                                                                                                  "name": "let",
                                                                                                  "term": {
                                                                                                    "function": {
                                                                                                      "lambda": {
                                                                                                        "body": {
                                                                                                          "application": {
                                                                                                            "argument": {"variable": "l"},
                                                                                                            "function": {
                                                                                                              "application": {
                                                                                                                "argument": {"variable": "cx"},
                                                                                                                "function": {
                                                                                                                  "application": {
                                                                                                                    "argument": {
                                                                                                                      "function": {
                                                                                                                        "lambda": {
                                                                                                                          "body": {
                                                                                                                            "function": {
                                                                                                                              "lambda": {"body": {"maybe": null}, "domain": null, "parameter": "_"}}},
                                                                                                                          "domain": null,
                                                                                                                          "parameter": "_"}}},
                                                                                                                    "function": {"variable": "hydra.schemas.extendTypeContextForLet"}}}}}}},
                                                                                                        "domain": null,
                                                                                                        "parameter": "l"}}}},
                                                                                                {
                                                                                                  "name": "typeLambda",
                                                                                                  "term": {
                                                                                                    "function": {
                                                                                                      "lambda": {
                                                                                                        "body": {
                                                                                                          "application": {
                                                                                                            "argument": {"variable": "tl"},
                                                                                                            "function": {
                                                                                                              "application": {
                                                                                                                "argument": {"variable": "cx"},
                                                                                                                "function": {"variable": "hydra.schemas.extendTypeContextForTypeLambda"}}}}},
                                                                                                        "domain": null,
                                                                                                        "parameter": "tl"}}}}],
                                                                                              "default": [{"variable": "cx"}],
                                                                                              "typeName": "hydra.core.Term"}}}}}},
                                                                                  "type": null}],
                                                                              "body": {
                                                                                "let": {
                                                                                  "bindings": [
                                                                                    {
                                                                                      "name": "recurseForUser",
                                                                                      "term": {
                                                                                        "function": {
                                                                                          "lambda": {
                                                                                            "body": {
                                                                                              "function": {
                                                                                                "lambda": {
                                                                                                  "body": {
                                                                                                    "let": {
                                                                                                      "bindings": [
                                                                                                        {
                                                                                                          "name": "result",
                                                                                                          "term": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "termIn"},
                                                                                                              "function": {
                                                                                                                "application": {
                                                                                                                  "argument": {
                                                                                                                    "pair": {"@first": {"variable": "cx1"}, "@second": {"variable": "valIn"}}},
                                                                                                                  "function": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "path"},
                                                                                                                      "function": {"variable": "recurse"}}}}}}},
                                                                                                          "type": null}],
                                                                                                      "body": {
                                                                                                        "pair": {
                                                                                                          "@first": {
                                                                                                            "application": {
                                                                                                              "argument": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "result"},
                                                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                                                                                          "@second": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "result"},
                                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}}}},
                                                                                                  "domain": null,
                                                                                                  "parameter": "termIn"}}},
                                                                                            "domain": null,
                                                                                            "parameter": "valIn"}}},
                                                                                      "type": null}],
                                                                                  "body": {
                                                                                    "let": {
                                                                                      "bindings": [
                                                                                        {
                                                                                          "name": "fResult",
                                                                                          "term": {
                                                                                            "application": {
                                                                                              "argument": {"variable": "term"},
                                                                                              "function": {
                                                                                                "application": {
                                                                                                  "argument": {"variable": "val"},
                                                                                                  "function": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "cx1"},
                                                                                                      "function": {
                                                                                                        "application": {
                                                                                                          "argument": {"variable": "path"},
                                                                                                          "function": {
                                                                                                            "application": {
                                                                                                              "argument": {"variable": "recurseForUser"},
                                                                                                              "function": {"variable": "f"}}}}}}}}}}},
                                                                                          "type": null}],
                                                                                      "body": {
                                                                                        "pair": {
                                                                                          "@first": {
                                                                                            "pair": {
                                                                                              "@first": {"variable": "cx"},
                                                                                              "@second": {
                                                                                                "application": {
                                                                                                  "argument": {"variable": "fResult"},
                                                                                                  "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}}}},
                                                                                          "@second": {
                                                                                            "application": {
                                                                                              "argument": {"variable": "fResult"},
                                                                                              "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}}}}}}}}}}}},
                                                                  "domain": null,
                                                                  "parameter": "term"}}},
                                                            "domain": null,
                                                            "parameter": "cxAndVal"}}},
                                                      "domain": null,
                                                      "parameter": "path"}}},
                                                "domain": null,
                                                "parameter": "recurse"}}},
                                          "type": null}],
                                      "body": {
                                        "let": {
                                          "bindings": [
                                            {
                                              "name": "result",
                                              "term": {
                                                "application": {
                                                  "argument": {"variable": "term0"},
                                                  "function": {
                                                    "application": {
                                                      "argument": {
                                                        "pair": {"@first": {"variable": "cx0"}, "@second": {"variable": "val0"}}},
                                                      "function": {
                                                        "application": {
                                                          "argument": {"variable": "wrapper"},
                                                          "function": {"variable": "hydra.rewriting.rewriteAndFoldTermWithPath"}}}}}}},
                                              "type": null}],
                                          "body": {
                                            "pair": {
                                              "@first": {
                                                "application": {
                                                  "argument": {
                                                    "application": {
                                                      "argument": {"variable": "result"},
                                                      "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                                  "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                              "@second": {
                                                "application": {
                                                  "argument": {"variable": "result"},
                                                  "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}}}}}}}},
                                  "domain": null,
                                  "parameter": "term0"}}},
                            "domain": null,
                            "parameter": "val0"}}},
                      "domain": null,
                      "parameter": "cx0"}}},
                "domain": null,
                "parameter": "f"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.rewriteTermWithTypeContext",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Rewrite a term with the help of a type context which is updated as we descend into subterms"}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "function": {
                          "lambda": {
                            "body": {
                              "let": {
                                "bindings": [
                                  {
                                    "name": "f2",
                                    "term": {
                                      "function": {
                                        "lambda": {
                                          "body": {
                                            "function": {
                                              "lambda": {
                                                "body": {
                                                  "function": {
                                                    "lambda": {
                                                      "body": {
                                                        "let": {
                                                          "bindings": [
                                                            {
                                                              "name": "recurse1",
                                                              "term": {
                                                                "function": {
                                                                  "lambda": {
                                                                    "body": {
                                                                      "application": {
                                                                        "argument": {"variable": "term"},
                                                                        "function": {
                                                                          "application": {"argument": {"variable": "cx"}, "function": {"variable": "recurse"}}}}},
                                                                    "domain": null,
                                                                    "parameter": "term"}}},
                                                              "type": null}],
                                                          "body": {
                                                            "application": {
                                                              "argument": {"variable": "term"},
                                                              "function": {
                                                                "function": {
                                                                  "elimination": {
                                                                    "union": {
                                                                      "cases": [
                                                                        {
                                                                          "name": "function",
                                                                          "term": {
                                                                            "function": {
                                                                              "lambda": {
                                                                                "body": {
                                                                                  "application": {
                                                                                    "argument": {"variable": "fun"},
                                                                                    "function": {
                                                                                      "function": {
                                                                                        "elimination": {
                                                                                          "union": {
                                                                                            "cases": [
                                                                                              {
                                                                                                "name": "lambda",
                                                                                                "term": {
                                                                                                  "function": {
                                                                                                    "lambda": {
                                                                                                      "body": {
                                                                                                        "let": {
                                                                                                          "bindings": [
                                                                                                            {
                                                                                                              "name": "cx1",
                                                                                                              "term": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "l"},
                                                                                                                  "function": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "cx"},
                                                                                                                      "function": {"variable": "hydra.schemas.extendTypeContextForLambda"}}}}},
                                                                                                              "type": null}],
                                                                                                          "body": {
                                                                                                            "let": {
                                                                                                              "bindings": [
                                                                                                                {
                                                                                                                  "name": "recurse2",
                                                                                                                  "term": {
                                                                                                                    "function": {
                                                                                                                      "lambda": {
                                                                                                                        "body": {
                                                                                                                          "application": {
                                                                                                                            "argument": {"variable": "term"},
                                                                                                                            "function": {
                                                                                                                              "application": {"argument": {"variable": "cx1"}, "function": {"variable": "recurse"}}}}},
                                                                                                                        "domain": null,
                                                                                                                        "parameter": "term"}}},
                                                                                                                  "type": null}],
                                                                                                              "body": {
                                                                                                                "application": {
                                                                                                                  "argument": {"variable": "term"},
                                                                                                                  "function": {
                                                                                                                    "application": {
                                                                                                                      "argument": {"variable": "cx1"},
                                                                                                                      "function": {
                                                                                                                        "application": {"argument": {"variable": "recurse2"}, "function": {"variable": "f"}}}}}}}}}}},
                                                                                                      "domain": null,
                                                                                                      "parameter": "l"}}}}],
                                                                                            "default": [
                                                                                              {
                                                                                                "application": {
                                                                                                  "argument": {"variable": "term"},
                                                                                                  "function": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "cx"},
                                                                                                      "function": {
                                                                                                        "application": {"argument": {"variable": "recurse1"}, "function": {"variable": "f"}}}}}}}],
                                                                                            "typeName": "hydra.core.Function"}}}}}},
                                                                                "domain": null,
                                                                                "parameter": "fun"}}}},
                                                                        {
                                                                          "name": "let",
                                                                          "term": {
                                                                            "function": {
                                                                              "lambda": {
                                                                                "body": {
                                                                                  "let": {
                                                                                    "bindings": [
                                                                                      {
                                                                                        "name": "cx1",
                                                                                        "term": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "l"},
                                                                                            "function": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "cx"},
                                                                                                "function": {
                                                                                                  "application": {
                                                                                                    "argument": {
                                                                                                      "function": {
                                                                                                        "lambda": {
                                                                                                          "body": {
                                                                                                            "function": {
                                                                                                              "lambda": {"body": {"maybe": null}, "domain": null, "parameter": "_"}}},
                                                                                                          "domain": null,
                                                                                                          "parameter": "_"}}},
                                                                                                    "function": {"variable": "hydra.schemas.extendTypeContextForLet"}}}}}}},
                                                                                        "type": null}],
                                                                                    "body": {
                                                                                      "let": {
                                                                                        "bindings": [
                                                                                          {
                                                                                            "name": "recurse2",
                                                                                            "term": {
                                                                                              "function": {
                                                                                                "lambda": {
                                                                                                  "body": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "term"},
                                                                                                      "function": {
                                                                                                        "application": {"argument": {"variable": "cx1"}, "function": {"variable": "recurse"}}}}},
                                                                                                  "domain": null,
                                                                                                  "parameter": "term"}}},
                                                                                            "type": null}],
                                                                                        "body": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "term"},
                                                                                            "function": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "cx1"},
                                                                                                "function": {
                                                                                                  "application": {"argument": {"variable": "recurse2"}, "function": {"variable": "f"}}}}}}}}}}},
                                                                                "domain": null,
                                                                                "parameter": "l"}}}},
                                                                        {
                                                                          "name": "typeLambda",
                                                                          "term": {
                                                                            "function": {
                                                                              "lambda": {
                                                                                "body": {
                                                                                  "let": {
                                                                                    "bindings": [
                                                                                      {
                                                                                        "name": "cx1",
                                                                                        "term": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "tl"},
                                                                                            "function": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "cx"},
                                                                                                "function": {"variable": "hydra.schemas.extendTypeContextForTypeLambda"}}}}},
                                                                                        "type": null}],
                                                                                    "body": {
                                                                                      "let": {
                                                                                        "bindings": [
                                                                                          {
                                                                                            "name": "recurse2",
                                                                                            "term": {
                                                                                              "function": {
                                                                                                "lambda": {
                                                                                                  "body": {
                                                                                                    "application": {
                                                                                                      "argument": {"variable": "term"},
                                                                                                      "function": {
                                                                                                        "application": {"argument": {"variable": "cx1"}, "function": {"variable": "recurse"}}}}},
                                                                                                  "domain": null,
                                                                                                  "parameter": "term"}}},
                                                                                            "type": null}],
                                                                                        "body": {
                                                                                          "application": {
                                                                                            "argument": {"variable": "term"},
                                                                                            "function": {
                                                                                              "application": {
                                                                                                "argument": {"variable": "cx1"},
                                                                                                "function": {
                                                                                                  "application": {"argument": {"variable": "recurse2"}, "function": {"variable": "f"}}}}}}}}}}},
                                                                                "domain": null,
                                                                                "parameter": "tl"}}}}],
                                                                      "default": [
                                                                        {
                                                                          "application": {
                                                                            "argument": {"variable": "term"},
                                                                            "function": {
                                                                              "application": {
                                                                                "argument": {"variable": "cx"},
                                                                                "function": {
                                                                                  "application": {"argument": {"variable": "recurse1"}, "function": {"variable": "f"}}}}}}}],
                                                                      "typeName": "hydra.core.Term"}}}}}}}},
                                                      "domain": null,
                                                      "parameter": "term"}}},
                                                "domain": null,
                                                "parameter": "cx"}}},
                                          "domain": null,
                                          "parameter": "recurse"}}},
                                    "type": null}],
                                "body": {
                                  "let": {
                                    "bindings": [
                                      {
                                        "name": "rewrite",
                                        "term": {
                                          "function": {
                                            "lambda": {
                                              "body": {
                                                "function": {
                                                  "lambda": {
                                                    "body": {
                                                      "application": {
                                                        "argument": {"variable": "term"},
                                                        "function": {
                                                          "application": {
                                                            "argument": {"variable": "cx"},
                                                            "function": {
                                                              "application": {"argument": {"variable": "rewrite"}, "function": {"variable": "f2"}}}}}}},
                                                    "domain": null,
                                                    "parameter": "term"}}},
                                              "domain": null,
                                              "parameter": "cx"}}},
                                        "type": null}],
                                    "body": {
                                      "application": {
                                        "argument": {"variable": "term0"},
                                        "function": {
                                          "application": {"argument": {"variable": "cx0"}, "function": {"variable": "rewrite"}}}}}}}}},
                            "domain": null,
                            "parameter": "term0"}}},
                      "domain": null,
                      "parameter": "cx0"}}},
                "domain": null,
                "parameter": "f"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.shouldHoistAll",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Predicate that always returns True, for hoisting all bindings unconditionally."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {"literal": {"boolean": true}},
                      "domain": null,
                      "parameter": "_"}}},
                "domain": null,
                "parameter": "_"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.shouldHoistCaseStatement",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Predicate for case statement hoisting. Returns True if term is a case statement AND not at top level. Top level = reachable through annotations, let body/binding, lambda bodies, or ONE app LHS. Once through an app LHS, lambda bodies no longer pass through."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "let": {
                    "bindings": [
                      {
                        "name": "path",
                        "term": {
                          "application": {
                            "argument": {"variable": "pathAndTerm"},
                            "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                        "type": null}],
                    "body": {
                      "let": {
                        "bindings": [
                          {
                            "name": "term",
                            "term": {
                              "application": {
                                "argument": {"variable": "pathAndTerm"},
                                "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                            "type": null}],
                        "body": {
                          "application": {
                            "argument": {
                              "let": {
                                "bindings": [
                                  {
                                    "name": "finalState",
                                    "term": {
                                      "application": {
                                        "argument": {"variable": "path"},
                                        "function": {
                                          "application": {
                                            "argument": {
                                              "pair": {
                                                "@first": {"literal": {"boolean": true}},
                                                "@second": {"literal": {"boolean": false}}}},
                                            "function": {
                                              "application": {
                                                "argument": {
                                                  "function": {
                                                    "lambda": {
                                                      "body": {
                                                        "function": {
                                                          "lambda": {
                                                            "body": {
                                                              "application": {
                                                                "argument": {"variable": "st"},
                                                                "function": {
                                                                  "application": {
                                                                    "argument": {"variable": "acc"},
                                                                    "function": {"variable": "hydra.hoisting.updateHoistState"}}}}},
                                                            "domain": null,
                                                            "parameter": "acc"}}},
                                                      "domain": null,
                                                      "parameter": "st"}}},
                                                "function": {"function": {"primitive": "hydra.lib.lists.foldl"}}}}}}}},
                                    "type": null}],
                                "body": {
                                  "application": {
                                    "argument": {
                                      "application": {
                                        "argument": {"variable": "finalState"},
                                        "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                                    "function": {"function": {"primitive": "hydra.lib.logic.not"}}}}}},
                            "function": {
                              "application": {
                                "argument": {"literal": {"boolean": false}},
                                "function": {
                                  "application": {
                                    "argument": {
                                      "application": {
                                        "argument": {
                                          "application": {
                                            "argument": {"variable": "term"},
                                            "function": {"variable": "hydra.hoisting.isUnionElimination"}}},
                                        "function": {"function": {"primitive": "hydra.lib.logic.not"}}}},
                                    "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}}}}}},
                "domain": null,
                "parameter": "pathAndTerm"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.shouldHoistPolymorphic",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Predicate for hoisting polymorphic bindings. Returns True if the binding is polymorphic (has type scheme variables) or if its type uses any type variables from the TypeContext."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "application": {
                          "argument": {
                            "application": {
                              "argument": {"variable": "binding"},
                              "function": {
                                "application": {
                                  "argument": {"variable": "cx"},
                                  "function": {"variable": "hydra.hoisting.bindingUsesContextTypeVars"}}}}},
                          "function": {
                            "application": {
                              "argument": {
                                "application": {
                                  "argument": {"variable": "binding"},
                                  "function": {"variable": "hydra.hoisting.bindingIsPolymorphic"}}},
                              "function": {"function": {"primitive": "hydra.lib.logic.or"}}}}}},
                      "domain": null,
                      "parameter": "binding"}}},
                "domain": null,
                "parameter": "cx"}}}}},
      "type": null},
    {
      "name": "hydra.hoisting.updateHoistState",
      "term": {
        "annotated": {
          "annotation": [
            {
              "@key": "description",
              "@value": {
                "literal": {
                  "string": "Update hoisting state when traversing an accessor. State is (atTopLevel, usedAppLHS). Returns updated state."}}}],
          "body": {
            "function": {
              "lambda": {
                "body": {
                  "function": {
                    "lambda": {
                      "body": {
                        "let": {
                          "bindings": [
                            {
                              "name": "atTop",
                              "term": {
                                "application": {
                                  "argument": {"variable": "state"},
                                  "function": {"function": {"primitive": "hydra.lib.pairs.first"}}}},
                              "type": null}],
                          "body": {
                            "let": {
                              "bindings": [
                                {
                                  "name": "usedApp",
                                  "term": {
                                    "application": {
                                      "argument": {"variable": "state"},
                                      "function": {"function": {"primitive": "hydra.lib.pairs.second"}}}},
                                  "type": null}],
                              "body": {
                                "application": {
                                  "argument": {
                                    "application": {
                                      "argument": {"variable": "accessor"},
                                      "function": {
                                        "function": {
                                          "elimination": {
                                            "union": {
                                              "cases": [
                                                {
                                                  "name": "annotatedBody",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "pair": {
                                                            "@first": {"literal": {"boolean": true}},
                                                            "@second": {"variable": "usedApp"}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}},
                                                {
                                                  "name": "letBody",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "pair": {
                                                            "@first": {"literal": {"boolean": true}},
                                                            "@second": {"variable": "usedApp"}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}},
                                                {
                                                  "name": "letBinding",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "pair": {
                                                            "@first": {"literal": {"boolean": true}},
                                                            "@second": {"variable": "usedApp"}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}},
                                                {
                                                  "name": "lambdaBody",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "application": {
                                                            "argument": {
                                                              "pair": {
                                                                "@first": {"literal": {"boolean": true}},
                                                                "@second": {"literal": {"boolean": false}}}},
                                                            "function": {
                                                              "application": {
                                                                "argument": {
                                                                  "pair": {
                                                                    "@first": {"literal": {"boolean": false}},
                                                                    "@second": {"literal": {"boolean": true}}}},
                                                                "function": {
                                                                  "application": {
                                                                    "argument": {"variable": "usedApp"},
                                                                    "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}},
                                                {
                                                  "name": "unionCasesBranch",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "application": {
                                                            "argument": {
                                                              "pair": {
                                                                "@first": {"literal": {"boolean": true}},
                                                                "@second": {"literal": {"boolean": false}}}},
                                                            "function": {
                                                              "application": {
                                                                "argument": {
                                                                  "pair": {
                                                                    "@first": {"literal": {"boolean": false}},
                                                                    "@second": {"literal": {"boolean": true}}}},
                                                                "function": {
                                                                  "application": {
                                                                    "argument": {"variable": "usedApp"},
                                                                    "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}},
                                                {
                                                  "name": "unionCasesDefault",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "application": {
                                                            "argument": {
                                                              "pair": {
                                                                "@first": {"literal": {"boolean": true}},
                                                                "@second": {"literal": {"boolean": false}}}},
                                                            "function": {
                                                              "application": {
                                                                "argument": {
                                                                  "pair": {
                                                                    "@first": {"literal": {"boolean": false}},
                                                                    "@second": {"literal": {"boolean": true}}}},
                                                                "function": {
                                                                  "application": {
                                                                    "argument": {"variable": "usedApp"},
                                                                    "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}},
                                                {
                                                  "name": "applicationFunction",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "application": {
                                                            "argument": {
                                                              "pair": {
                                                                "@first": {"literal": {"boolean": true}},
                                                                "@second": {"literal": {"boolean": true}}}},
                                                            "function": {
                                                              "application": {
                                                                "argument": {
                                                                  "pair": {
                                                                    "@first": {"literal": {"boolean": false}},
                                                                    "@second": {"literal": {"boolean": true}}}},
                                                                "function": {
                                                                  "application": {
                                                                    "argument": {"variable": "usedApp"},
                                                                    "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}},
                                                {
                                                  "name": "applicationArgument",
                                                  "term": {
                                                    "function": {
                                                      "lambda": {
                                                        "body": {
                                                          "pair": {
                                                            "@first": {"literal": {"boolean": false}},
                                                            "@second": {"variable": "usedApp"}}},
                                                        "domain": null,
                                                        "parameter": "_"}}}}],
                                              "default": [
                                                {
                                                  "pair": {
                                                    "@first": {"literal": {"boolean": false}},
                                                    "@second": {"variable": "usedApp"}}}],
                                              "typeName": "hydra.accessors.TermAccessor"}}}}}},
                                  "function": {
                                    "application": {
                                      "argument": {
                                        "pair": {
                                          "@first": {"literal": {"boolean": false}},
                                          "@second": {"variable": "usedApp"}}},
                                      "function": {
                                        "application": {
                                          "argument": {
                                            "application": {
                                              "argument": {"variable": "atTop"},
                                              "function": {"function": {"primitive": "hydra.lib.logic.not"}}}},
                                          "function": {"function": {"primitive": "hydra.lib.logic.ifElse"}}}}}}}}}}}},
                      "domain": null,
                      "parameter": "state"}}},
                "domain": null,
                "parameter": "accessor"}}}}},
      "type": null}],
  "namespace": "hydra.hoisting",
  "termDependencies": [
    "hydra.lexical",
    "hydra.rewriting",
    "hydra.schemas",
    "hydra.sorting",
    "hydra.substitution"],
  "typeDependencies": [
    "hydra.accessors",
    "hydra.ast",
    "hydra.classes",
    "hydra.coders",
    "hydra.compute",
    "hydra.constraints",
    "hydra.core",
    "hydra.grammar",
    "hydra.graph",
    "hydra.json.model",
    "hydra.module",
    "hydra.parsing",
    "hydra.phantoms",
    "hydra.query",
    "hydra.relational",
    "hydra.tabular",
    "hydra.testing",
    "hydra.topology",
    "hydra.typing",
    "hydra.util",
    "hydra.variants",
    "hydra.workflow"]}
