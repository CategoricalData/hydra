# Note: this is an automatically generated file. Do not edit.

r"""Test cases for eta expansion of terms."""

from __future__ import annotations
from hydra.dsl.python import FrozenDict, Just, Maybe, Nothing, frozenlist
from typing import cast
import hydra.core
import hydra.test.test_types
import hydra.testing

def all_tests() -> hydra.testing.TestGroup:
    r"""Test cases for eta expansion of terms."""
    
    return hydra.testing.TestGroup("eta expansion", cast(Maybe[str], Nothing()), (hydra.testing.TestGroup("Partial application of primitives", cast(Maybe[str], Nothing()), (hydra.testing.TestGroup("Bare primitives are not expanded", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("unary primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("binary primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("Partially applied primitives expand with lambdas", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("binary primitive with one argument", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("ternary primitive with one argument", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.lists.foldl"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.lists.foldl"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v2"))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("Fully applied primitives are not expanded", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("unary primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("FOO"))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("FOO")))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("binary primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a,b,c"))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a,b,c")))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("Record projections", cast(Maybe[str], Nothing()), (hydra.testing.TestGroup("Bare projections expand with a lambda", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("projection without argument", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())),)), hydra.testing.TestGroup("Applied projections are not expanded", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("projection with argument", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("person")))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("person"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("projection applied to a record", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.test.test_types.test_type_person_name, (hydra.core.Field(hydra.core.Name("firstName"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("John"))))), hydra.core.Field(hydra.core.Name("lastName"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("Doe")))))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.test.test_types.test_type_person_name, (hydra.core.Field(hydra.core.Name("firstName"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("John"))))), hydra.core.Field(hydra.core.Name("lastName"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("Doe"))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("Projections nested in other structures", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("projection in a list", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("projection in a tuple", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermPair(cast(tuple[hydra.core.Term, hydra.core.Term], (cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("default")))))))), cast(hydra.core.Term, hydra.core.TermPair(cast(tuple[hydra.core.Term, hydra.core.Term], (cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("default"))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("projection in let binding", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("getter"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(Maybe[hydra.core.TypeScheme], Nothing())),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("getter")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("getter"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))), cast(Maybe[hydra.core.TypeScheme], Nothing())),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("getter"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("projection in lambda body", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName"))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("Function-valued projections", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("projection of function-valued field applied to arguments should not be expanded", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_triple_name, hydra.core.Name("first")))))))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.test.test_types.test_type_triple_name, (hydra.core.Field(hydra.core.Name("first"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))), hydra.core.Field(hydra.core.Name("second"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("middle"))))), hydra.core.Field(hydra.core.Name("third"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("last"))))))))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("DATA"))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_triple_name, hydra.core.Name("first")))))))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.test.test_types.test_type_triple_name, (hydra.core.Field(hydra.core.Name("first"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))), hydra.core.Field(hydra.core.Name("second"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("middle"))))), hydra.core.Field(hydra.core.Name("third"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("last"))))))))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("DATA")))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())),))), cast(frozenlist[hydra.testing.TestCaseWithMetadata], ()))), cast(frozenlist[hydra.testing.TestCaseWithMetadata], ())), hydra.testing.TestGroup("Polymorphic terms (System F)", cast(Maybe[str], Nothing()), (hydra.testing.TestGroup("Type lambdas in let bindings", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("polymorphic identity function", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("monomorphic partially applied primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("partial"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("partial")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("partial"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("partial"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("monomorphic projection", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("getter"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("Person"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("getter")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("getter"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("Person"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("getter"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("Type applications of polymorphic bindings", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("polymorphic variable with type application", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("type application of identity applied to binary function with no arguments", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("type application of identity applied to partially applied binary function", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("type application of identity applied to fully applied binary function", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo,bar"))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo,bar")))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("type application of identity applied to binary function, then applied to one argument", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(",")))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("type application of identity applied to binary function, then fully applied to two arguments", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo,bar")))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo,bar"))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ()))))), cast(frozenlist[hydra.testing.TestCaseWithMetadata], ())), hydra.testing.TestGroup("Higher-Order Functions", cast(Maybe[str], Nothing()), (hydra.testing.TestGroup("Functions that return functions", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("lambda returning bare binary primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("lambda returning bare unary primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("lambda returning partially applied primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(",")))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("lambda returning fully applied primitive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("lambda returning bare projection", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("person"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName"))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("person"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_person_name, hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("nested lambdas with partial application in body", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("lambda returning lambda returning partial application", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))),), cast(frozenlist[hydra.testing.TestCaseWithMetadata], ())), hydra.testing.TestGroup("Let terms", cast(Maybe[str], Nothing()), (hydra.testing.TestGroup("partial application of a let-bound function", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("simple", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("helper"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg3"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.cat"))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg3")))))))))))))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("helper"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("helper"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg3"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.cat"))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg3")))))))))))))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("helper"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v2")))))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("in a fold", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("helper"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg3"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.cat"))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg3")))))))))))))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.lists.foldl"))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("helper"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(""))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("helper"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg3"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.cat"))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg3")))))))))))))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.lists.foldl"))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("helper"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v2"))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(""))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("within another let binding", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("tryme"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("helper"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg3"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.cat"))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg3")))))))))))))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("helper"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermUnit())))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("tryme"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("helper"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("arg3"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.cat"))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("arg3")))))))))))))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v2"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("helper"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v2"))))))))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermUnit()))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))),), cast(frozenlist[hydra.testing.TestCaseWithMetadata], ())), hydra.testing.TestGroup("Case statements", cast(Maybe[str], Nothing()), (hydra.testing.TestGroup("monomorphic at top level", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("non-applied case statement", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied case statement", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.test.test_types.test_type_union_monomorphic_name, hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.test.test_types.test_type_union_monomorphic_name, hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied case statement in lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_monomorphic_name)))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_monomorphic_name)))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("monomorphic in let binding", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("non-applied case statement", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_monomorphic_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("ignored"))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_monomorphic_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("ignored")))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied case statement", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.test.test_types.test_type_union_monomorphic_name, hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("ignored"))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.test.test_types.test_type_union_monomorphic_name, hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("ignored")))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied case statement in lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_monomorphic_name)))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("ignored"))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_monomorphic_name)))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))),)))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("ignored")))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("polymorphic in let binding", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("non-applied UnionPolymorphicRecursive", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("i"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.literals.showInt32"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("i")))))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("i"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.literals.showInt32"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("i")))))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied UnionPolymorphicRecursive with int32", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("i"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.literals.showInt32"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("i")))))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.test.test_types.test_type_union_polymorphic_recursive_name, hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("i"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.literals.showInt32"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("i")))))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.test.test_types.test_type_union_polymorphic_recursive_name, hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied UnionPolymorphicRecursive with int32 in lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("i"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.literals.showInt32"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("i")))))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("i"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.literals.showInt32"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("i")))))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied generic UnionPolymorphicRecursive in lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t0"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("t1"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))))))))), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t0"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("test"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_polymorphic_recursive_name, cast(Maybe[hydra.core.Term], Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("other")))))), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))),)))))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme((hydra.core.Name("t1"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.test.test_types.test_type_union_polymorphic_recursive_name)), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("test"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())))), hydra.testing.TestGroup("Forced expansion in case statement branches", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("variable reference in case branch is expanded", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("handler"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Nothing()), (hydra.core.Field(hydra.core.Name("bool"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("boolean value")))))))))), hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("handler")))), hydra.core.Field(hydra.core.Name("unit"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("unit value"))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("handler"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(Maybe[hydra.core.TypeScheme], Just(hydra.core.TypeScheme(cast(frozenlist[hydra.core.Name], ()), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(Maybe[FrozenDict[hydra.core.Name, hydra.core.TypeVariableMetadata]], Nothing()))))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Nothing()), (hydra.core.Field(hydra.core.Name("bool"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("boolean value")))))))))), hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("handler"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))), hydra.core.Field(hydra.core.Name("unit"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("unit value")))))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("bare primitive in case branch is expanded", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Nothing()), (hydra.core.Field(hydra.core.Name("bool"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("boolean value")))))))))), hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))), hydra.core.Field(hydra.core.Name("unit"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("unit value")))))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.test.test_types.test_type_union_monomorphic_name, cast(Maybe[hydra.core.Term], Nothing()), (hydra.core.Field(hydra.core.Name("bool"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("boolean value")))))))))), hydra.core.Field(hydra.core.Name("string"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))), hydra.core.Field(hydra.core.Name("unit"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("ignored"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("unit value")))))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("variable reference outside case branch is not expanded", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("handler"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(Maybe[hydra.core.TypeScheme], Nothing())),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("handler")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("handler"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(Maybe[hydra.core.TypeScheme], Nothing())),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("handler"))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("bare primitive outside case branch is not expanded", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ()))))), cast(frozenlist[hydra.testing.TestCaseWithMetadata], ())), hydra.testing.TestGroup("Non-expansion of eliminations which produce functions", cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.TestGroup], ()), (hydra.testing.TestCaseWithMetadata("applied case statement", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t0"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("dir"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("hydra.coders.CoderDirection"))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("coder"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("hydra.compute.Coder"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("hydra.coders.CoderDirection"), cast(Maybe[hydra.core.Term], Nothing()), (hydra.core.Field(hydra.core.Name("encode"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("_"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeUnit()))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v12"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.core.Name("hydra.compute.Coder"), hydra.core.Name("encode")))))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("coder")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v12"))))))))))))))))), hydra.core.Field(hydra.core.Name("decode"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("_"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeUnit()))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v12"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.core.Name("hydra.compute.Coder"), hydra.core.Name("decode")))))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("coder")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v12"))))))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("dir")))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t0"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("dir"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("hydra.coders.CoderDirection"))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("coder"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeApplication(hydra.core.ApplicationType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("hydra.compute.Coder"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("hydra.coders.CoderDirection"), cast(Maybe[hydra.core.Term], Nothing()), (hydra.core.Field(hydra.core.Name("encode"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("_"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeUnit()))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v12"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.core.Name("hydra.compute.Coder"), hydra.core.Name("encode")))))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("coder")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v12"))))))))))))))))), hydra.core.Field(hydra.core.Name("decode"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("_"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeUnit()))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v12"), cast(Maybe[hydra.core.Type], Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.core.Name("hydra.compute.Coder"), hydra.core.Name("decode")))))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("coder")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v12"))))))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("dir"))))))))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ())), hydra.testing.TestCaseWithMetadata("applied projection", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_triple_name, hydra.core.Name("third")))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.test.test_types.test_type_triple_name, (hydra.core.Field(hydra.core.Name("first"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))), hydra.core.Field(hydra.core.Name("second"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(137))))))), hydra.core.Field(hydra.core.Name("third"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s"))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.test.test_types.test_type_triple_name, hydra.core.Name("third")))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.test.test_types.test_type_triple_name, (hydra.core.Field(hydra.core.Name("first"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))), hydra.core.Field(hydra.core.Name("second"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(137))))))), hydra.core.Field(hydra.core.Name("third"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("s"), cast(Maybe[hydra.core.Type], Nothing()), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("s")))))))))))))))))))))), cast(Maybe[str], Nothing()), cast(frozenlist[hydra.testing.Tag], ()))))), cast(frozenlist[hydra.testing.TestCaseWithMetadata], ()))
