# Note: this is an automatically generated file. Do not edit.

r"""Test cases for term rewriting operations."""

from __future__ import annotations
from hydra.dsl.python import FrozenDict, Just, Nothing
from typing import cast
import hydra.coders
import hydra.core
import hydra.testing

def all_tests() -> hydra.testing.TestGroup:
    r"""Test cases for term rewriting operations."""
    
    return hydra.testing.TestGroup("rewriting", Nothing(), (hydra.testing.TestGroup("freeVariables", Nothing(), (), (hydra.testing.TestCaseWithMetadata("string literal has no free variables", cast(hydra.testing.TestCase, hydra.testing.TestCaseFreeVariables(hydra.testing.FreeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), frozenset({})))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("single variable", cast(hydra.testing.TestCase, hydra.testing.TestCaseFreeVariables(hydra.testing.FreeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), frozenset({hydra.core.Name("x")})))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("bound variable is not free", cast(hydra.testing.TestCase, hydra.testing.TestCaseFreeVariables(hydra.testing.FreeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), frozenset({})))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("unbound variable in lambda body", cast(hydra.testing.TestCase, hydra.testing.TestCaseFreeVariables(hydra.testing.FreeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), frozenset({hydra.core.Name("x")})))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("mixed free and bound variables", cast(hydra.testing.TestCase, hydra.testing.TestCaseFreeVariables(hydra.testing.FreeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), frozenset({hydra.core.Name("x")})))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple free variables", cast(hydra.testing.TestCase, hydra.testing.TestCaseFreeVariables(hydra.testing.FreeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), frozenset({hydra.core.Name("x"), hydra.core.Name("y")})))), Nothing(), ()))), hydra.testing.TestGroup("simplifyTerm", Nothing(), (), (hydra.testing.TestCaseWithMetadata("const application with literal", cast(hydra.testing.TestCase, hydra.testing.TestCaseSimplifyTerm(hydra.testing.SimplifyTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("identity application", cast(hydra.testing.TestCase, hydra.testing.TestCaseSimplifyTerm(hydra.testing.SimplifyTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("unused parameter", cast(hydra.testing.TestCase, hydra.testing.TestCaseSimplifyTerm(hydra.testing.SimplifyTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested lambda applications", cast(hydra.testing.TestCase, hydra.testing.TestCaseSimplifyTerm(hydra.testing.SimplifyTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), Nothing(), ()))), hydra.testing.TestGroup("flattenLetTerms", Nothing(), (), (hydra.testing.TestCaseWithMetadata("non-let term unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseFlattenLetTerms(hydra.testing.FlattenLetTermsTestCase(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("list term unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseFlattenLetTerms(hydra.testing.FlattenLetTermsTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))),))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))),)))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("non-nested let unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseFlattenLetTerms(hydra.testing.FlattenLetTermsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested binding in let value is flattened", cast(hydra.testing.TestCase, hydra.testing.TestCaseFlattenLetTerms(hydra.testing.FlattenLetTermsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b_x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b_y")))))), Nothing()), hydra.core.Binding(hydra.core.Name("b_x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("b_y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple levels of nesting are flattened", cast(hydra.testing.TestCase, hydra.testing.TestCaseFlattenLetTerms(hydra.testing.FlattenLetTermsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("p"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(137)))))), Nothing()), hydra.core.Binding(hydra.core.Name("q"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(5))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("q"))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b_x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b_y")))))), Nothing()), hydra.core.Binding(hydra.core.Name("b_x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("b_y"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b_y_q")))))), Nothing()), hydra.core.Binding(hydra.core.Name("b_y_p"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(137)))))), Nothing()), hydra.core.Binding(hydra.core.Name("b_y_q"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b_x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(5))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))))))))), Nothing(), ()))), hydra.testing.TestGroup("liftLambdaAboveLet", Nothing(), (), (hydra.testing.TestCaseWithMetadata("simple let with lambda in body", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("bare lambda unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("bare let unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("lambda with let in body unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let with two nested lambdas", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("lambda inside let body already above let", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let without lambda in body unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing())), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing())), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple let bindings with lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing())), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing())), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested lets with lambda at innermost level", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("lambda between two lets", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple lambdas between nested lets", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple lambdas already above let", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotation above let containing lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), FrozenDict({})))), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), FrozenDict({}))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotation above lambda in let body", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), FrozenDict({}))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), FrozenDict({})))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotation between two lambdas", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), FrozenDict({})))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), FrozenDict({}))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotation on the body of lambda in let", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), FrozenDict({})))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), FrozenDict({}))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotation on lambda already above let", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), FrozenDict({})))), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), FrozenDict({}))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let-lambda inside a list", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let-lambda in multiple list elements", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let-lambda in a let binding value", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let-lambda inside a pair", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("test"))))))), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("test")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let-lambda in both elements of a pair", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))))))))), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let-lambda inside lambda body", cast(hydra.testing.TestCase, hydra.testing.TestCaseLiftLambdaAboveLet(hydra.testing.LiftLambdaAboveLetTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("outer"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("inner"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("outer"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("inner"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))))), Nothing(), ()))), hydra.testing.TestGroup("deannotateTerm", Nothing(), (), (hydra.testing.TestCaseWithMetadata("unannotated literal unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateTerm(hydra.testing.DeannotateTermTestCase(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("unannotated variable unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateTerm(hydra.testing.DeannotateTermTestCase(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("unannotated lambda unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateTerm(hydra.testing.DeannotateTermTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("single annotation stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateTerm(hydra.testing.DeannotateTermTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), FrozenDict({})))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested annotations stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateTerm(hydra.testing.DeannotateTermTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), FrozenDict({})))), FrozenDict({})))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotated lambda stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateTerm(hydra.testing.DeannotateTermTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), FrozenDict({})))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotated application stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateTerm(hydra.testing.DeannotateTermTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), FrozenDict({})))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()))), hydra.testing.TestGroup("deannotateType", Nothing(), (), (hydra.testing.TestCaseWithMetadata("unannotated primitive type unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateType(hydra.testing.DeannotateTypeTestCase(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("unannotated string type unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateType(hydra.testing.DeannotateTypeTestCase(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("unannotated function type unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateType(hydra.testing.DeannotateTypeTestCase(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("single annotation stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateType(hydra.testing.DeannotateTypeTestCase(cast(hydra.core.Type, hydra.core.TypeAnnotated(hydra.core.AnnotatedType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), FrozenDict({})))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested annotations stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateType(hydra.testing.DeannotateTypeTestCase(cast(hydra.core.Type, hydra.core.TypeAnnotated(hydra.core.AnnotatedType(cast(hydra.core.Type, hydra.core.TypeAnnotated(hydra.core.AnnotatedType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), FrozenDict({})))), FrozenDict({})))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotated list type stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateType(hydra.testing.DeannotateTypeTestCase(cast(hydra.core.Type, hydra.core.TypeAnnotated(hydra.core.AnnotatedType(cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))), FrozenDict({})))), cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("annotated function type stripped", cast(hydra.testing.TestCase, hydra.testing.TestCaseDeannotateType(hydra.testing.DeannotateTypeTestCase(cast(hydra.core.Type, hydra.core.TypeAnnotated(hydra.core.AnnotatedType(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), FrozenDict({})))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), Nothing(), ()))), hydra.testing.TestGroup("topologicalSortBindings", Nothing(), (), (hydra.testing.TestCaseWithMetadata("isolated bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseTopologicalSortBindings(hydra.testing.TopologicalSortBindingsTestCase(((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))), (hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))), (((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))),), ((hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))),))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("single recursive binding", cast(hydra.testing.TestCase, hydra.testing.TestCaseTopologicalSortBindings(hydra.testing.TopologicalSortBindingsTestCase(((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))),)))),), (((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))),)))),),)))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("mutually recursive bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseTopologicalSortBindings(hydra.testing.TopologicalSortBindingsTestCase(((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))),)))), (hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))),))))), (((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))),)))), (hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))),))))),)))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("mixed bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseTopologicalSortBindings(hydra.testing.TopologicalSortBindingsTestCase(((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("c"))))))), (hydra.core.Name("c"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))), (hydra.core.Name("d"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))), (((hydra.core.Name("c"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))),), ((hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("c")))))))), ((hydra.core.Name("d"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))),))))), Nothing(), ()))), hydra.testing.TestGroup("normalizeTypeVariables", Nothing(), (), (hydra.testing.TestCaseWithMetadata("literal without type variables unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("simple let without type annotations unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let with monomorphic type scheme unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let with monomorphic binding referencing string", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic binding with free type variable unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("bar"))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("bar"))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("monomorphic binding with typed lambda unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic binding with typed lambda in body unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("bar"))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("bar"))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic identity function normalized", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic const function normalized", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("const"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"), hydra.core.Name("b")), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("const"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("const"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"), hydra.core.Name("t1")), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("const"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("binding rewriting does not affect body with typed lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested polymorphic lets normalized", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("b"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id2"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id2"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested same substitution in bindings and environment", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("parent type variable shadows child variable", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t1"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("no shadowing distinct type variables", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("b"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t1"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("locally free type variable in nested binding", cast(hydra.testing.TestCase, hydra.testing.TestCaseNormalizeTypeVariables(hydra.testing.NormalizeTypeVariablesTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("fun1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("fun2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c")))), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("c"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("fun2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"), hydra.core.Name("b")), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("fun1"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("fun1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0")))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("fun2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t2")))), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t2"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t2"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t2"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("fun2"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("t0"), hydra.core.Name("t1")), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t0"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t1")))))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("fun1"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), Nothing(), ()))), hydra.testing.TestGroup("etaExpandTerm", Nothing(), (), (hydra.testing.TestCaseWithMetadata("integer literal unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string list unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("fully applied binary function unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("lambda with fully applied primitive unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString(","))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("lambda returning constant unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("bare unary primitive unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower")))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("bare binary primitive unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn")))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("partially applied binary primitive expands to one lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("foo")))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("foo")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("projection expands to lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.core.Name("Person"), hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationRecord(hydra.core.Projection(hydra.core.Name("Person"), hydra.core.Name("firstName")))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1")))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("partial application inside lambda expands", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let with constant body unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(137)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(137)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("let with bare primitive value unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("foo")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("foo"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("foo"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("fully applied unary unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("FOO"))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.toLower"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("FOO")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("partial application in list expands", cast(hydra.testing.TestCase, hydra.testing.TestCaseEtaExpansion(hydra.testing.EtaExpansionTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))),)))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))),)))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("v1"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.strings.splitOn"))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("v1"))))))))))))))))), Nothing(), ()))), hydra.testing.TestGroup("foldOverTerm", Nothing(), (), (hydra.testing.TestCaseWithMetadata("collect labels from single node - pre-order", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))), cast(hydra.core.Term, hydra.core.TermList(()))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.COLLECT_LABELS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))),)))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("collect labels from tree - pre-order", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("b")))), cast(hydra.core.Term, hydra.core.TermList(()))))), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("c")))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("d")))), cast(hydra.core.Term, hydra.core.TermList(()))))),)))))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.COLLECT_LABELS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("b")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("c")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("d")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("collect labels from single node - post-order", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))), cast(hydra.core.Term, hydra.core.TermList(()))))), hydra.coders.TraversalOrder.POST, hydra.testing.FoldOperation.COLLECT_LABELS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))),)))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("collect labels from tree - post-order", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("b")))), cast(hydra.core.Term, hydra.core.TermList(()))))), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("c")))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("d")))), cast(hydra.core.Term, hydra.core.TermList(()))))),)))))))))))), hydra.coders.TraversalOrder.POST, hydra.testing.FoldOperation.COLLECT_LABELS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("b")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("d")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("c")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("a")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("sum int32 literals", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10)))))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(52))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("collect list lengths - pre-order", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("quux")))),))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.COLLECT_LIST_LENGTHS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("collect list lengths - post-order", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("quux")))),))))))))), hydra.coders.TraversalOrder.POST, hydra.testing.FoldOperation.COLLECT_LIST_LENGTHS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))), Nothing(), ()))), hydra.testing.TestGroup("rewriteType", Nothing(), (), (hydra.testing.TestCaseWithMetadata("String type in left side of either is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String type in right side of either is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String types in both sides of either are replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String type in nested either (left of left) is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64))))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64)))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String type in nested either (right of right) is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64)))), cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64)))), cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String types in complex nested either are all replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64)))))))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Type, hydra.core.TypeEither(hydra.core.EitherType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String in list type is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeList(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String in function domain is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64))))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64)))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String in function codomain is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT64)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("String in optional type is replaced", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteType(hydra.testing.RewriteTypeTestCase(cast(hydra.core.Type, hydra.core.TypeMaybe(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))), hydra.testing.TypeRewriter.REPLACE_STRING_WITH_INT32, cast(hydra.core.Type, hydra.core.TypeMaybe(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))), Nothing(), ()))), hydra.testing.TestGroup("rewriteTerm", Nothing(), (), (hydra.testing.TestCaseWithMetadata("string literal foo replaced with bar", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in variable not changed", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in list", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple strings in list", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in optional (just)", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in function application", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("print"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("print"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in lambda body", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in nested applications", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in record field", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Person"), (hydra.core.Field(hydra.core.Name("name"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))),)))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Person"), (hydra.core.Field(hydra.core.Name("name"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))),))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("strings in multiple record fields", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Data"), (hydra.core.Field(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))), hydra.core.Field(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))), hydra.core.Field(hydra.core.Name("c"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Data"), (hydra.core.Field(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))), hydra.core.Field(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))), hydra.core.Field(hydra.core.Name("c"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in pair", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in let binding value", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in let body", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in first case branch", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Nothing(), (hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))), hydra.core.Field(hydra.core.Name("error"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Nothing(), (hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))), hydra.core.Field(hydra.core.Name("error"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in second case branch", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Nothing(), (hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))), hydra.core.Field(hydra.core.Name("error"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Nothing(), (hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))), hydra.core.Field(hydra.core.Name("error"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in default branch", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))), (hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))), hydra.core.Field(hydra.core.Name("error"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))), (hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))), hydra.core.Field(hydra.core.Name("error"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string deeply nested in record in list in application", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("process"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Item"), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))),)))),)))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("process"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Item"), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))),)))),))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in union inject value", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.core.Name("Result"), hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermUnion(hydra.core.Injection(hydra.core.Name("Result"), hydra.core.Field(hydra.core.Name("success"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in wrapped term", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermWrap(hydra.core.WrappedTerm(hydra.core.Name("Email"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermWrap(hydra.core.WrappedTerm(hydra.core.Name("Email"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in annotated term body", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), FrozenDict({})))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), FrozenDict({}))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in first of multiple let bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))), Nothing())), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))), Nothing())), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in second of multiple let bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Nothing())), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), Nothing())), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in all let bindings and body", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), Nothing())), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), Nothing())), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in set", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermSet(frozenset({
      cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz")))),
      cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))}))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermSet(frozenset({
      cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))),
      cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))})))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in type lambda body", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in type application body", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar")))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in nested type lambdas", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo")))))))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("b"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in case branch within let binding", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("handler"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Nothing(), (hydra.core.Field(hydra.core.Name("ok"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))), hydra.core.Field(hydra.core.Name("err"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("handler")))))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("handler"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Nothing(), (hydra.core.Field(hydra.core.Name("ok"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))), hydra.core.Field(hydra.core.Name("err"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("baz"))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("handler"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("string in annotated wrapped record field", cast(hydra.testing.TestCase, hydra.testing.TestCaseRewriteTerm(hydra.testing.RewriteTermTestCase(cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermWrap(hydra.core.WrappedTerm(hydra.core.Name("User"), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("UserData"), (hydra.core.Field(hydra.core.Name("name"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("foo"))))),))))))), FrozenDict({})))), hydra.testing.TermRewriter.REPLACE_FOO_WITH_BAR, cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermWrap(hydra.core.WrappedTerm(hydra.core.Name("User"), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("UserData"), (hydra.core.Field(hydra.core.Name("name"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("bar"))))),))))))), FrozenDict({}))))))), Nothing(), ()))), hydra.testing.TestGroup("rewriteAndFoldTermWithPath", Nothing(), (), (hydra.testing.TestCaseWithMetadata("path tracking through application - sum literals", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through nested applications", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through let bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(32)))))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through record fields", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Point"), (hydra.core.Field(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10))))))), hydra.core.Field(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(20))))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(30))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through case branches", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Nothing(), (hydra.core.Field(hydra.core.Name("ok"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))), hydra.core.Field(hydra.core.Name("err"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through pair", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(5)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(7))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(12))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through optional", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through wrapped term", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermWrap(hydra.core.WrappedTerm(hydra.core.Name("Age"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(25))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(25))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through type lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("a"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(100))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(100))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through type application", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(50)))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(50))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("path tracking through set elements", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermSet(frozenset({
      cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))),
      cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))),
      cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))}))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(6))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("deep nesting - application in lambda in let", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(5)))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.SUM_INT32_LITERALS, cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(15))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("collect list lengths in nested structure", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))),)))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.COLLECT_LIST_LENGTHS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("collect list lengths in let body", cast(hydra.testing.TestCase, hydra.testing.TestCaseFoldOverTerm(hydra.testing.FoldOverTermTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("xs"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))),))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))))))))), hydra.coders.TraversalOrder.PRE, hydra.testing.FoldOperation.COLLECT_LIST_LENGTHS, cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))), Nothing(), ())))), ())
