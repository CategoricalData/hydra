# Note: this is an automatically generated file. Do not edit.

r"""Test cases for hoisting transformations."""

from __future__ import annotations
from functools import lru_cache
from hydra.dsl.python import FrozenDict, Just, Nothing
from typing import cast
import hydra.core
import hydra.testing

@lru_cache(1)
def all_tests() -> hydra.testing.TestGroup:
    r"""Test cases for hoisting transformations."""
    
    return hydra.testing.TestGroup("hoisting", Nothing(), (hydra.testing.TestGroup("hoistSubterms", Nothing(), (), (hydra.testing.TestCaseWithMetadata("hoistNothing: simple let unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.NOTHING, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistNothing: let with list in body unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.NOTHING, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistNothing: let with application in body unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.NOTHING, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("h"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("h"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: list in body is hoisted into local let", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: multiple lists in body are hoisted together", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(4))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), Nothing()), hydra.core.Binding(hydra.core.Name("_hoist__body_2"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(4))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_2"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: list in binding value is hoisted into local let", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_x_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_x_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: nested lists hoisted from inside out", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), Nothing()), hydra.core.Binding(hydra.core.Name("_hoist__body_2"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_2"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistApplications: application in list element is hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.APPLICATIONS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistApplications: application in record field is hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.APPLICATIONS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Data"), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))),))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermRecord(hydra.core.Record(hydra.core.Name("Data"), (hydra.core.Field(hydra.core.Name("value"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1")))),))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistApplications: nested applications hoisted from inside out", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.APPLICATIONS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))),)))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing()), hydra.core.Binding(hydra.core.Name("_hoist__body_2"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1")))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_2"))),)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistCaseStatements: case in application argument is hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.CASE_STATEMENTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistCaseStatements: case in list element is hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.CASE_STATEMENTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))), (hydra.core.Field(hydra.core.Name("ok"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), hydra.core.Field(hydra.core.Name("err"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))),)))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))), (hydra.core.Field(hydra.core.Name("ok"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), hydra.core.Field(hydra.core.Name("err"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))),)))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: nested let - inner let processed independently", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1")))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: non-let term is unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistApplications: bare application unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.APPLICATIONS, cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: term referring to let-bound variable needs no capture", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: term referring to lambda above let needs no capture", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1")))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: lambda-bound var not free in hoisted term needs no capture", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1")))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: lambda-bound var free in hoisted term requires capture", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: only free lambda-bound vars are captured", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))))))))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: stable naming for binding and body", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(4))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_x_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_x_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(3)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(4))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: stable naming for multiple bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))),)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))),)))))), Nothing())), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_x_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))),))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_x_1"))))))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_y_1"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))),))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_y_1"))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("hoistLists: polymorphic binding with self-reference below hoisted term", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistSubterms(hydra.testing.HoistSubtermsTestCase(hydra.testing.HoistPredicate.LISTS, cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), Nothing(), ()))), hydra.testing.TestGroup("hoistCaseStatements", Nothing(), (), (hydra.testing.TestCaseWithMetadata("case at top level of let body is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in let binding value is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case inside lambda body is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermMaybe(Just(cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case inside nested lambdas is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("ok"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), hydra.core.Field(hydra.core.Name("err"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Result"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("ok"), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), hydra.core.Field(hydra.core.Name("err"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case as LHS of one application is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case wrapped in annotation is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), FrozenDict({})))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermAnnotated(hydra.core.AnnotatedTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), FrozenDict({})))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in lambda with one application is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case as RHS of application IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in nested application LHS IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case inside list element IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))),))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))),)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case inside lambda inside list IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))),))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))),)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("list inside lambda is NOT hoisted (only case statements)", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in binding is not hoisted, case in arg position is hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("w"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("w"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1"))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in nested let body is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("w"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("w"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("w"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in let inside lambda is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in lambda inside let body is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case with let+lambda+app is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in triple application LHS IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("c"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("c"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("c"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("c"), Nothing(), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case as second argument IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in both arguments - both hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()), hydra.core.Binding(hydra.core.Name("_hoist_f_2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_2"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in second list element IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple cases in list - all hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()), hydra.core.Binding(hydra.core.Name("_hoist_f_2"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermList((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_2"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in pair first element IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in pair second element IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermPair((cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in child let binding hoisted into child", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_inner_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_inner_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in child let body hoisted into child", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist__body_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist__body_1")))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case at top level of child let NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Nothing(), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("cases in both outer and child - each hoisted locally", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_outer_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_outer_1")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_inner_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_inner_1"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner")))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("lambda after app LHS takes us out of top level", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case inside case branch is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case inside case default branch is NOT hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("case in arg position inside case branch IS hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistCaseStatements(hydra.testing.HoistCaseStatementsTestCase(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("_hoist_f_1"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionElimination(cast(hydra.core.Elimination, hydra.core.EliminationUnion(hydra.core.CaseStatement(hydra.core.Name("Optional"), Just(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), (hydra.core.Field(hydra.core.Name("just"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("_hoist_f_1"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))))))), hydra.core.Field(hydra.core.Name("nothing"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(0)))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))))), Nothing(), ()))), hydra.testing.TestGroup("hoistLetBindings", Nothing(), (), (hydra.testing.TestCaseWithMetadata("simple nested let: inner binding hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistLetBindings(hydra.testing.HoistLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing())), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested let inside lambda: binding hoisted with lambda capture", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistLetBindings(hydra.testing.HoistLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.mul"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g")))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10)))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))))))))))), Nothing()), hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.mul"))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("type lambda: nested let NOT hoisted out", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistLetBindings(hydra.testing.HoistLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("type lambda: multiple nested lets NOT hoisted out", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistLetBindings(hydra.testing.HoistLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f")))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t"), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("type application: nested let outside lambda CAN be hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistLetBindings(hydra.testing.HoistLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10)))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(10))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("mixed: let before type lambda can be hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistLetBindings(hydra.testing.HoistLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer")))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("outer"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()), hydra.core.Binding(hydra.core.Name("inner"), cast(hydra.core.Term, hydra.core.TermTypeLambda(hydra.core.TypeLambda(hydra.core.Name("t"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Just(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("t")))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Nothing())), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermTypeApplication(hydra.core.TypeApplicationTerm(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("inner"))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("outer")))))))))), Nothing(), ()))), hydra.testing.TestGroup("hoistPolymorphicLetBindings", Nothing(), (), (hydra.testing.TestCaseWithMetadata("no polymorphic bindings: simple let unchanged", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("no polymorphic bindings: multiple monomorphic bindings", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hi")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))), hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hi")))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("single polymorphic binding: already at top level", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("nested polymorphic binding: hoisted to top", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))), hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("mixed bindings in nested let: only polymorphic hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))), hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))), hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing())))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("z"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z"))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("multiple polymorphic bindings: all hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))), hydra.core.Binding(hydra.core.Name("const"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"), hydra.core.Name("b")), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))))))))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("const"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("y"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))), hydra.core.Binding(hydra.core.Name("const"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"), hydra.core.Name("b")), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))))))))), Nothing()))), hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("const"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("deeply nested polymorphic binding: hoisted to top", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("z"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("z")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("a"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("a")))))), Nothing()))), hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing())))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic binding inside lambda: no capture", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("b"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("id"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))), Just(hydra.core.TypeScheme((hydra.core.Name("b"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))))), Nothing()))), hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("id"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a"))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic binding captures lambda variable: wrapped in lambda", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("b"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello")))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("b"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("b")))))))))))), Nothing()))), hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeString()))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralString("hello"))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic binding captures multiple lambda variables", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("triple"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("c"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c")))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42)))))))))))))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("triple"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("c"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c"))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c")))))))))))), Nothing()))), hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(42))))))))))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))))))))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("polymorphic binding captures some but not all lambda variables", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x"))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("c"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c"))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b"))))))))))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))))))), Nothing()))),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("g"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("x"), Nothing(), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("pair"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))))))))))))), Just(hydra.core.TypeScheme((hydra.core.Name("c"),), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c"))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeVariable(hydra.core.Name("c")))))))))))), Nothing()))), hydra.core.Binding(hydra.core.Name("f"), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("a"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionLambda(hydra.core.Lambda(hydra.core.Name("b"), Just(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("g"))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("a")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("b")))))))))))))))), Just(hydra.core.TypeScheme((), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeFunction(hydra.core.FunctionType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypePair(hydra.core.PairType(cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32)))), cast(hydra.core.Type, hydra.core.TypeLiteral(cast(hydra.core.LiteralType, hydra.core.LiteralTypeInteger(hydra.core.IntegerType.INT32))))))))))))), Nothing())))), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("f"))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1))))))))), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2))))))))))))), Nothing(), ()), hydra.testing.TestCaseWithMetadata("untyped binding: not hoisted", cast(hydra.testing.TestCase, hydra.testing.TestCaseHoistPolymorphicLetBindings(hydra.testing.HoistPolymorphicLetBindingsTestCase(hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y")))))))))), hydra.core.Let((hydra.core.Binding(hydra.core.Name("x"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(1)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermLet(hydra.core.Let((hydra.core.Binding(hydra.core.Name("y"), cast(hydra.core.Term, hydra.core.TermLiteral(cast(hydra.core.Literal, hydra.core.LiteralInteger(cast(hydra.core.IntegerValue, hydra.core.IntegerValueInt32(2)))))), Nothing()),), cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermApplication(hydra.core.Application(cast(hydra.core.Term, hydra.core.TermFunction(cast(hydra.core.Function, hydra.core.FunctionPrimitive(hydra.core.Name("hydra.lib.math.add"))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("x")))))), cast(hydra.core.Term, hydra.core.TermVariable(hydra.core.Name("y"))))))))))))), Nothing(), ())))), ())
